{"_id":"68923b7ca83e15671c2c8e1c","calculate_sdes":null,"calculation_method":"PATIENT","cms_id":"CMS128v13","component":false,"component_hqmf_set_ids":[],"composite":false,"composite_hqmf_set_id":null,"cql_libraries":[{"_id":"68923b74a83e15671c2c8ba3","cql":"library AntidepressantMedicationManagement version '13.0.000'\r\n\r\nusing QDM version '5.6'\r\n\r\ninclude MATGlobalCommonFunctionsQDM version '8.0.000' called Global\r\ninclude HospiceQDM version '6.0.000' called Hospice\r\ninclude CumulativeMedicationDurationQDM version '3.0.000' called CMD\r\n\r\nvalueset \"Annual Wellness Visit\": 'urn:oid:2.16.840.1.113883.3.526.3.1240'\r\nvalueset \"Antidepressant Medication\": 'urn:oid:2.16.840.1.113883.3.464.1003.196.12.1213'\r\nvalueset \"Ethnicity\": 'urn:oid:2.16.840.1.114222.4.11.837'\r\nvalueset \"Home Healthcare Services\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1016'\r\nvalueset \"Major Depression\": 'urn:oid:2.16.840.1.113883.3.464.1003.105.12.1007'\r\nvalueset \"Nursing Facility Visit\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1012'\r\nvalueset \"Office Visit\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1001'\r\nvalueset \"ONC Administrative Sex\": 'urn:oid:2.16.840.1.113762.1.4.1'\r\nvalueset \"Payer Type\": 'urn:oid:2.16.840.1.114222.4.11.3591'\r\nvalueset \"Preventive Care Services Established Office Visit, 18 and Up\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1025'\r\nvalueset \"Preventive Care Services Initial Office Visit, 18 and Up\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1023'\r\nvalueset \"Psych Visit Diagnostic Evaluation\": 'urn:oid:2.16.840.1.113883.3.526.3.1492'\r\nvalueset \"Psych Visit Psychotherapy\": 'urn:oid:2.16.840.1.113883.3.526.3.1496'\r\nvalueset \"Race\": 'urn:oid:2.16.840.1.114222.4.11.836'\r\nvalueset \"Telephone Visits\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1080'\r\nvalueset \"Virtual Encounter\": 'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1089'\r\n\r\nparameter \"Measurement Period\" Interval\u003cDateTime\u003e\r\n\r\ncontext Patient\r\n\r\ndefine \"SDE Ethnicity\":\r\n  [\"Patient Characteristic Ethnicity\": \"Ethnicity\"]\r\n\r\ndefine \"SDE Payer\":\r\n  [\"Patient Characteristic Payer\": \"Payer Type\"]\r\n\r\ndefine \"SDE Race\":\r\n  [\"Patient Characteristic Race\": \"Race\"]\r\n\r\ndefine \"SDE Sex\":\r\n  [\"Patient Characteristic Sex\": \"ONC Administrative Sex\"]\r\n\r\ndefine \"Denominator\":\r\n  \"Initial Population\"\r\n\r\ndefine \"Initial Population\":\r\n  AgeInYearsAt(date from \"IPSD\") \u003e= 18\r\n    and \"Has IPSD and Major Depression Diagnosis\"\r\n    and exists \"Qualifying Encounters\"\r\n\r\ndefine \"Intake Period\":\r\n  Interval[\"May 1 of the Year Prior to the Measurement Period\", \"April 30 of the Measurement Period\"]\r\n\r\ndefine \"May 1 of the Year Prior to the Measurement Period\":\r\n  DateTime((year from start of \"Measurement Period\" - 1), 5, 1, 0, 0, 0, 0, 0)\r\n\r\ndefine \"April 30 of the Measurement Period\":\r\n  DateTime((year from start of \"Measurement Period\"), 4, 30, 23, 59, 59, 0, 0)\r\n\r\ndefine \"Numerator 2\":\r\n  \"Cumulative Medication Duration Greater Than or Equal to 180 Days\"\r\n\r\ndefine \"Numerator 1\":\r\n  \"Cumulative Medication Duration Greater Than or Equal to 84 Days\"\r\n\r\ndefine \"Cumulative Medication Duration Greater Than or Equal to 180 Days\":\r\n  CMD.\"CumulativeDuration\" ( \"Antidepressant Medication Period Between IPSD and 231 Days After IPSD\" ) \u003e= 180\r\n\r\ndefine \"Cumulative Medication Duration Greater Than or Equal to 84 Days\":\r\n  CMD.\"CumulativeDuration\" ( \"Antidepressant Medication Period Between IPSD and 114 Days After IPSD\" ) \u003e= 84\r\n\r\ndefine \"Has IPSD and Major Depression Diagnosis\":\r\n  exists ( [\"Diagnosis\": \"Major Depression\"] MajorDepression\r\n      where \"IPSD\" is not null\r\n        and date from start of MajorDepression.prevalencePeriod within 60 days of \"IPSD\"\r\n  )\r\n\r\ndefine \"Antidepressant Medication Period Between IPSD and 114 Days After IPSD\":\r\n  [\"Medication, Dispensed\": \"Antidepressant Medication\"] Antidepressant\r\n    let MedicationPeriod: CMD.\"MedicationDispensedPeriod\" ( Antidepressant )\r\n    return MedicationPeriod\r\n      intersect Interval[\"IPSD\", \"IPSD\" + 114 days]\r\n\r\ndefine \"Antidepressant Medication Period Between IPSD and 231 Days After IPSD\":\r\n  [\"Medication, Dispensed\": \"Antidepressant Medication\"] Antidepressant\r\n    let MedicationPeriod: CMD.\"MedicationDispensedPeriod\" ( Antidepressant )\r\n    return MedicationPeriod\r\n      intersect Interval[\"IPSD\", \"IPSD\" + 231 days]\r\n\r\ndefine \"Earliest Antidepressant Dispensed During Intake Period\":\r\n  First([\"Medication, Dispensed\": \"Antidepressant Medication\"] Antidepressant\r\n      where start of Global.\"NormalizeInterval\"(Antidepressant.relevantDatetime, Antidepressant.relevantPeriod) in day of \"Intake Period\"\r\n      sort by start of Global.\"NormalizeInterval\"(relevantDatetime, relevantPeriod)\r\n  )\n\n/*Index Prescription Start Date*/\r\n\r\n\r\ndefine \"IPSD\":\r\n  date from start of Global.\"NormalizeInterval\" ( \"Earliest Antidepressant Dispensed During Intake Period\".relevantDatetime, \"Earliest Antidepressant Dispensed During Intake Period\".relevantPeriod )\r\n\r\ndefine \"Qualifying Encounters\":\r\n  ( [\"Encounter, Performed\": \"Office Visit\"]\r\n    union [\"Encounter, Performed\": \"Preventive Care Services Established Office Visit, 18 and Up\"]\r\n    union [\"Encounter, Performed\": \"Preventive Care Services Initial Office Visit, 18 and Up\"]\r\n    union [\"Encounter, Performed\": \"Home Healthcare Services\"]\r\n    union [\"Encounter, Performed\": \"Annual Wellness Visit\"]\r\n    union [\"Encounter, Performed\": \"Nursing Facility Visit\"]\r\n    union [\"Encounter, Performed\": \"Psych Visit Diagnostic Evaluation\"]\r\n    union [\"Encounter, Performed\": \"Psych Visit Psychotherapy\"]\r\n    union [\"Encounter, Performed\": \"Telephone Visits\"]\r\n    union [\"Encounter, Performed\": \"Virtual Encounter\"] ) ValidEncounter\r\n    where date from start of ValidEncounter.relevantPeriod within 60 days of \"IPSD\"\r\n\r\ndefine \"Denominator Exclusions\":\r\n  Hospice.\"Has Hospice Services\"\r\n    or exists ( [\"Medication, Active\": \"Antidepressant Medication\"] ActiveAntidepressant\r\n        where \"IPSD\" is not null\r\n          and Global.\"ToDateInterval\" ( ActiveAntidepressant.relevantPeriod ) overlaps Interval[\"IPSD\" - 105 days, \"IPSD\" )\r\n    )","elm":{"library":{"annotation":[{"translatorOptions":"EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion,DisableMethodInvocation","type":"CqlToElmInfo"},{"type":"Annotation","s":{"r":"221","s":[{"value":["","library AntidepressantMedicationManagement version '13.0.000'"]}]}}],"identifier":{"id":"AntidepressantMedicationManagement","version":"13.0.000"},"schemaIdentifier":{"id":"urn:hl7-org:elm","version":"r1"},"usings":{"def":[{"localIdentifier":"System","uri":"urn:hl7-org:elm-types:r1"},{"localId":"1","locator":"3:1-3:23","localIdentifier":"QDM","uri":"urn:healthit-gov:qdm:v5_6","version":"5.6","annotation":[{"type":"Annotation","s":{"r":"1","s":[{"value":["","using "]},{"s":[{"value":["QDM"]}]},{"value":[" version ","'5.6'"]}]}}]}]},"includes":{"def":[{"localId":"2","locator":"5:1-5:67","localIdentifier":"Global","path":"MATGlobalCommonFunctionsQDM","version":"8.0.000","annotation":[{"type":"Annotation","s":{"r":"2","s":[{"value":["","include "]},{"s":[{"value":["MATGlobalCommonFunctionsQDM"]}]},{"value":[" version ","'8.0.000'"," called ","Global"]}]}}]},{"localId":"3","locator":"6:1-6:51","localIdentifier":"Hospice","path":"HospiceQDM","version":"6.0.000","annotation":[{"type":"Annotation","s":{"r":"3","s":[{"value":["","include "]},{"s":[{"value":["HospiceQDM"]}]},{"value":[" version ","'6.0.000'"," called ","Hospice"]}]}}]},{"localId":"4","locator":"7:1-7:68","localIdentifier":"CMD","path":"CumulativeMedicationDurationQDM","version":"3.0.000","annotation":[{"type":"Annotation","s":{"r":"4","s":[{"value":["","include "]},{"s":[{"value":["CumulativeMedicationDurationQDM"]}]},{"value":[" version ","'3.0.000'"," called ","CMD"]}]}}]}]},"parameters":{"def":[{"localId":"23","locator":"26:1-26:49","name":"Measurement Period","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"23","s":[{"value":["","parameter ","\"Measurement Period\""," "]},{"r":"22","s":[{"value":["Interval\u003c"]},{"r":"21","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]}]}}],"parameterTypeSpecifier":{"localId":"22","locator":"26:32-26:49","type":"IntervalTypeSpecifier","pointType":{"localId":"21","locator":"26:41-26:48","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},"valueSets":{"def":[{"localId":"5","locator":"9:1-9:74","name":"Annual Wellness Visit","id":"2.16.840.1.113883.3.526.3.1240","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"5","s":[{"value":["","valueset ","\"Annual Wellness Visit\"",": ","'urn:oid:2.16.840.1.113883.3.526.3.1240'"]}]}}]},{"localId":"6","locator":"10:1-10:88","name":"Antidepressant Medication","id":"2.16.840.1.113883.3.464.1003.196.12.1213","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"6","s":[{"value":["","valueset ","\"Antidepressant Medication\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.196.12.1213'"]}]}}]},{"localId":"7","locator":"11:1-11:58","name":"Ethnicity","id":"2.16.840.1.114222.4.11.837","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"7","s":[{"value":["","valueset ","\"Ethnicity\"",": ","'urn:oid:2.16.840.1.114222.4.11.837'"]}]}}]},{"localId":"8","locator":"12:1-12:87","name":"Home Healthcare Services","id":"2.16.840.1.113883.3.464.1003.101.12.1016","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"8","s":[{"value":["","valueset ","\"Home Healthcare Services\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1016'"]}]}}]},{"localId":"9","locator":"13:1-13:79","name":"Major Depression","id":"2.16.840.1.113883.3.464.1003.105.12.1007","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"9","s":[{"value":["","valueset ","\"Major Depression\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.105.12.1007'"]}]}}]},{"localId":"10","locator":"14:1-14:85","name":"Nursing Facility Visit","id":"2.16.840.1.113883.3.464.1003.101.12.1012","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"10","s":[{"value":["","valueset ","\"Nursing Facility Visit\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1012'"]}]}}]},{"localId":"11","locator":"15:1-15:75","name":"Office Visit","id":"2.16.840.1.113883.3.464.1003.101.12.1001","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"11","s":[{"value":["","valueset ","\"Office Visit\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1001'"]}]}}]},{"localId":"12","locator":"16:1-16:68","name":"ONC Administrative Sex","id":"2.16.840.1.113762.1.4.1","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"12","s":[{"value":["","valueset ","\"ONC Administrative Sex\"",": ","'urn:oid:2.16.840.1.113762.1.4.1'"]}]}}]},{"localId":"13","locator":"17:1-17:60","name":"Payer Type","id":"2.16.840.1.114222.4.11.3591","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"13","s":[{"value":["","valueset ","\"Payer Type\"",": ","'urn:oid:2.16.840.1.114222.4.11.3591'"]}]}}]},{"localId":"14","locator":"18:1-18:123","name":"Preventive Care Services Established Office Visit, 18 and Up","id":"2.16.840.1.113883.3.464.1003.101.12.1025","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"14","s":[{"value":["","valueset ","\"Preventive Care Services Established Office Visit, 18 and Up\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1025'"]}]}}]},{"localId":"15","locator":"19:1-19:119","name":"Preventive Care Services Initial Office Visit, 18 and Up","id":"2.16.840.1.113883.3.464.1003.101.12.1023","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"15","s":[{"value":["","valueset ","\"Preventive Care Services Initial Office Visit, 18 and Up\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1023'"]}]}}]},{"localId":"16","locator":"20:1-20:86","name":"Psych Visit Diagnostic Evaluation","id":"2.16.840.1.113883.3.526.3.1492","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"16","s":[{"value":["","valueset ","\"Psych Visit Diagnostic Evaluation\"",": ","'urn:oid:2.16.840.1.113883.3.526.3.1492'"]}]}}]},{"localId":"17","locator":"21:1-21:78","name":"Psych Visit Psychotherapy","id":"2.16.840.1.113883.3.526.3.1496","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"17","s":[{"value":["","valueset ","\"Psych Visit Psychotherapy\"",": ","'urn:oid:2.16.840.1.113883.3.526.3.1496'"]}]}}]},{"localId":"18","locator":"22:1-22:53","name":"Race","id":"2.16.840.1.114222.4.11.836","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"18","s":[{"value":["","valueset ","\"Race\"",": ","'urn:oid:2.16.840.1.114222.4.11.836'"]}]}}]},{"localId":"19","locator":"23:1-23:79","name":"Telephone Visits","id":"2.16.840.1.113883.3.464.1003.101.12.1080","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"19","s":[{"value":["","valueset ","\"Telephone Visits\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1080'"]}]}}]},{"localId":"20","locator":"24:1-24:80","name":"Virtual Encounter","id":"2.16.840.1.113883.3.464.1003.101.12.1089","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"20","s":[{"value":["","valueset ","\"Virtual Encounter\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.101.12.1089'"]}]}}]}]},"contexts":{"def":[{"locator":"28:1-28:15","name":"Patient"}]},"statements":{"def":[{"locator":"28:1-28:15","name":"Patient","context":"Patient","expression":{"type":"SingletonFrom","operand":{"locator":"28:1-28:15","dataType":"{urn:healthit-gov:qdm:v5_6}Patient","templateId":"Patient","type":"Retrieve"}}},{"localId":"25","locator":"30:1-31:51","name":"SDE Ethnicity","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"25","s":[{"value":["","define ","\"SDE Ethnicity\"",":\n  "]},{"r":"24","s":[{"value":["[","\"Patient Characteristic Ethnicity\"",": "]},{"s":[{"value":["\"Ethnicity\""]}]},{"value":["]"]}]}]}}],"expression":{"localId":"24","locator":"31:3-31:51","dataType":"{urn:healthit-gov:qdm:v5_6}PatientCharacteristicEthnicity","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"31:40-31:50","name":"Ethnicity","preserve":true,"type":"ValueSetRef"}}},{"localId":"27","locator":"33:1-34:48","name":"SDE Payer","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"27","s":[{"value":["","define ","\"SDE Payer\"",":\n  "]},{"r":"26","s":[{"value":["[","\"Patient Characteristic Payer\"",": "]},{"s":[{"value":["\"Payer Type\""]}]},{"value":["]"]}]}]}}],"expression":{"localId":"26","locator":"34:3-34:48","dataType":"{urn:healthit-gov:qdm:v5_6}PatientCharacteristicPayer","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"34:36-34:47","name":"Payer Type","preserve":true,"type":"ValueSetRef"}}},{"localId":"29","locator":"36:1-37:41","name":"SDE Race","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"29","s":[{"value":["","define ","\"SDE Race\"",":\n  "]},{"r":"28","s":[{"value":["[","\"Patient Characteristic Race\"",": "]},{"s":[{"value":["\"Race\""]}]},{"value":["]"]}]}]}}],"expression":{"localId":"28","locator":"37:3-37:41","dataType":"{urn:healthit-gov:qdm:v5_6}PatientCharacteristicRace","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"37:35-37:40","name":"Race","preserve":true,"type":"ValueSetRef"}}},{"localId":"31","locator":"39:1-40:58","name":"SDE Sex","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"31","s":[{"value":["","define ","\"SDE Sex\"",":\n  "]},{"r":"30","s":[{"value":["[","\"Patient Characteristic Sex\"",": "]},{"s":[{"value":["\"ONC Administrative Sex\""]}]},{"value":["]"]}]}]}}],"expression":{"localId":"30","locator":"40:3-40:58","dataType":"{urn:healthit-gov:qdm:v5_6}PatientCharacteristicSex","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"40:34-40:57","name":"ONC Administrative Sex","preserve":true,"type":"ValueSetRef"}}},{"localId":"55","locator":"53:1-54:78","name":"May 1 of the Year Prior to the Measurement Period","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"55","s":[{"value":["","define ","\"May 1 of the Year Prior to the Measurement Period\"",":\n  "]},{"r":"54","s":[{"value":["DateTime","("]},{"r":"46","s":[{"value":["("]},{"r":"46","s":[{"r":"44","s":[{"value":["year from "]},{"r":"43","s":[{"value":["start of "]},{"r":"42","s":[{"value":["\"Measurement Period\""]}]}]}]},{"r":"45","value":[" - ","1"]}]},{"value":[")"]}]},{"r":"47","value":[", ","5",", ","1",", ","0",", ","0",", ","0",", ","0",", ","0",")"]}]}]}}],"expression":{"localId":"54","locator":"54:3-54:78","type":"DateTime","year":{"localId":"46","locator":"54:12-54:56","type":"Subtract","operand":[{"localId":"44","locator":"54:13-54:51","precision":"Year","type":"DateTimeComponentFrom","operand":{"localId":"43","locator":"54:23-54:51","type":"Start","operand":{"localId":"42","locator":"54:32-54:51","name":"Measurement Period","type":"ParameterRef"}}},{"localId":"45","locator":"54:55","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}]},"month":{"localId":"47","locator":"54:59","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"5","type":"Literal"},"day":{"localId":"48","locator":"54:62","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"},"hour":{"localId":"49","locator":"54:65","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"},"minute":{"localId":"50","locator":"54:68","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"},"second":{"localId":"51","locator":"54:71","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"},"millisecond":{"localId":"52","locator":"54:74","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"},"timezoneOffset":{"type":"ToDecimal","operand":{"localId":"53","locator":"54:77","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}}}},{"localId":"68","locator":"56:1-57:78","name":"April 30 of the Measurement Period","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"68","s":[{"value":["","define ","\"April 30 of the Measurement Period\"",":\n  "]},{"r":"67","s":[{"value":["DateTime","("]},{"r":"59","s":[{"value":["("]},{"r":"59","s":[{"value":["year from "]},{"r":"58","s":[{"value":["start of "]},{"r":"57","s":[{"value":["\"Measurement Period\""]}]}]}]},{"value":[")"]}]},{"r":"60","value":[", ","4",", ","30",", ","23",", ","59",", ","59",", ","0",", ","0",")"]}]}]}}],"expression":{"localId":"67","locator":"57:3-57:78","type":"DateTime","year":{"localId":"59","locator":"57:12-57:52","precision":"Year","type":"DateTimeComponentFrom","operand":{"localId":"58","locator":"57:23-57:51","type":"Start","operand":{"localId":"57","locator":"57:32-57:51","name":"Measurement Period","type":"ParameterRef"}}},"month":{"localId":"60","locator":"57:55","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"4","type":"Literal"},"day":{"localId":"61","locator":"57:58-57:59","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"30","type":"Literal"},"hour":{"localId":"62","locator":"57:62-57:63","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"23","type":"Literal"},"minute":{"localId":"63","locator":"57:66-57:67","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"59","type":"Literal"},"second":{"localId":"64","locator":"57:70-57:71","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"59","type":"Literal"},"millisecond":{"localId":"65","locator":"57:74","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"},"timezoneOffset":{"type":"ToDecimal","operand":{"localId":"66","locator":"57:77","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}}}},{"localId":"71","locator":"50:1-51:101","name":"Intake Period","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"71","s":[{"value":["","define ","\"Intake Period\"",":\n  "]},{"r":"70","s":[{"value":["Interval["]},{"r":"56","s":[{"value":["\"May 1 of the Year Prior to the Measurement Period\""]}]},{"value":[", "]},{"r":"69","s":[{"value":["\"April 30 of the Measurement Period\""]}]},{"value":["]"]}]}]}}],"expression":{"localId":"70","locator":"51:3-51:101","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"56","locator":"51:12-51:62","name":"May 1 of the Year Prior to the Measurement Period","type":"ExpressionRef"},"high":{"localId":"69","locator":"51:65-51:100","name":"April 30 of the Measurement Period","type":"ExpressionRef"}}},{"localId":"83","locator":"89:1-93:3","name":"Earliest Antidepressant Dispensed During Intake Period","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"83","s":[{"value":["","define ","\"Earliest Antidepressant Dispensed During Intake Period\"",":\n  "]},{"r":"82","s":[{"value":["First","("]},{"r":"81","s":[{"s":[{"r":"34","s":[{"r":"33","s":[{"r":"33","s":[{"value":["[","\"Medication, Dispensed\"",": "]},{"s":[{"value":["\"Antidepressant Medication\""]}]},{"value":["]"]}]}]},{"value":[" ","Antidepressant"]}]}]},{"value":["\n      "]},{"r":"73","s":[{"value":["where "]},{"r":"73","s":[{"r":"41","s":[{"value":["start of "]},{"r":"40","s":[{"r":"35","s":[{"value":["Global"]}]},{"value":["."]},{"r":"40","s":[{"value":["\"NormalizeInterval\"","("]},{"r":"37","s":[{"r":"36","s":[{"value":["Antidepressant"]}]},{"value":["."]},{"r":"37","s":[{"value":["relevantDatetime"]}]}]},{"value":[", "]},{"r":"39","s":[{"r":"38","s":[{"value":["Antidepressant"]}]},{"value":["."]},{"r":"39","s":[{"value":["relevantPeriod"]}]}]},{"value":[")"]}]}]}]},{"value":[" in day of "]},{"r":"72","s":[{"value":["\"Intake Period\""]}]}]}]},{"value":["\n      "]},{"r":"80","s":[{"value":["sort by "]},{"r":"79","s":[{"r":"78","s":[{"value":["start of "]},{"r":"77","s":[{"r":"74","s":[{"value":["Global"]}]},{"value":["."]},{"r":"77","s":[{"value":["\"NormalizeInterval\"","("]},{"r":"75","s":[{"value":["relevantDatetime"]}]},{"value":[", "]},{"r":"76","s":[{"value":["relevantPeriod"]}]},{"value":[")"]}]}]}]}]}]}]},{"value":["\n  )"]}]}]}}],"expression":{"localId":"82","locator":"90:3-93:3","type":"First","source":{"localId":"81","locator":"90:9-92:83","type":"Query","source":[{"localId":"34","locator":"90:9-90:77","alias":"Antidepressant","expression":{"localId":"33","locator":"90:9-90:62","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","templateId":"PositiveMedicationDispensed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"90:35-90:61","name":"Antidepressant Medication","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"73","locator":"91:7-91:137","precision":"Day","type":"In","operand":[{"localId":"41","locator":"91:13-91:111","type":"Start","operand":{"localId":"40","locator":"91:22-91:111","name":"NormalizeInterval","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"37","locator":"91:49-91:79","path":"relevantDatetime","scope":"Antidepressant","type":"Property"},{"localId":"39","locator":"91:82-91:110","path":"relevantPeriod","scope":"Antidepressant","type":"Property"}]}},{"localId":"72","locator":"91:123-91:137","name":"Intake Period","type":"ExpressionRef"}]},"sort":{"localId":"80","locator":"92:7-92:83","by":[{"localId":"79","locator":"92:15-92:83","direction":"asc","type":"ByExpression","expression":{"localId":"78","locator":"92:15-92:83","type":"Start","operand":{"localId":"77","locator":"92:24-92:83","name":"NormalizeInterval","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"75","locator":"92:51-92:66","name":"relevantDatetime","type":"IdentifierRef"},{"localId":"76","locator":"92:69-92:82","name":"relevantPeriod","type":"IdentifierRef"}]}}}]}}}},{"localId":"91","locator":"96:1-97:198","name":"IPSD","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"91","s":[{"value":["/*Index Prescription Start Date*/\n","define ","\"IPSD\"",":\n  "]},{"r":"90","s":[{"value":["date from "]},{"r":"89","s":[{"value":["start of "]},{"r":"88","s":[{"r":"32","s":[{"value":["Global"]}]},{"value":["."]},{"r":"88","s":[{"value":["\"NormalizeInterval\""," ( "]},{"r":"85","s":[{"r":"84","s":[{"value":["\"Earliest Antidepressant Dispensed During Intake Period\""]}]},{"value":["."]},{"r":"85","s":[{"value":["relevantDatetime"]}]}]},{"value":[", "]},{"r":"87","s":[{"r":"86","s":[{"value":["\"Earliest Antidepressant Dispensed During Intake Period\""]}]},{"value":["."]},{"r":"87","s":[{"value":["relevantPeriod"]}]}]},{"value":[" )"]}]}]}]}]}]}}],"expression":{"localId":"90","locator":"97:3-97:198","type":"DateFrom","operand":{"localId":"89","locator":"97:13-97:198","type":"Start","operand":{"localId":"88","locator":"97:22-97:198","name":"NormalizeInterval","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"85","locator":"97:51-97:123","path":"relevantDatetime","type":"Property","source":{"localId":"84","locator":"97:51-97:106","name":"Earliest Antidepressant Dispensed During Intake Period","type":"ExpressionRef"}},{"localId":"87","locator":"97:126-97:196","path":"relevantPeriod","type":"Property","source":{"localId":"86","locator":"97:126-97:181","name":"Earliest Antidepressant Dispensed During Intake Period","type":"ExpressionRef"}}]}}}},{"localId":"111","locator":"71:1-75:3","name":"Has IPSD and Major Depression Diagnosis","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"111","s":[{"value":["","define ","\"Has IPSD and Major Depression Diagnosis\"",":\n  "]},{"r":"110","s":[{"value":["exists "]},{"r":"109","s":[{"value":["( "]},{"r":"109","s":[{"s":[{"r":"98","s":[{"r":"97","s":[{"r":"97","s":[{"value":["[","\"Diagnosis\"",": "]},{"s":[{"value":["\"Major Depression\""]}]},{"value":["]"]}]}]},{"value":[" ","MajorDepression"]}]}]},{"value":["\n      "]},{"r":"108","s":[{"value":["where "]},{"r":"108","s":[{"r":"100","s":[{"r":"99","s":[{"value":["\"IPSD\""]}]},{"value":[" is not null"]}]},{"value":["\n        and "]},{"r":"107","s":[{"r":"104","s":[{"value":["date from "]},{"r":"103","s":[{"value":["start of "]},{"r":"102","s":[{"r":"101","s":[{"value":["MajorDepression"]}]},{"value":["."]},{"r":"102","s":[{"value":["prevalencePeriod"]}]}]}]}]},{"value":[" "]},{"r":"107","s":[{"value":["within "]},{"r":"106","s":[{"value":["60 ","days"]}]},{"value":[" of"]}]},{"value":[" "]},{"r":"105","s":[{"value":["\"IPSD\""]}]}]}]}]}]},{"value":["\n  )"]}]}]}]}}],"expression":{"localId":"110","locator":"72:3-75:3","type":"Exists","operand":{"localId":"109","locator":"72:10-75:3","type":"Query","source":[{"localId":"98","locator":"72:12-72:60","alias":"MajorDepression","expression":{"localId":"97","locator":"72:12-72:44","dataType":"{urn:healthit-gov:qdm:v5_6}Diagnosis","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"72:26-72:43","name":"Major Depression","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"108","locator":"73:7-74:88","type":"And","operand":[{"localId":"100","locator":"73:13-73:30","type":"Not","operand":{"locator":"73:13-73:30","type":"IsNull","operand":{"localId":"99","locator":"73:13-73:18","name":"IPSD","type":"ExpressionRef"}}},{"localId":"107","locator":"74:13-74:88","type":"And","operand":[{"type":"In","operand":[{"localId":"104","locator":"74:13-74:63","type":"DateFrom","operand":{"localId":"103","locator":"74:23-74:63","type":"Start","operand":{"localId":"102","locator":"74:32-74:63","path":"prevalencePeriod","scope":"MajorDepression","type":"Property"}}},{"locator":"74:72-74:78","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"74:72-74:78","type":"Subtract","operand":[{"localId":"105","locator":"74:83-74:88","name":"IPSD","type":"ExpressionRef"},{"localId":"106","locator":"74:72-74:78","value":60,"unit":"days","type":"Quantity"}]},"high":{"locator":"74:72-74:78","type":"Add","operand":[{"localId":"105","locator":"74:83-74:88","name":"IPSD","type":"ExpressionRef"},{"localId":"106","locator":"74:72-74:78","value":60,"unit":"days","type":"Quantity"}]}}]},{"locator":"74:72-74:78","type":"Not","operand":{"locator":"74:72-74:78","type":"IsNull","operand":{"localId":"105","locator":"74:83-74:88","name":"IPSD","type":"ExpressionRef"}}}]}]}}}},{"localId":"146","locator":"99:1-110:83","name":"Qualifying Encounters","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"146","s":[{"value":["","define ","\"Qualifying Encounters\"",":\n  "]},{"r":"145","s":[{"s":[{"r":"137","s":[{"r":"136","s":[{"value":["( "]},{"r":"136","s":[{"r":"133","s":[{"r":"131","s":[{"r":"128","s":[{"r":"126","s":[{"r":"123","s":[{"r":"121","s":[{"r":"118","s":[{"r":"116","s":[{"r":"114","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Office Visit\""]}]},{"value":["]"]}]},{"value":["\n    union "]},{"r":"115","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Preventive Care Services Established Office Visit, 18 and Up\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"117","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Preventive Care Services Initial Office Visit, 18 and Up\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"119","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Home Healthcare Services\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"122","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Annual Wellness Visit\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"124","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Nursing Facility Visit\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"127","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Psych Visit Diagnostic Evaluation\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"129","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Psych Visit Psychotherapy\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"132","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Telephone Visits\""]}]},{"value":["]"]}]}]},{"value":["\n    union "]},{"r":"134","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Virtual Encounter\""]}]},{"value":["]"]}]}]},{"value":[" )"]}]},{"value":[" ","ValidEncounter"]}]}]},{"value":["\n    "]},{"r":"144","s":[{"value":["where "]},{"r":"144","s":[{"r":"141","s":[{"value":["date from "]},{"r":"140","s":[{"value":["start of "]},{"r":"139","s":[{"r":"138","s":[{"value":["ValidEncounter"]}]},{"value":["."]},{"r":"139","s":[{"value":["relevantPeriod"]}]}]}]}]},{"value":[" "]},{"r":"144","s":[{"value":["within "]},{"r":"143","s":[{"value":["60 ","days"]}]},{"value":[" of"]}]},{"value":[" "]},{"r":"142","s":[{"value":["\"IPSD\""]}]}]}]}]}]}}],"expression":{"localId":"145","locator":"100:3-110:83","type":"Query","source":[{"localId":"137","locator":"100:3-109:72","alias":"ValidEncounter","expression":{"localId":"136","locator":"100:3-109:57","type":"Union","operand":[{"localId":"131","locator":"100:5-107:63","type":"Union","operand":[{"localId":"126","locator":"100:5-105:60","type":"Union","operand":[{"localId":"121","locator":"100:5-103:62","type":"Union","operand":[{"localId":"116","locator":"100:5-101:98","type":"Union","operand":[{"localId":"114","locator":"100:5-100:44","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"100:30-100:43","name":"Office Visit","preserve":true,"type":"ValueSetRef"}},{"localId":"115","locator":"101:11-101:98","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"101:36-101:97","name":"Preventive Care Services Established Office Visit, 18 and Up","preserve":true,"type":"ValueSetRef"}}]},{"localId":"120","type":"Union","operand":[{"localId":"117","locator":"102:11-102:94","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"102:36-102:93","name":"Preventive Care Services Initial Office Visit, 18 and Up","preserve":true,"type":"ValueSetRef"}},{"localId":"119","locator":"103:11-103:62","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"103:36-103:61","name":"Home Healthcare Services","preserve":true,"type":"ValueSetRef"}}]}]},{"localId":"125","type":"Union","operand":[{"localId":"122","locator":"104:11-104:59","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"104:36-104:58","name":"Annual Wellness Visit","preserve":true,"type":"ValueSetRef"}},{"localId":"124","locator":"105:11-105:60","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"105:36-105:59","name":"Nursing Facility Visit","preserve":true,"type":"ValueSetRef"}}]}]},{"localId":"130","type":"Union","operand":[{"localId":"127","locator":"106:11-106:71","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"106:36-106:70","name":"Psych Visit Diagnostic Evaluation","preserve":true,"type":"ValueSetRef"}},{"localId":"129","locator":"107:11-107:63","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"107:36-107:62","name":"Psych Visit Psychotherapy","preserve":true,"type":"ValueSetRef"}}]}]},{"localId":"135","type":"Union","operand":[{"localId":"132","locator":"108:11-108:54","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"108:36-108:53","name":"Telephone Visits","preserve":true,"type":"ValueSetRef"}},{"localId":"134","locator":"109:11-109:55","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"109:36-109:54","name":"Virtual Encounter","preserve":true,"type":"ValueSetRef"}}]}]}}],"relationship":[],"where":{"localId":"144","locator":"110:5-110:83","type":"And","operand":[{"type":"In","operand":[{"localId":"141","locator":"110:11-110:58","type":"DateFrom","operand":{"localId":"140","locator":"110:21-110:58","type":"Start","operand":{"localId":"139","locator":"110:30-110:58","path":"relevantPeriod","scope":"ValidEncounter","type":"Property"}}},{"locator":"110:67-110:73","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"110:67-110:73","type":"Subtract","operand":[{"localId":"142","locator":"110:78-110:83","name":"IPSD","type":"ExpressionRef"},{"localId":"143","locator":"110:67-110:73","value":60,"unit":"days","type":"Quantity"}]},"high":{"locator":"110:67-110:73","type":"Add","operand":[{"localId":"142","locator":"110:78-110:83","name":"IPSD","type":"ExpressionRef"},{"localId":"143","locator":"110:67-110:73","value":60,"unit":"days","type":"Quantity"}]}}]},{"locator":"110:67-110:73","type":"Not","operand":{"locator":"110:67-110:73","type":"IsNull","operand":{"localId":"142","locator":"110:78-110:83","name":"IPSD","type":"ExpressionRef"}}}]}}},{"localId":"150","locator":"45:1-48:38","name":"Initial Population","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"150","s":[{"value":["","define ","\"Initial Population\"",":\n  "]},{"r":"149","s":[{"r":"113","s":[{"r":"96","s":[{"r":"94","s":[{"value":["AgeInYearsAt","("]},{"r":"93","s":[{"value":["date from "]},{"r":"92","s":[{"value":["\"IPSD\""]}]}]},{"value":[")"]}]},{"r":"95","value":[" ","\u003e="," ","18"]}]},{"value":["\n    and "]},{"r":"112","s":[{"value":["\"Has IPSD and Major Depression Diagnosis\""]}]}]},{"value":["\n    and "]},{"r":"148","s":[{"value":["exists "]},{"r":"147","s":[{"value":["\"Qualifying Encounters\""]}]}]}]}]}}],"expression":{"localId":"149","locator":"46:3-48:38","type":"And","operand":[{"localId":"113","locator":"46:3-47:49","type":"And","operand":[{"localId":"96","locator":"46:3-46:38","type":"GreaterOrEqual","operand":[{"localId":"94","locator":"46:3-46:32","precision":"Year","type":"CalculateAgeAt","operand":[{"type":"ToDate","operand":{"path":"birthDatetime","type":"Property","source":{"name":"Patient","type":"ExpressionRef"}}},{"localId":"93","locator":"46:16-46:31","type":"DateFrom","operand":{"type":"ToDateTime","operand":{"localId":"92","locator":"46:26-46:31","name":"IPSD","type":"ExpressionRef"}}}]},{"localId":"95","locator":"46:37-46:38","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"18","type":"Literal"}]},{"localId":"112","locator":"47:9-47:49","name":"Has IPSD and Major Depression Diagnosis","type":"ExpressionRef"}]},{"localId":"148","locator":"48:9-48:38","type":"Exists","operand":{"localId":"147","locator":"48:16-48:38","name":"Qualifying Encounters","type":"ExpressionRef"}}]}},{"localId":"152","locator":"42:1-43:22","name":"Denominator","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"152","s":[{"value":["","define ","\"Denominator\"",":\n  "]},{"r":"151","s":[{"value":["\"Initial Population\""]}]}]}}],"expression":{"localId":"151","locator":"43:3-43:22","name":"Initial Population","type":"ExpressionRef"}},{"localId":"169","locator":"83:1-87:51","name":"Antidepressant Medication Period Between IPSD and 231 Days After IPSD","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"169","s":[{"value":["","define ","\"Antidepressant Medication Period Between IPSD and 231 Days After IPSD\"",":\n  "]},{"r":"168","s":[{"s":[{"r":"155","s":[{"r":"154","s":[{"r":"154","s":[{"value":["[","\"Medication, Dispensed\"",": "]},{"s":[{"value":["\"Antidepressant Medication\""]}]},{"value":["]"]}]}]},{"value":[" ","Antidepressant"]}]}]},{"value":["\n    "]},{"s":[{"value":["let "]},{"r":"159","s":[{"value":["MedicationPeriod",": "]},{"r":"158","s":[{"r":"156","s":[{"value":["CMD"]}]},{"value":["."]},{"r":"158","s":[{"value":["\"MedicationDispensedPeriod\""," ( "]},{"r":"157","s":[{"value":["Antidepressant"]}]},{"value":[" )"]}]}]}]}]},{"value":["\n    "]},{"r":"167","s":[{"value":["return "]},{"r":"166","s":[{"r":"160","s":[{"value":["MedicationPeriod"]}]},{"value":["\n      intersect "]},{"r":"165","s":[{"value":["Interval["]},{"r":"161","s":[{"value":["\"IPSD\""]}]},{"value":[", "]},{"r":"164","s":[{"r":"162","s":[{"value":["\"IPSD\""]}]},{"value":[" + "]},{"r":"163","s":[{"value":["231 ","days"]}]}]},{"value":["]"]}]}]}]}]}]}}],"expression":{"localId":"168","locator":"84:3-87:51","type":"Query","source":[{"localId":"155","locator":"84:3-84:71","alias":"Antidepressant","expression":{"localId":"154","locator":"84:3-84:56","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","templateId":"PositiveMedicationDispensed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"84:29-84:55","name":"Antidepressant Medication","preserve":true,"type":"ValueSetRef"}}}],"let":[{"localId":"159","locator":"85:9-85:76","identifier":"MedicationPeriod","expression":{"localId":"158","locator":"85:27-85:76","name":"MedicationDispensedPeriod","libraryName":"CMD","type":"FunctionRef","operand":[{"localId":"157","locator":"85:61-85:74","name":"Antidepressant","type":"AliasRef"}]}}],"relationship":[],"return":{"localId":"167","locator":"86:5-87:51","expression":{"localId":"166","locator":"86:12-87:51","type":"Intersect","operand":[{"localId":"160","locator":"86:12-86:27","name":"MedicationPeriod","type":"QueryLetRef"},{"localId":"165","locator":"87:17-87:51","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"161","locator":"87:26-87:31","name":"IPSD","type":"ExpressionRef"},"high":{"localId":"164","locator":"87:34-87:50","type":"Add","operand":[{"localId":"162","locator":"87:34-87:39","name":"IPSD","type":"ExpressionRef"},{"localId":"163","locator":"87:43-87:50","value":231,"unit":"days","type":"Quantity"}]}}]}}}},{"localId":"174","locator":"65:1-66:109","name":"Cumulative Medication Duration Greater Than or Equal to 180 Days","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"174","s":[{"value":["","define ","\"Cumulative Medication Duration Greater Than or Equal to 180 Days\"",":\n  "]},{"r":"173","s":[{"r":"171","s":[{"r":"153","s":[{"value":["CMD"]}]},{"value":["."]},{"r":"171","s":[{"value":["\"CumulativeDuration\""," ( "]},{"r":"170","s":[{"value":["\"Antidepressant Medication Period Between IPSD and 231 Days After IPSD\""]}]},{"value":[" )"]}]}]},{"r":"172","value":[" ","\u003e="," ","180"]}]}]}}],"expression":{"localId":"173","locator":"66:3-66:109","type":"GreaterOrEqual","operand":[{"localId":"171","locator":"66:3-66:102","name":"CumulativeDuration","libraryName":"CMD","type":"FunctionRef","operand":[{"localId":"170","locator":"66:30-66:100","name":"Antidepressant Medication Period Between IPSD and 231 Days After IPSD","type":"ExpressionRef"}]},{"localId":"172","locator":"66:107-66:109","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"180","type":"Literal"}]}},{"localId":"176","locator":"59:1-60:68","name":"Numerator 2","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"176","s":[{"value":["","define ","\"Numerator 2\"",":\n  "]},{"r":"175","s":[{"value":["\"Cumulative Medication Duration Greater Than or Equal to 180 Days\""]}]}]}}],"expression":{"localId":"175","locator":"60:3-60:68","name":"Cumulative Medication Duration Greater Than or Equal to 180 Days","type":"ExpressionRef"}},{"localId":"193","locator":"77:1-81:51","name":"Antidepressant Medication Period Between IPSD and 114 Days After IPSD","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"193","s":[{"value":["","define ","\"Antidepressant Medication Period Between IPSD and 114 Days After IPSD\"",":\n  "]},{"r":"192","s":[{"s":[{"r":"179","s":[{"r":"178","s":[{"r":"178","s":[{"value":["[","\"Medication, Dispensed\"",": "]},{"s":[{"value":["\"Antidepressant Medication\""]}]},{"value":["]"]}]}]},{"value":[" ","Antidepressant"]}]}]},{"value":["\n    "]},{"s":[{"value":["let "]},{"r":"183","s":[{"value":["MedicationPeriod",": "]},{"r":"182","s":[{"r":"180","s":[{"value":["CMD"]}]},{"value":["."]},{"r":"182","s":[{"value":["\"MedicationDispensedPeriod\""," ( "]},{"r":"181","s":[{"value":["Antidepressant"]}]},{"value":[" )"]}]}]}]}]},{"value":["\n    "]},{"r":"191","s":[{"value":["return "]},{"r":"190","s":[{"r":"184","s":[{"value":["MedicationPeriod"]}]},{"value":["\n      intersect "]},{"r":"189","s":[{"value":["Interval["]},{"r":"185","s":[{"value":["\"IPSD\""]}]},{"value":[", "]},{"r":"188","s":[{"r":"186","s":[{"value":["\"IPSD\""]}]},{"value":[" + "]},{"r":"187","s":[{"value":["114 ","days"]}]}]},{"value":["]"]}]}]}]}]}]}}],"expression":{"localId":"192","locator":"78:3-81:51","type":"Query","source":[{"localId":"179","locator":"78:3-78:71","alias":"Antidepressant","expression":{"localId":"178","locator":"78:3-78:56","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","templateId":"PositiveMedicationDispensed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"78:29-78:55","name":"Antidepressant Medication","preserve":true,"type":"ValueSetRef"}}}],"let":[{"localId":"183","locator":"79:9-79:76","identifier":"MedicationPeriod","expression":{"localId":"182","locator":"79:27-79:76","name":"MedicationDispensedPeriod","libraryName":"CMD","type":"FunctionRef","operand":[{"localId":"181","locator":"79:61-79:74","name":"Antidepressant","type":"AliasRef"}]}}],"relationship":[],"return":{"localId":"191","locator":"80:5-81:51","expression":{"localId":"190","locator":"80:12-81:51","type":"Intersect","operand":[{"localId":"184","locator":"80:12-80:27","name":"MedicationPeriod","type":"QueryLetRef"},{"localId":"189","locator":"81:17-81:51","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"185","locator":"81:26-81:31","name":"IPSD","type":"ExpressionRef"},"high":{"localId":"188","locator":"81:34-81:50","type":"Add","operand":[{"localId":"186","locator":"81:34-81:39","name":"IPSD","type":"ExpressionRef"},{"localId":"187","locator":"81:43-81:50","value":114,"unit":"days","type":"Quantity"}]}}]}}}},{"localId":"198","locator":"68:1-69:108","name":"Cumulative Medication Duration Greater Than or Equal to 84 Days","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"198","s":[{"value":["","define ","\"Cumulative Medication Duration Greater Than or Equal to 84 Days\"",":\n  "]},{"r":"197","s":[{"r":"195","s":[{"r":"177","s":[{"value":["CMD"]}]},{"value":["."]},{"r":"195","s":[{"value":["\"CumulativeDuration\""," ( "]},{"r":"194","s":[{"value":["\"Antidepressant Medication Period Between IPSD and 114 Days After IPSD\""]}]},{"value":[" )"]}]}]},{"r":"196","value":[" ","\u003e="," ","84"]}]}]}}],"expression":{"localId":"197","locator":"69:3-69:108","type":"GreaterOrEqual","operand":[{"localId":"195","locator":"69:3-69:102","name":"CumulativeDuration","libraryName":"CMD","type":"FunctionRef","operand":[{"localId":"194","locator":"69:30-69:100","name":"Antidepressant Medication Period Between IPSD and 114 Days After IPSD","type":"ExpressionRef"}]},{"localId":"196","locator":"69:107-69:108","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"84","type":"Literal"}]}},{"localId":"200","locator":"62:1-63:67","name":"Numerator 1","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"200","s":[{"value":["","define ","\"Numerator 1\"",":\n  "]},{"r":"199","s":[{"value":["\"Cumulative Medication Duration Greater Than or Equal to 84 Days\""]}]}]}}],"expression":{"localId":"199","locator":"63:3-63:67","name":"Cumulative Medication Duration Greater Than or Equal to 84 Days","type":"ExpressionRef"}},{"localId":"221","locator":"112:1-117:5","name":"Denominator Exclusions","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"221","s":[{"value":["","define ","\"Denominator Exclusions\"",":\n  "]},{"r":"220","s":[{"r":"202","s":[{"r":"201","s":[{"value":["Hospice"]}]},{"value":["."]},{"r":"202","s":[{"value":["\"Has Hospice Services\""]}]}]},{"value":["\n    or "]},{"r":"219","s":[{"value":["exists "]},{"r":"218","s":[{"value":["( "]},{"r":"218","s":[{"s":[{"r":"204","s":[{"r":"203","s":[{"r":"203","s":[{"value":["[","\"Medication, Active\"",": "]},{"s":[{"value":["\"Antidepressant Medication\""]}]},{"value":["]"]}]}]},{"value":[" ","ActiveAntidepressant"]}]}]},{"value":["\n        "]},{"r":"217","s":[{"value":["where "]},{"r":"217","s":[{"r":"206","s":[{"r":"205","s":[{"value":["\"IPSD\""]}]},{"value":[" is not null"]}]},{"value":["\n          and "]},{"r":"216","s":[{"r":"210","s":[{"r":"207","s":[{"value":["Global"]}]},{"value":["."]},{"r":"210","s":[{"value":["\"ToDateInterval\""," ( "]},{"r":"209","s":[{"r":"208","s":[{"value":["ActiveAntidepressant"]}]},{"value":["."]},{"r":"209","s":[{"value":["relevantPeriod"]}]}]},{"value":[" )"]}]}]},{"r":"216","value":[" ","overlaps"," "]},{"r":"215","s":[{"value":["Interval["]},{"r":"213","s":[{"r":"211","s":[{"value":["\"IPSD\""]}]},{"value":[" - "]},{"r":"212","s":[{"value":["105 ","days"]}]}]},{"value":[", "]},{"r":"214","s":[{"value":["\"IPSD\""]}]},{"value":[" )"]}]}]}]}]}]},{"value":["\n    )"]}]}]}]}]}}],"expression":{"localId":"220","locator":"113:3-117:5","type":"Or","operand":[{"localId":"202","locator":"113:3-113:32","name":"Has Hospice Services","libraryName":"Hospice","type":"ExpressionRef"},{"localId":"219","locator":"114:8-117:5","type":"Exists","operand":{"localId":"218","locator":"114:15-117:5","type":"Query","source":[{"localId":"204","locator":"114:17-114:88","alias":"ActiveAntidepressant","expression":{"localId":"203","locator":"114:17-114:67","dataType":"{urn:healthit-gov:qdm:v5_6}MedicationActive","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"114:40-114:66","name":"Antidepressant Medication","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"217","locator":"115:9-116:123","type":"And","operand":[{"localId":"206","locator":"115:15-115:32","type":"Not","operand":{"locator":"115:15-115:32","type":"IsNull","operand":{"localId":"205","locator":"115:15-115:20","name":"IPSD","type":"ExpressionRef"}}},{"localId":"216","locator":"116:15-116:123","type":"Overlaps","operand":[{"localId":"210","locator":"116:15-116:77","name":"ToDateInterval","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"209","locator":"116:41-116:75","path":"relevantPeriod","scope":"ActiveAntidepressant","type":"Property"}]},{"localId":"215","locator":"116:88-116:123","lowClosed":true,"highClosed":false,"type":"Interval","low":{"localId":"213","locator":"116:97-116:113","type":"Subtract","operand":[{"localId":"211","locator":"116:97-116:102","name":"IPSD","type":"ExpressionRef"},{"localId":"212","locator":"116:106-116:113","value":105,"unit":"days","type":"Quantity"}]},"high":{"localId":"214","locator":"116:116-116:121","name":"IPSD","type":"ExpressionRef"}}]}]}}}]}}]}}},"elm_annotations":{"statements":[{"children":[{"children":[{"children":[{"text":"define \"SDE Ethnicity\":\n  "}]},{"children":[{"children":[{"text":"[\"Patient Characteristic Ethnicity\": "}]},{"children":[{"children":[{"text":"\"Ethnicity\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"24"}],"ref_id":"25"}],"define_name":"SDE Ethnicity"},{"children":[{"children":[{"children":[{"text":"define \"SDE Payer\":\n  "}]},{"children":[{"children":[{"text":"[\"Patient Characteristic Payer\": "}]},{"children":[{"children":[{"text":"\"Payer Type\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"26"}],"ref_id":"27"}],"define_name":"SDE Payer"},{"children":[{"children":[{"children":[{"text":"define \"SDE Race\":\n  "}]},{"children":[{"children":[{"text":"[\"Patient Characteristic Race\": "}]},{"children":[{"children":[{"text":"\"Race\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"28"}],"ref_id":"29"}],"define_name":"SDE Race"},{"children":[{"children":[{"children":[{"text":"define \"SDE Sex\":\n  "}]},{"children":[{"children":[{"text":"[\"Patient Characteristic Sex\": "}]},{"children":[{"children":[{"text":"\"ONC Administrative Sex\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"30"}],"ref_id":"31"}],"define_name":"SDE Sex"},{"children":[{"children":[{"children":[{"text":"define \"May 1 of the Year Prior to the Measurement Period\":\n  "}]},{"children":[{"children":[{"text":"DateTime("}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"children":[{"text":"year from "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"42"}],"node_type":"Start","ref_id":"43"}],"node_type":"DateTimeComponentFrom","ref_id":"44"},{"children":[{"text":" - 1"}],"node_type":"Literal","ref_id":"45"}],"ref_id":"46"},{"children":[{"text":")"}]}],"ref_id":"46"},{"children":[{"text":", 5, 1, 0, 0, 0, 0, 0)"}],"ref_id":"47"}],"node_type":"DateTime","ref_id":"54"}],"ref_id":"55"}],"define_name":"May 1 of the Year Prior to the Measurement Period"},{"children":[{"children":[{"children":[{"text":"define \"April 30 of the Measurement Period\":\n  "}]},{"children":[{"children":[{"text":"DateTime("}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"year from "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"57"}],"node_type":"Start","ref_id":"58"}],"ref_id":"59"},{"children":[{"text":")"}]}],"ref_id":"59"},{"children":[{"text":", 4, 30, 23, 59, 59, 0, 0)"}],"ref_id":"60"}],"node_type":"DateTime","ref_id":"67"}],"ref_id":"68"}],"define_name":"April 30 of the Measurement Period"},{"children":[{"children":[{"children":[{"text":"define \"Intake Period\":\n  "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"\"May 1 of the Year Prior to the Measurement Period\""}]}],"ref_id":"56"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"\"April 30 of the Measurement Period\""}]}],"ref_id":"69"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"70"}],"ref_id":"71"}],"define_name":"Intake Period"},{"children":[{"children":[{"children":[{"text":"define \"Earliest Antidepressant Dispensed During Intake Period\":\n  "}]},{"children":[{"children":[{"text":"First("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Medication, Dispensed\": "}]},{"children":[{"children":[{"text":"\"Antidepressant Medication\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"33"}],"node_type":"Retrieve","ref_id":"33"},{"children":[{"text":" Antidepressant"}]}],"ref_id":"34"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"35"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"NormalizeInterval\"("}]},{"children":[{"children":[{"children":[{"text":"Antidepressant"}]}],"ref_id":"36"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"Property","ref_id":"37"}],"node_type":"Property","ref_id":"37"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"Antidepressant"}]}],"ref_id":"38"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"39"}],"node_type":"Property","ref_id":"39"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"40"}],"node_type":"FunctionRef","ref_id":"40"}],"node_type":"Start","ref_id":"41"},{"children":[{"text":" in day of "}]},{"children":[{"children":[{"text":"\"Intake Period\""}]}],"node_type":"ExpressionRef","ref_id":"72"}],"ref_id":"73"}],"ref_id":"73"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"sort by "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"74"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"NormalizeInterval\"("}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"IdentifierRef","ref_id":"75"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"76"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"77"}],"node_type":"FunctionRef","ref_id":"77"}],"node_type":"Start","ref_id":"78"}],"ref_id":"79"}],"ref_id":"80"}],"ref_id":"81"},{"children":[{"text":"\n  )"}]}],"node_type":"First","ref_id":"82"}],"ref_id":"83"}],"define_name":"Earliest Antidepressant Dispensed During Intake Period"},{"children":[{"children":[{"children":[{"text":"/*Index Prescription Start Date*/\ndefine \"IPSD\":\n  "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"32"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"NormalizeInterval\" ( "}]},{"children":[{"children":[{"children":[{"text":"\"Earliest Antidepressant Dispensed During Intake Period\""}]}],"ref_id":"84"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"Property","ref_id":"85"}],"node_type":"Property","ref_id":"85"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"\"Earliest Antidepressant Dispensed During Intake Period\""}]}],"ref_id":"86"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"87"}],"node_type":"Property","ref_id":"87"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"88"}],"node_type":"FunctionRef","ref_id":"88"}],"node_type":"Start","ref_id":"89"}],"node_type":"DateFrom","ref_id":"90"}],"ref_id":"91"}],"define_name":"IPSD"},{"children":[{"children":[{"children":[{"text":"define \"Has IPSD and Major Depression Diagnosis\":\n  "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Diagnosis\": "}]},{"children":[{"children":[{"text":"\"Major Depression\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"97"}],"node_type":"Retrieve","ref_id":"97"},{"children":[{"text":" MajorDepression"}]}],"ref_id":"98"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"99"},{"children":[{"text":" is not null"}]}],"node_type":"Not","ref_id":"100"},{"children":[{"text":"\n        and "}]},{"children":[{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"MajorDepression"}]}],"ref_id":"101"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"prevalencePeriod"}]}],"node_type":"Property","ref_id":"102"}],"node_type":"Property","ref_id":"102"}],"node_type":"Start","ref_id":"103"}],"node_type":"DateFrom","ref_id":"104"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"within "}]},{"children":[{"children":[{"text":"60 days"}]}],"node_type":"Quantity","ref_id":"106"},{"children":[{"text":" of"}]}],"node_type":"And","ref_id":"107"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"105"}],"node_type":"And","ref_id":"107"}],"ref_id":"108"}],"ref_id":"108"}],"node_type":"Query","ref_id":"109"},{"children":[{"text":"\n  )"}]}],"node_type":"Query","ref_id":"109"}],"node_type":"Exists","ref_id":"110"}],"ref_id":"111"}],"define_name":"Has IPSD and Major Depression Diagnosis"},{"children":[{"children":[{"children":[{"text":"define \"Qualifying Encounters\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Office Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"114"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Preventive Care Services Established Office Visit, 18 and Up\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"115"}],"node_type":"Union","ref_id":"116"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Preventive Care Services Initial Office Visit, 18 and Up\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"117"}],"ref_id":"118"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Home Healthcare Services\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"119"}],"node_type":"Union","ref_id":"121"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Annual Wellness Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"122"}],"ref_id":"123"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Nursing Facility Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"124"}],"node_type":"Union","ref_id":"126"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Psych Visit Diagnostic Evaluation\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"127"}],"ref_id":"128"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Psych Visit Psychotherapy\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"129"}],"node_type":"Union","ref_id":"131"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Telephone Visits\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"132"}],"ref_id":"133"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Virtual Encounter\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"134"}],"node_type":"Union","ref_id":"136"},{"children":[{"text":" )"}]}],"node_type":"Union","ref_id":"136"},{"children":[{"text":" ValidEncounter"}]}],"ref_id":"137"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"ValidEncounter"}]}],"ref_id":"138"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"139"}],"node_type":"Property","ref_id":"139"}],"node_type":"Start","ref_id":"140"}],"node_type":"DateFrom","ref_id":"141"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"within "}]},{"children":[{"children":[{"text":"60 days"}]}],"node_type":"Quantity","ref_id":"143"},{"children":[{"text":" of"}]}],"ref_id":"144"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"142"}],"ref_id":"144"}],"ref_id":"144"}],"node_type":"Query","ref_id":"145"}],"ref_id":"146"}],"define_name":"Qualifying Encounters"},{"children":[{"children":[{"children":[{"text":"define \"Initial Population\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"AgeInYearsAt("}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"92"}],"node_type":"DateFrom","ref_id":"93"},{"children":[{"text":")"}]}],"node_type":"CalculateAgeAt","ref_id":"94"},{"children":[{"text":" \u003e= 18"}],"node_type":"Literal","ref_id":"95"}],"node_type":"GreaterOrEqual","ref_id":"96"},{"children":[{"text":"\n    and "}]},{"children":[{"children":[{"text":"\"Has IPSD and Major Depression Diagnosis\""}]}],"node_type":"ExpressionRef","ref_id":"112"}],"node_type":"And","ref_id":"113"},{"children":[{"text":"\n    and "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"\"Qualifying Encounters\""}]}],"node_type":"ExpressionRef","ref_id":"147"}],"node_type":"Exists","ref_id":"148"}],"node_type":"And","ref_id":"149"}],"ref_id":"150"}],"define_name":"Initial Population"},{"children":[{"children":[{"children":[{"text":"define \"Denominator\":\n  "}]},{"children":[{"children":[{"text":"\"Initial Population\""}]}],"node_type":"ExpressionRef","ref_id":"151"}],"ref_id":"152"}],"define_name":"Denominator"},{"children":[{"children":[{"children":[{"text":"define \"Antidepressant Medication Period Between IPSD and 231 Days After IPSD\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Medication, Dispensed\": "}]},{"children":[{"children":[{"text":"\"Antidepressant Medication\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"154"}],"node_type":"Retrieve","ref_id":"154"},{"children":[{"text":" Antidepressant"}]}],"ref_id":"155"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"MedicationPeriod: "}]},{"children":[{"children":[{"children":[{"text":"CMD"}]}],"ref_id":"156"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"MedicationDispensedPeriod\" ( "}]},{"children":[{"children":[{"text":"Antidepressant"}]}],"node_type":"AliasRef","ref_id":"157"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"158"}],"node_type":"FunctionRef","ref_id":"158"}],"ref_id":"159"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"children":[{"text":"MedicationPeriod"}]}],"node_type":"QueryLetRef","ref_id":"160"},{"children":[{"text":"\n      intersect "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"\"IPSD\""}]}],"ref_id":"161"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"162"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"231 days"}]}],"node_type":"Quantity","ref_id":"163"}],"ref_id":"164"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"165"}],"node_type":"Intersect","ref_id":"166"}],"ref_id":"167"}],"node_type":"Query","ref_id":"168"}],"ref_id":"169"}],"define_name":"Antidepressant Medication Period Between IPSD and 231 Days After IPSD"},{"children":[{"children":[{"children":[{"text":"define \"Cumulative Medication Duration Greater Than or Equal to 180 Days\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"text":"CMD"}]}],"ref_id":"153"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"CumulativeDuration\" ( "}]},{"children":[{"children":[{"text":"\"Antidepressant Medication Period Between IPSD and 231 Days After IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"170"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"171"}],"node_type":"FunctionRef","ref_id":"171"},{"children":[{"text":" \u003e= 180"}],"node_type":"Literal","ref_id":"172"}],"node_type":"GreaterOrEqual","ref_id":"173"}],"ref_id":"174"}],"define_name":"Cumulative Medication Duration Greater Than or Equal to 180 Days"},{"children":[{"children":[{"children":[{"text":"define \"Numerator 2\":\n  "}]},{"children":[{"children":[{"text":"\"Cumulative Medication Duration Greater Than or Equal to 180 Days\""}]}],"node_type":"ExpressionRef","ref_id":"175"}],"ref_id":"176"}],"define_name":"Numerator 2"},{"children":[{"children":[{"children":[{"text":"define \"Antidepressant Medication Period Between IPSD and 114 Days After IPSD\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Medication, Dispensed\": "}]},{"children":[{"children":[{"text":"\"Antidepressant Medication\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"178"}],"node_type":"Retrieve","ref_id":"178"},{"children":[{"text":" Antidepressant"}]}],"ref_id":"179"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"MedicationPeriod: "}]},{"children":[{"children":[{"children":[{"text":"CMD"}]}],"ref_id":"180"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"MedicationDispensedPeriod\" ( "}]},{"children":[{"children":[{"text":"Antidepressant"}]}],"node_type":"AliasRef","ref_id":"181"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"182"}],"node_type":"FunctionRef","ref_id":"182"}],"ref_id":"183"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"children":[{"text":"MedicationPeriod"}]}],"node_type":"QueryLetRef","ref_id":"184"},{"children":[{"text":"\n      intersect "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"\"IPSD\""}]}],"ref_id":"185"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"186"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"114 days"}]}],"node_type":"Quantity","ref_id":"187"}],"ref_id":"188"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"189"}],"node_type":"Intersect","ref_id":"190"}],"ref_id":"191"}],"node_type":"Query","ref_id":"192"}],"ref_id":"193"}],"define_name":"Antidepressant Medication Period Between IPSD and 114 Days After IPSD"},{"children":[{"children":[{"children":[{"text":"define \"Cumulative Medication Duration Greater Than or Equal to 84 Days\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"text":"CMD"}]}],"ref_id":"177"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"CumulativeDuration\" ( "}]},{"children":[{"children":[{"text":"\"Antidepressant Medication Period Between IPSD and 114 Days After IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"194"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"195"}],"node_type":"FunctionRef","ref_id":"195"},{"children":[{"text":" \u003e= 84"}],"node_type":"Literal","ref_id":"196"}],"node_type":"GreaterOrEqual","ref_id":"197"}],"ref_id":"198"}],"define_name":"Cumulative Medication Duration Greater Than or Equal to 84 Days"},{"children":[{"children":[{"children":[{"text":"define \"Numerator 1\":\n  "}]},{"children":[{"children":[{"text":"\"Cumulative Medication Duration Greater Than or Equal to 84 Days\""}]}],"node_type":"ExpressionRef","ref_id":"199"}],"ref_id":"200"}],"define_name":"Numerator 1"},{"children":[{"children":[{"children":[{"text":"define \"Denominator Exclusions\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"text":"Hospice"}]}],"ref_id":"201"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"Has Hospice Services\""}]}],"node_type":"ExpressionRef","ref_id":"202"}],"node_type":"ExpressionRef","ref_id":"202"},{"children":[{"text":"\n    or "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Medication, Active\": "}]},{"children":[{"children":[{"text":"\"Antidepressant Medication\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"203"}],"node_type":"Retrieve","ref_id":"203"},{"children":[{"text":" ActiveAntidepressant"}]}],"ref_id":"204"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"205"},{"children":[{"text":" is not null"}]}],"node_type":"Not","ref_id":"206"},{"children":[{"text":"\n          and "}]},{"children":[{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"207"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"ToDateInterval\" ( "}]},{"children":[{"children":[{"children":[{"text":"ActiveAntidepressant"}]}],"ref_id":"208"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"209"}],"node_type":"Property","ref_id":"209"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"210"}],"node_type":"FunctionRef","ref_id":"210"},{"children":[{"text":" overlaps "}],"node_type":"Overlaps","ref_id":"216"},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"children":[{"text":"\"IPSD\""}]}],"node_type":"ExpressionRef","ref_id":"211"},{"children":[{"text":" - "}]},{"children":[{"children":[{"text":"105 days"}]}],"node_type":"Quantity","ref_id":"212"}],"ref_id":"213"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"\"IPSD\""}]}],"ref_id":"214"},{"children":[{"text":" )"}]}],"node_type":"Interval","ref_id":"215"}],"node_type":"Overlaps","ref_id":"216"}],"ref_id":"217"}],"ref_id":"217"}],"node_type":"Query","ref_id":"218"},{"children":[{"text":"\n    )"}]}],"node_type":"Query","ref_id":"218"}],"node_type":"Exists","ref_id":"219"}],"node_type":"Or","ref_id":"220"}],"ref_id":"221"}],"define_name":"Denominator Exclusions"}],"identifier":{"id":"AntidepressantMedicationManagement","version":"13.0.000"}},"is_main_library":true,"is_top_level":true,"library_name":"AntidepressantMedicationManagement","library_version":"13.0.000","statement_dependencies":[{"_id":"68923b74a83e15671c2c8b85","statement_name":"Patient"},{"_id":"68923b74a83e15671c2c8b86","statement_name":"SDE Ethnicity"},{"_id":"68923b74a83e15671c2c8b87","statement_name":"SDE Payer"},{"_id":"68923b74a83e15671c2c8b88","statement_name":"SDE Race"},{"_id":"68923b74a83e15671c2c8b89","statement_name":"SDE Sex"},{"_id":"68923b74a83e15671c2c8b8a","statement_name":"May 1 of the Year Prior to the Measurement Period"},{"_id":"68923b74a83e15671c2c8b8b","statement_name":"April 30 of the Measurement Period"},{"_id":"68923b74a83e15671c2c8b8c","statement_name":"Intake Period","statement_references":[{"_id":"68923b74a83e15671c2c8b70","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"May 1 of the Year Prior to the Measurement Period"},{"_id":"68923b74a83e15671c2c8b71","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"April 30 of the Measurement Period"}]},{"_id":"68923b74a83e15671c2c8b8d","statement_name":"Earliest Antidepressant Dispensed During Intake Period","statement_references":[{"_id":"68923b74a83e15671c2c8b72","hqmf_id":null,"library_name":"MATGlobalCommonFunctionsQDM","statement_name":"NormalizeInterval"},{"_id":"68923b74a83e15671c2c8b73","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Intake Period"}]},{"_id":"68923b74a83e15671c2c8b8e","statement_name":"IPSD","statement_references":[{"_id":"68923b74a83e15671c2c8b74","hqmf_id":null,"library_name":"MATGlobalCommonFunctionsQDM","statement_name":"NormalizeInterval"},{"_id":"68923b74a83e15671c2c8b75","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Earliest Antidepressant Dispensed During Intake Period"}]},{"_id":"68923b74a83e15671c2c8b8f","statement_name":"Has IPSD and Major Depression Diagnosis","statement_references":[{"_id":"68923b7ca83e15671c2c8e39","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"IPSD"}]},{"_id":"68923b74a83e15671c2c8b90","statement_name":"Qualifying Encounters","statement_references":[{"_id":"68923b7ca83e15671c2c8e3a","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"IPSD"}]},{"_id":"68923b74a83e15671c2c8b91","statement_name":"Initial Population","statement_references":[{"_id":"68923b74a83e15671c2c8b76","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Patient"},{"_id":"68923b74a83e15671c2c8b77","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"IPSD"},{"_id":"68923b74a83e15671c2c8b78","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Has IPSD and Major Depression Diagnosis"},{"_id":"68923b74a83e15671c2c8b79","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Qualifying Encounters"}]},{"_id":"68923b74a83e15671c2c8b92","statement_name":"Denominator","statement_references":[{"_id":"68923b7ca83e15671c2c8e3b","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Initial Population"}]},{"_id":"68923b74a83e15671c2c8b93","statement_name":"Antidepressant Medication Period Between IPSD and 231 Days After IPSD","statement_references":[{"_id":"68923b74a83e15671c2c8b7a","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"MedicationDispensedPeriod"},{"_id":"68923b74a83e15671c2c8b7b","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"IPSD"}]},{"_id":"68923b74a83e15671c2c8b94","statement_name":"Cumulative Medication Duration Greater Than or Equal to 180 Days","statement_references":[{"_id":"68923b74a83e15671c2c8b7c","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"CumulativeDuration"},{"_id":"68923b74a83e15671c2c8b7d","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Antidepressant Medication Period Between IPSD and 231 Days After IPSD"}]},{"_id":"68923b74a83e15671c2c8b95","statement_name":"Numerator 2","statement_references":[{"_id":"68923b7ca83e15671c2c8e3c","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Cumulative Medication Duration Greater Than or Equal to 180 Days"}]},{"_id":"68923b74a83e15671c2c8b96","statement_name":"Antidepressant Medication Period Between IPSD and 114 Days After IPSD","statement_references":[{"_id":"68923b74a83e15671c2c8b7e","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"MedicationDispensedPeriod"},{"_id":"68923b74a83e15671c2c8b7f","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"IPSD"}]},{"_id":"68923b74a83e15671c2c8b97","statement_name":"Cumulative Medication Duration Greater Than or Equal to 84 Days","statement_references":[{"_id":"68923b74a83e15671c2c8b80","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"CumulativeDuration"},{"_id":"68923b74a83e15671c2c8b81","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Antidepressant Medication Period Between IPSD and 114 Days After IPSD"}]},{"_id":"68923b74a83e15671c2c8b98","statement_name":"Numerator 1","statement_references":[{"_id":"68923b7ca83e15671c2c8e3d","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"Cumulative Medication Duration Greater Than or Equal to 84 Days"}]},{"_id":"68923b74a83e15671c2c8b99","statement_name":"Denominator Exclusions","statement_references":[{"_id":"68923b74a83e15671c2c8b82","hqmf_id":null,"library_name":"HospiceQDM","statement_name":"Has Hospice Services"},{"_id":"68923b74a83e15671c2c8b83","hqmf_id":null,"library_name":"AntidepressantMedicationManagement","statement_name":"IPSD"},{"_id":"68923b74a83e15671c2c8b84","hqmf_id":null,"library_name":"MATGlobalCommonFunctionsQDM","statement_name":"ToDateInterval"}]}]},{"_id":"68923b74a83e15671c2c8ba4","cql":"library CumulativeMedicationDurationQDM version '3.0.000'\n\n/*@description: This library provides cumulative medication duration calculation logic for use with Quality Data Model prescription, discharge, administration, and dispensing events. \nThe logic here follows the guidance provided as part of the 5.6 version of Quality Data Model.\n@comment: Note that the logic here assumes single-instruction dosing information. Split-dosing, tapering, and other more complex dosing instructions are not handled.*/\n\nusing QDM version '5.6'\n\ninclude MATGlobalCommonFunctionsQDM version '8.0.000' called Global\n\ncodesystem \"SNOMEDCT\": 'urn:oid:2.16.840.1.113883.6.96' \n\ncode \"Every eight hours (qualifier value)\": '307469008' from \"SNOMEDCT\" display 'Every eight hours (qualifier value)'\ncode \"Every eight to twelve hours (qualifier value)\": '396140003' from \"SNOMEDCT\" display 'Every eight to twelve hours (qualifier value)'\ncode \"Every forty eight hours (qualifier value)\": '396131002' from \"SNOMEDCT\" display 'Every forty eight hours (qualifier value)'\ncode \"Every forty hours (qualifier value)\": '396130001' from \"SNOMEDCT\" display 'Every forty hours (qualifier value)'\ncode \"Every four hours (qualifier value)\": '225756002' from \"SNOMEDCT\" display 'Every four hours (qualifier value)'\ncode \"Every seventy two hours (qualifier value)\": '396143001' from \"SNOMEDCT\" display 'Every seventy two hours (qualifier value)'\ncode \"Every six hours (qualifier value)\": '307468000' from \"SNOMEDCT\" display 'Every six hours (qualifier value)'\ncode \"Every six to eight hours (qualifier value)\": '396139000' from \"SNOMEDCT\" display 'Every six to eight hours (qualifier value)'\ncode \"Every thirty six hours (qualifier value)\": '396126004' from \"SNOMEDCT\" display 'Every thirty six hours (qualifier value)'\ncode \"Every three to four hours (qualifier value)\": '225754004' from \"SNOMEDCT\" display 'Every three to four hours (qualifier value)'\ncode \"Every three to six hours (qualifier value)\": '396127008' from \"SNOMEDCT\" display 'Every three to six hours (qualifier value)'\ncode \"Every twelve hours (qualifier value)\": '307470009' from \"SNOMEDCT\" display 'Every twelve hours (qualifier value)'\ncode \"Every twenty four hours (qualifier value)\": '396125000' from \"SNOMEDCT\" display 'Every twenty four hours (qualifier value)'\ncode \"Every two to four hours (qualifier value)\": '225752000' from \"SNOMEDCT\" display 'Every two to four hours (qualifier value)'\ncode \"Four times daily (qualifier value)\": '307439001' from \"SNOMEDCT\" display 'Four times daily (qualifier value)'\ncode \"Once daily (qualifier value)\": '229797004' from \"SNOMEDCT\" display 'Once daily (qualifier value)'\ncode \"One to four times a day (qualifier value)\": '396109005' from \"SNOMEDCT\" display 'One to four times a day (qualifier value)'\ncode \"One to three times a day (qualifier value)\": '396108002' from \"SNOMEDCT\" display 'One to three times a day (qualifier value)'\ncode \"One to two times a day (qualifier value)\": '396107007' from \"SNOMEDCT\" display 'One to two times a day (qualifier value)'\ncode \"Three times daily (qualifier value)\": '229798009' from \"SNOMEDCT\" display 'Three times daily (qualifier value)'\ncode \"Twice a day (qualifier value)\": '229799001' from \"SNOMEDCT\" display 'Twice a day (qualifier value)'\ncode \"Two to four times a day (qualifier value)\": '396111001' from \"SNOMEDCT\" display 'Two to four times a day (qualifier value)'\n\ncontext Patient\n\n/*@description: Converts a frequency quantity to a daily frequency (as a decimal)\n@comment: This function considers both the value and unit of the given frequency. E.g. the frequency `30 'min'` will result in a daily frequency of `48.0`*/\ndefine function \"QuantityToDaily\"(Frequency Quantity ):\n  case Frequency.unit\n      when 'h' then (24.0 / Frequency.value)\n      when 'min' then (24.0 / Frequency.value) * 60\n      when 's' then (24.0 / Frequency.value) * 60 * 60\n      when 'd' then (24.0 / Frequency.value) / 24\n      when 'wk' then (24.0 / Frequency.value) / (24 * 7)\n      when 'mo' then (24.0 / Frequency.value) / (24 * 30) /* assuming 30 days in month */\n      when 'a' then (24.0 / Frequency.value) / (24 * 365) /* assuming 365 days in year */\n      when 'hour' then (24.0 / Frequency.value)\n      when 'minute' then (24.0 / Frequency.value) * 60\n      when 'second' then (24.0 / Frequency.value) * 60 * 60\n      when 'day' then (24.0 / Frequency.value) / 24\n      when 'week' then (24.0 / Frequency.value) / (24 * 7)\n      when 'month' then (24.0 / Frequency.value) / (24 * 30) /* assuming 30 days in month */\n      when 'year' then (24.0 / Frequency.value) / (24 * 365) /* assuming 365 days in year */\n      when 'hours' then (24.0 / Frequency.value)\n      when 'minutes' then (24.0 / Frequency.value) * 60\n      when 'seconds' then (24.0 / Frequency.value) * 60 * 60\n      when 'days' then (24.0 / Frequency.value) / 24\n      when 'weeks' then (24.0 / Frequency.value) / (24 * 7)\n      when 'months' then (24.0 / Frequency.value) / (24 * 30) /* assuming 30 days in month */\n      when 'years' then (24.0 / Frequency.value) / (24 * 365) /* assuming 365 days in year */\n      else null\n    end\n\n/*@description: Returns the equivalent daily frequency (as a decimal) of the given code\n@comment: Note that for ranges, the boundary resulting in the highest frequency result is used. E.g. `Every two to four hours` results in `12.0` and `One to two` times a day results in `2.0`.*/\ndefine function \"CodeToDaily\"(Frequency Code ):\n  case\n    when Frequency ~ \"Once daily (qualifier value)\" then 1.0\n    when Frequency ~ \"Twice a day (qualifier value)\" then 2.0\n    when Frequency ~ \"Three times daily (qualifier value)\" then 3.0\n    when Frequency ~ \"Four times daily (qualifier value)\" then 4.0\n    when Frequency ~ \"Every twenty four hours (qualifier value)\" then 1.0\n    when Frequency ~ \"Every twelve hours (qualifier value)\" then 2.0\n    when Frequency ~ \"Every thirty six hours (qualifier value)\" then 0.67\n    when Frequency ~ \"Every eight hours (qualifier value)\" then 3.0\n    when Frequency ~ \"Every four hours (qualifier value)\" then 6.0\n    when Frequency ~ \"Every six hours (qualifier value)\" then 4.0\n    when Frequency ~ \"Every seventy two hours (qualifier value)\" then 0.33\n    when Frequency ~ \"Every forty eight hours (qualifier value)\" then 0.5\n    when Frequency ~ \"Every eight to twelve hours (qualifier value)\" then 3.0\n    when Frequency ~ \"Every six to eight hours (qualifier value)\" then 4.0\n    when Frequency ~ \"Every three to four hours (qualifier value)\" then 8.0\n    when Frequency ~ \"Every three to six hours (qualifier value)\" then 8.0\n    when Frequency ~ \"Every two to four hours (qualifier value)\" then 12.0\n    when Frequency ~ \"One to four times a day (qualifier value)\" then 4.0\n    when Frequency ~ \"One to three times a day (qualifier value)\" then 3.0\n    when Frequency ~ \"One to two times a day (qualifier value)\" then 2.0\n    when Frequency ~ \"Two to four times a day (qualifier value)\" then 4.0\n    else null\n  end\n\n/*@description: Returns the daily frequency (as a decimal) of the given input*/\ndefine function \"ToDaily\"(Frequency Choice\u003cQuantity, Code\u003e ):\n  case\n    when Frequency is Quantity then QuantityToDaily(Frequency as Quantity)\n    else CodeToDaily(Frequency as Code)\n  end\n\n/*@description: Returns the established therapeutic duration for a given medication\n  @comment: This is likely measure specific, though could potentially be established for any drug and distributed as a CodeSystem supplement. Defaulting to 14 days here for illustration.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used.*/\ndefine function \"TherapeuticDuration\"(medication Code ):\n  14 days\n\n/*@description: Calculates Medication Period for a given Medication, Administration\n  @comment: This function calculates the effective duration of a single medication administration event using the following approach: If a TherapeuticDuration is defined for the medication, the result is the interval from the earliest of the `relevantDatetime` and `relevantPeriod` elements, to the end of the therapeutic duration.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used.*/\ndefine function \"MedicationAdministrationPeriod\"(MedAdministration \"Medication, Administered\" ):\n  MedAdministration Administration\n       let\n         therapeuticDuration: TherapeuticDuration(Administration.code),\n         startDate: date from Global.EarliestOf(Administration.relevantDatetime, Administration.relevantPeriod)\n       return\n         if startDate is not null and therapeuticDuration is not null then\n           Interval[startDate, startDate + therapeuticDuration - 1]\n         else\n           null\n\n/*@description: Calculates the Medication Period for a Medication, Discharge\n@comment: This function calculates the effective duration of a single medication discharge event using the following approach: If the `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. Otherwise, the duration is calculated using `(supply / (dosage * frequency)) * (1 + refills)`. The result is then the interval from `authorDatetime` to `authorDatetime + daysSupplied`.\nNote that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n@seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\nNote that this function has not been tested.*/\ndefine function \"MedicationDischargePeriod\"(Medication \"Medication, Discharge\" ):\n  (\n    Coalesce(\n      Medication.daysSupplied,\n      Medication.supply.value / (Medication.dosage.value * ToDaily(Medication.frequency))\n    ) * (1 + Coalesce(Medication.refills, 0))\n  ) totalDaysSupplied\n    let startDate: date from Medication.authorDatetime\n    return\n      if startDate is not null and totalDaysSupplied is not null then\n        Interval[startDate, startDate + Quantity { value: totalDaysSupplied - 1, unit: 'day' }]\n      else\n        null\n\n/*@description: Returns the total duration in days covered by the given periods\n  @comment: This function calculates the total duration in days covered by the given periods. If multiple periods in the input include the same day, that day is only counted once in the final result.*/\ndefine function \"CumulativeDuration\"(Intervals List\u003cInterval\u003cDate\u003e\u003e ):\n  if Intervals is not null then ( Sum((collapse Intervals per day)X\n        return all(difference in days between start of X and \n          end of X\n        )+ 1\n    )\n  ) \n    else null\n\n/*@description: Rolls out periods so that overlapping periods delay the start of subsequent periods\n  @comment: Returns the periods with overlapping periods delayed so that there is no overlap between any two periods in the result.*/\ndefine function \"RolloutIntervals\"(intervals List\u003cInterval\u003cDate\u003e\u003e ):\n  intervals I aggregate all R starting ( null as List\u003cInterval\u003cDate\u003e\u003e): R\n    union ( { I X\n        let S: Max({ \n          end of Last(R)+ 1 day, start of X }\n        ),\n        E: S + Quantity { value: Coalesce(duration in days of X, 0), unit: 'day' }\n        return Interval[S, E]}\n    )\n\n/*@description: Calculates the effective duration of the given medication event, whether it is an order, dispense, discharge, or administration. Note that this function is still under development and should not be used.*/\ndefine function \"MedicationPeriod\"(Medication Choice\u003c\"Medication, Order\",\n       \"Medication, Dispensed\",\n       \"Medication, Discharge\",\n       \"Medication, Administered\"\n     \u003e ):\n  Coalesce(\n       MedicationOrderPeriod(Medication),\n       MedicationDispensedPeriod(Medication),\n       MedicationDischargePeriod(Medication),\n       MedicationAdministrationPeriod(Medication)\n     )\n\n/*@description: Calculates the cumulative medication duration of the given medication events\n  @comment: This function will _roll out_ periods from dispense and administration events, and then collapse across that result and periods from prescriptions. The separation of medications by type should already be done prior to using this function. In addition, calculations that combine dosages from different types of medications (such as Morphine Milligram Equivalent (MME)) require further consideration. Note that this function is still under development and should not be used.*/\ndefine function \"CalculateCumulativeMedicationDuration\"(Medications List\u003cChoice\u003c\"Medication, Order\",\n       \"Medication, Dispensed\",\n       \"Medication, Discharge\",\n       \"Medication, Administered\"\n     \u003e\u003e ):\n  CumulativeDuration((\n         Medications M\n           where M is \"Medication, Order\" or M is \"Medication, Discharge\"\n           return MedicationPeriod(M)\n       )\n         union (\n           RolloutIntervals(\n             Medications M\n               where M is \"Medication, Dispensed\" or M is \"Medication, Administered\"\n               return MedicationPeriod(M)\n           )\n         )\n     )\n\n/*@description: Calculates Medication Period for a given Medication, Dispensed\n  @comment: This function calculates the effective duration of a single medication dispensing event using the following approach:  If `daysSupplied` element is present, the duration is `daysSupplied`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency))`. The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `relevantDatetime` to `relevantDatetime + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary.*/\ndefine function \"MedicationDispensedPeriod\"(MedDispense \"Medication, Dispensed\" ):\n  MedDispense Dispense\n    let startDate: date from Coalesce(Dispense.relevantPeriod.low, Dispense.relevantDatetime, Dispense.authorDatetime),\n    totalDaysSupplied: Coalesce(Dispense.daysSupplied, Dispense.supply.value /(Dispense.dosage.value * ToDaily(Dispense.frequency)))\n    return if startDate is null then null \n      else if totalDaysSupplied is not null then Interval[startDate, startDate + Quantity { value: totalDaysSupplied - 1, unit: 'day' }]\n      else if Dispense.relevantPeriod.high is not null then Interval[startDate, date from end of Dispense.relevantPeriod]\n      else null\n\n/*@description: Calculates the Medication Period for a single Medication, Order\n  @comment: This function calculates the expected period of a medication order using the following approach: If `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency)) * (1 + refills)`.  The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary.*/\ndefine function \"MedicationOrderPeriod\"(MedOrder \"Medication, Order\" ):\n  MedOrder Order\n    let startDate: date from Coalesce(Order.relevantPeriod.low, Order.authorDatetime),\n    totalDaysSupplied: Coalesce(Order.daysSupplied, Order.supply.value /(Order.dosage.value * ToDaily(Order.frequency))) * ( 1 + Coalesce(Order.refills, 0) )\n    return if startDate is null then null \n      else if totalDaysSupplied is not null then Interval[startDate, startDate + Quantity { value: totalDaysSupplied - 1, unit: 'day' }]\n      else if Order.relevantPeriod.high is not null then Interval[startDate, date from end of Order.relevantPeriod]\n      else null\n\n","elm":{"library":{"annotation":[{"translatorOptions":"EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion,DisableMethodInvocation","type":"CqlToElmInfo"},{"type":"Annotation","s":{"r":"687","s":[{"value":["","library CumulativeMedicationDurationQDM version '3.0.000'"]}]}}],"identifier":{"id":"CumulativeMedicationDurationQDM","version":"3.0.000"},"schemaIdentifier":{"id":"urn:hl7-org:elm","version":"r1"},"usings":{"def":[{"localIdentifier":"System","uri":"urn:hl7-org:elm-types:r1"},{"localId":"1","locator":"7:1-7:23","localIdentifier":"QDM","uri":"urn:healthit-gov:qdm:v5_6","version":"5.6","annotation":[{"type":"Annotation","t":[{"name":"description","value":"This library provides cumulative medication duration calculation logic for use with Quality Data Model prescription, discharge, administration, and dispensing events."},{"name":"description","value":"This library provides cumulative medication duration calculation logic for use with Quality Data Model prescription, discharge, administration, and dispensing events. \nThe logic here follows the guidance provided as part of the 5.6 version of Quality Data Model."},{"name":"comment","value":"Note that the logic here assumes single-instruction dosing information. Split-dosing, tapering, and other more complex dosing instructions are not handled."}],"s":{"r":"1","s":[{"value":["/*@description: This library provides cumulative medication duration calculation logic for use with Quality Data Model prescription, discharge, administration, and dispensing events. \nThe logic here follows the guidance provided as part of the 5.6 version of Quality Data Model.\n@comment: Note that the logic here assumes single-instruction dosing information. Split-dosing, tapering, and other more complex dosing instructions are not handled.*/\n","using "]},{"s":[{"value":["QDM"]}]},{"value":[" version ","'5.6'"]}]}}]}]},"includes":{"def":[{"localId":"2","locator":"9:1-9:67","localIdentifier":"Global","path":"MATGlobalCommonFunctionsQDM","version":"8.0.000","annotation":[{"type":"Annotation","s":{"r":"2","s":[{"value":["","include "]},{"s":[{"value":["MATGlobalCommonFunctionsQDM"]}]},{"value":[" version ","'8.0.000'"," called ","Global"]}]}}]}]},"codeSystems":{"def":[{"localId":"3","locator":"11:1-11:55","name":"SNOMEDCT","id":"2.16.840.1.113883.6.96","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"3","s":[{"value":["","codesystem ","\"SNOMEDCT\"",": ","'urn:oid:2.16.840.1.113883.6.96'"]}]}}]}]},"codes":{"def":[{"localId":"5","locator":"13:1-13:117","name":"Every eight hours (qualifier value)","id":"307469008","display":"Every eight hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"5","s":[{"value":["","code ","\"Every eight hours (qualifier value)\"",": ","'307469008'"," from "]},{"r":"4","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every eight hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"4","locator":"13:62-13:71","name":"SNOMEDCT"}},{"localId":"7","locator":"14:1-14:137","name":"Every eight to twelve hours (qualifier value)","id":"396140003","display":"Every eight to twelve hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"7","s":[{"value":["","code ","\"Every eight to twelve hours (qualifier value)\"",": ","'396140003'"," from "]},{"r":"6","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every eight to twelve hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"6","locator":"14:72-14:81","name":"SNOMEDCT"}},{"localId":"9","locator":"15:1-15:129","name":"Every forty eight hours (qualifier value)","id":"396131002","display":"Every forty eight hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"9","s":[{"value":["","code ","\"Every forty eight hours (qualifier value)\"",": ","'396131002'"," from "]},{"r":"8","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every forty eight hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"8","locator":"15:68-15:77","name":"SNOMEDCT"}},{"localId":"11","locator":"16:1-16:117","name":"Every forty hours (qualifier value)","id":"396130001","display":"Every forty hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"11","s":[{"value":["","code ","\"Every forty hours (qualifier value)\"",": ","'396130001'"," from "]},{"r":"10","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every forty hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"10","locator":"16:62-16:71","name":"SNOMEDCT"}},{"localId":"13","locator":"17:1-17:115","name":"Every four hours (qualifier value)","id":"225756002","display":"Every four hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"13","s":[{"value":["","code ","\"Every four hours (qualifier value)\"",": ","'225756002'"," from "]},{"r":"12","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every four hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"12","locator":"17:61-17:70","name":"SNOMEDCT"}},{"localId":"15","locator":"18:1-18:129","name":"Every seventy two hours (qualifier value)","id":"396143001","display":"Every seventy two hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"15","s":[{"value":["","code ","\"Every seventy two hours (qualifier value)\"",": ","'396143001'"," from "]},{"r":"14","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every seventy two hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"14","locator":"18:68-18:77","name":"SNOMEDCT"}},{"localId":"17","locator":"19:1-19:113","name":"Every six hours (qualifier value)","id":"307468000","display":"Every six hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"17","s":[{"value":["","code ","\"Every six hours (qualifier value)\"",": ","'307468000'"," from "]},{"r":"16","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every six hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"16","locator":"19:60-19:69","name":"SNOMEDCT"}},{"localId":"19","locator":"20:1-20:131","name":"Every six to eight hours (qualifier value)","id":"396139000","display":"Every six to eight hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"19","s":[{"value":["","code ","\"Every six to eight hours (qualifier value)\"",": ","'396139000'"," from "]},{"r":"18","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every six to eight hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"18","locator":"20:69-20:78","name":"SNOMEDCT"}},{"localId":"21","locator":"21:1-21:127","name":"Every thirty six hours (qualifier value)","id":"396126004","display":"Every thirty six hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"21","s":[{"value":["","code ","\"Every thirty six hours (qualifier value)\"",": ","'396126004'"," from "]},{"r":"20","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every thirty six hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"20","locator":"21:67-21:76","name":"SNOMEDCT"}},{"localId":"23","locator":"22:1-22:133","name":"Every three to four hours (qualifier value)","id":"225754004","display":"Every three to four hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"23","s":[{"value":["","code ","\"Every three to four hours (qualifier value)\"",": ","'225754004'"," from "]},{"r":"22","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every three to four hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"22","locator":"22:70-22:79","name":"SNOMEDCT"}},{"localId":"25","locator":"23:1-23:131","name":"Every three to six hours (qualifier value)","id":"396127008","display":"Every three to six hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"25","s":[{"value":["","code ","\"Every three to six hours (qualifier value)\"",": ","'396127008'"," from "]},{"r":"24","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every three to six hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"24","locator":"23:69-23:78","name":"SNOMEDCT"}},{"localId":"27","locator":"24:1-24:119","name":"Every twelve hours (qualifier value)","id":"307470009","display":"Every twelve hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"27","s":[{"value":["","code ","\"Every twelve hours (qualifier value)\"",": ","'307470009'"," from "]},{"r":"26","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every twelve hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"26","locator":"24:63-24:72","name":"SNOMEDCT"}},{"localId":"29","locator":"25:1-25:129","name":"Every twenty four hours (qualifier value)","id":"396125000","display":"Every twenty four hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"29","s":[{"value":["","code ","\"Every twenty four hours (qualifier value)\"",": ","'396125000'"," from "]},{"r":"28","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every twenty four hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"28","locator":"25:68-25:77","name":"SNOMEDCT"}},{"localId":"31","locator":"26:1-26:129","name":"Every two to four hours (qualifier value)","id":"225752000","display":"Every two to four hours (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"31","s":[{"value":["","code ","\"Every two to four hours (qualifier value)\"",": ","'225752000'"," from "]},{"r":"30","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Every two to four hours (qualifier value)'"]}]}}],"codeSystem":{"localId":"30","locator":"26:68-26:77","name":"SNOMEDCT"}},{"localId":"33","locator":"27:1-27:115","name":"Four times daily (qualifier value)","id":"307439001","display":"Four times daily (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"33","s":[{"value":["","code ","\"Four times daily (qualifier value)\"",": ","'307439001'"," from "]},{"r":"32","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Four times daily (qualifier value)'"]}]}}],"codeSystem":{"localId":"32","locator":"27:61-27:70","name":"SNOMEDCT"}},{"localId":"35","locator":"28:1-28:103","name":"Once daily (qualifier value)","id":"229797004","display":"Once daily (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"35","s":[{"value":["","code ","\"Once daily (qualifier value)\"",": ","'229797004'"," from "]},{"r":"34","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Once daily (qualifier value)'"]}]}}],"codeSystem":{"localId":"34","locator":"28:55-28:64","name":"SNOMEDCT"}},{"localId":"37","locator":"29:1-29:129","name":"One to four times a day (qualifier value)","id":"396109005","display":"One to four times a day (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"37","s":[{"value":["","code ","\"One to four times a day (qualifier value)\"",": ","'396109005'"," from "]},{"r":"36","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'One to four times a day (qualifier value)'"]}]}}],"codeSystem":{"localId":"36","locator":"29:68-29:77","name":"SNOMEDCT"}},{"localId":"39","locator":"30:1-30:131","name":"One to three times a day (qualifier value)","id":"396108002","display":"One to three times a day (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"39","s":[{"value":["","code ","\"One to three times a day (qualifier value)\"",": ","'396108002'"," from "]},{"r":"38","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'One to three times a day (qualifier value)'"]}]}}],"codeSystem":{"localId":"38","locator":"30:69-30:78","name":"SNOMEDCT"}},{"localId":"41","locator":"31:1-31:127","name":"One to two times a day (qualifier value)","id":"396107007","display":"One to two times a day (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"41","s":[{"value":["","code ","\"One to two times a day (qualifier value)\"",": ","'396107007'"," from "]},{"r":"40","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'One to two times a day (qualifier value)'"]}]}}],"codeSystem":{"localId":"40","locator":"31:67-31:76","name":"SNOMEDCT"}},{"localId":"43","locator":"32:1-32:117","name":"Three times daily (qualifier value)","id":"229798009","display":"Three times daily (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"43","s":[{"value":["","code ","\"Three times daily (qualifier value)\"",": ","'229798009'"," from "]},{"r":"42","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Three times daily (qualifier value)'"]}]}}],"codeSystem":{"localId":"42","locator":"32:62-32:71","name":"SNOMEDCT"}},{"localId":"45","locator":"33:1-33:105","name":"Twice a day (qualifier value)","id":"229799001","display":"Twice a day (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"45","s":[{"value":["","code ","\"Twice a day (qualifier value)\"",": ","'229799001'"," from "]},{"r":"44","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Twice a day (qualifier value)'"]}]}}],"codeSystem":{"localId":"44","locator":"33:56-33:65","name":"SNOMEDCT"}},{"localId":"47","locator":"34:1-34:129","name":"Two to four times a day (qualifier value)","id":"396111001","display":"Two to four times a day (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"47","s":[{"value":["","code ","\"Two to four times a day (qualifier value)\"",": ","'396111001'"," from "]},{"r":"46","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Two to four times a day (qualifier value)'"]}]}}],"codeSystem":{"localId":"46","locator":"34:68-34:77","name":"SNOMEDCT"}}]},"contexts":{"def":[{"locator":"36:1-36:15","name":"Patient"}]},"statements":{"def":[{"locator":"36:1-36:15","name":"Patient","context":"Patient","expression":{"type":"SingletonFrom","operand":{"locator":"36:1-36:15","dataType":"{urn:healthit-gov:qdm:v5_6}Patient","templateId":"Patient","type":"Retrieve"}}},{"localId":"239","locator":"40:1-64:7","name":"QuantityToDaily","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Converts a frequency quantity to a daily frequency (as a decimal)"},{"name":"description","value":"Converts a frequency quantity to a daily frequency (as a decimal)"},{"name":"comment","value":"This function considers both the value and unit of the given frequency. E.g. the frequency `30 'min'` will result in a daily frequency of `48.0`"}],"s":{"r":"239","s":[{"value":["/*@description: Converts a frequency quantity to a daily frequency (as a decimal)\n@comment: This function considers both the value and unit of the given frequency. E.g. the frequency `30 'min'` will result in a daily frequency of `48.0`*/\n","define function ","\"QuantityToDaily\"","(","Frequency"," "]},{"r":"48","s":[{"value":["Quantity"]}]},{"value":[" ):\n  "]},{"r":"238","s":[{"r":"238","s":[{"value":["case "]},{"r":"50","s":[{"r":"49","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"50","s":[{"value":["unit"]}]}]},{"value":["\n      "]},{"r":"56","s":[{"value":["when "]},{"r":"51","s":[{"value":["'h'"]}]},{"value":[" then "]},{"r":"55","s":[{"value":["("]},{"r":"55","s":[{"r":"52","value":["24.0"," / "]},{"r":"54","s":[{"r":"53","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"54","s":[{"value":["value"]}]}]}]},{"value":[")"]}]}]},{"value":["\n      "]},{"r":"64","s":[{"value":["when "]},{"r":"57","s":[{"value":["'min'"]}]},{"value":[" then "]},{"r":"63","s":[{"r":"61","s":[{"value":["("]},{"r":"61","s":[{"r":"58","value":["24.0"," / "]},{"r":"60","s":[{"r":"59","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"60","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"62","value":[" * ","60"]}]}]},{"value":["\n      "]},{"r":"74","s":[{"value":["when "]},{"r":"65","s":[{"value":["'s'"]}]},{"value":[" then "]},{"r":"73","s":[{"r":"71","s":[{"r":"69","s":[{"value":["("]},{"r":"69","s":[{"r":"66","value":["24.0"," / "]},{"r":"68","s":[{"r":"67","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"68","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"70","value":[" * ","60"]}]},{"r":"72","value":[" * ","60"]}]}]},{"value":["\n      "]},{"r":"82","s":[{"value":["when "]},{"r":"75","s":[{"value":["'d'"]}]},{"value":[" then "]},{"r":"81","s":[{"r":"79","s":[{"value":["("]},{"r":"79","s":[{"r":"76","value":["24.0"," / "]},{"r":"78","s":[{"r":"77","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"78","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"80","value":[" / ","24"]}]}]},{"value":["\n      "]},{"r":"92","s":[{"value":["when "]},{"r":"83","s":[{"value":["'wk'"]}]},{"value":[" then "]},{"r":"91","s":[{"r":"87","s":[{"value":["("]},{"r":"87","s":[{"r":"84","value":["24.0"," / "]},{"r":"86","s":[{"r":"85","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"86","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"90","s":[{"value":["("]},{"r":"90","s":[{"r":"88","value":["24"," * ","7"]}]},{"value":[")"]}]}]}]},{"value":["\n      "]},{"r":"102","s":[{"value":["when "]},{"r":"93","s":[{"value":["'mo'"]}]},{"value":[" then "]},{"r":"101","s":[{"r":"97","s":[{"value":["("]},{"r":"97","s":[{"r":"94","value":["24.0"," / "]},{"r":"96","s":[{"r":"95","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"96","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"100","s":[{"value":["("]},{"r":"100","s":[{"r":"98","value":["24"," * ","30"]}]},{"value":[")"]}]}]}]},{"value":[" /* assuming 30 days in month */\n      "]},{"r":"112","s":[{"value":["when "]},{"r":"103","s":[{"value":["'a'"]}]},{"value":[" then "]},{"r":"111","s":[{"r":"107","s":[{"value":["("]},{"r":"107","s":[{"r":"104","value":["24.0"," / "]},{"r":"106","s":[{"r":"105","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"106","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"110","s":[{"value":["("]},{"r":"110","s":[{"r":"108","value":["24"," * ","365"]}]},{"value":[")"]}]}]}]},{"value":[" /* assuming 365 days in year */\n      "]},{"r":"118","s":[{"value":["when "]},{"r":"113","s":[{"value":["'hour'"]}]},{"value":[" then "]},{"r":"117","s":[{"value":["("]},{"r":"117","s":[{"r":"114","value":["24.0"," / "]},{"r":"116","s":[{"r":"115","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"116","s":[{"value":["value"]}]}]}]},{"value":[")"]}]}]},{"value":["\n      "]},{"r":"126","s":[{"value":["when "]},{"r":"119","s":[{"value":["'minute'"]}]},{"value":[" then "]},{"r":"125","s":[{"r":"123","s":[{"value":["("]},{"r":"123","s":[{"r":"120","value":["24.0"," / "]},{"r":"122","s":[{"r":"121","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"122","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"124","value":[" * ","60"]}]}]},{"value":["\n      "]},{"r":"136","s":[{"value":["when "]},{"r":"127","s":[{"value":["'second'"]}]},{"value":[" then "]},{"r":"135","s":[{"r":"133","s":[{"r":"131","s":[{"value":["("]},{"r":"131","s":[{"r":"128","value":["24.0"," / "]},{"r":"130","s":[{"r":"129","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"130","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"132","value":[" * ","60"]}]},{"r":"134","value":[" * ","60"]}]}]},{"value":["\n      "]},{"r":"144","s":[{"value":["when "]},{"r":"137","s":[{"value":["'day'"]}]},{"value":[" then "]},{"r":"143","s":[{"r":"141","s":[{"value":["("]},{"r":"141","s":[{"r":"138","value":["24.0"," / "]},{"r":"140","s":[{"r":"139","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"140","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"142","value":[" / ","24"]}]}]},{"value":["\n      "]},{"r":"154","s":[{"value":["when "]},{"r":"145","s":[{"value":["'week'"]}]},{"value":[" then "]},{"r":"153","s":[{"r":"149","s":[{"value":["("]},{"r":"149","s":[{"r":"146","value":["24.0"," / "]},{"r":"148","s":[{"r":"147","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"148","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"152","s":[{"value":["("]},{"r":"152","s":[{"r":"150","value":["24"," * ","7"]}]},{"value":[")"]}]}]}]},{"value":["\n      "]},{"r":"164","s":[{"value":["when "]},{"r":"155","s":[{"value":["'month'"]}]},{"value":[" then "]},{"r":"163","s":[{"r":"159","s":[{"value":["("]},{"r":"159","s":[{"r":"156","value":["24.0"," / "]},{"r":"158","s":[{"r":"157","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"158","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"162","s":[{"value":["("]},{"r":"162","s":[{"r":"160","value":["24"," * ","30"]}]},{"value":[")"]}]}]}]},{"value":[" /* assuming 30 days in month */\n      "]},{"r":"174","s":[{"value":["when "]},{"r":"165","s":[{"value":["'year'"]}]},{"value":[" then "]},{"r":"173","s":[{"r":"169","s":[{"value":["("]},{"r":"169","s":[{"r":"166","value":["24.0"," / "]},{"r":"168","s":[{"r":"167","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"168","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"172","s":[{"value":["("]},{"r":"172","s":[{"r":"170","value":["24"," * ","365"]}]},{"value":[")"]}]}]}]},{"value":[" /* assuming 365 days in year */\n      "]},{"r":"180","s":[{"value":["when "]},{"r":"175","s":[{"value":["'hours'"]}]},{"value":[" then "]},{"r":"179","s":[{"value":["("]},{"r":"179","s":[{"r":"176","value":["24.0"," / "]},{"r":"178","s":[{"r":"177","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"178","s":[{"value":["value"]}]}]}]},{"value":[")"]}]}]},{"value":["\n      "]},{"r":"188","s":[{"value":["when "]},{"r":"181","s":[{"value":["'minutes'"]}]},{"value":[" then "]},{"r":"187","s":[{"r":"185","s":[{"value":["("]},{"r":"185","s":[{"r":"182","value":["24.0"," / "]},{"r":"184","s":[{"r":"183","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"184","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"186","value":[" * ","60"]}]}]},{"value":["\n      "]},{"r":"198","s":[{"value":["when "]},{"r":"189","s":[{"value":["'seconds'"]}]},{"value":[" then "]},{"r":"197","s":[{"r":"195","s":[{"r":"193","s":[{"value":["("]},{"r":"193","s":[{"r":"190","value":["24.0"," / "]},{"r":"192","s":[{"r":"191","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"192","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"194","value":[" * ","60"]}]},{"r":"196","value":[" * ","60"]}]}]},{"value":["\n      "]},{"r":"206","s":[{"value":["when "]},{"r":"199","s":[{"value":["'days'"]}]},{"value":[" then "]},{"r":"205","s":[{"r":"203","s":[{"value":["("]},{"r":"203","s":[{"r":"200","value":["24.0"," / "]},{"r":"202","s":[{"r":"201","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"202","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"r":"204","value":[" / ","24"]}]}]},{"value":["\n      "]},{"r":"216","s":[{"value":["when "]},{"r":"207","s":[{"value":["'weeks'"]}]},{"value":[" then "]},{"r":"215","s":[{"r":"211","s":[{"value":["("]},{"r":"211","s":[{"r":"208","value":["24.0"," / "]},{"r":"210","s":[{"r":"209","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"210","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"214","s":[{"value":["("]},{"r":"214","s":[{"r":"212","value":["24"," * ","7"]}]},{"value":[")"]}]}]}]},{"value":["\n      "]},{"r":"226","s":[{"value":["when "]},{"r":"217","s":[{"value":["'months'"]}]},{"value":[" then "]},{"r":"225","s":[{"r":"221","s":[{"value":["("]},{"r":"221","s":[{"r":"218","value":["24.0"," / "]},{"r":"220","s":[{"r":"219","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"220","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"224","s":[{"value":["("]},{"r":"224","s":[{"r":"222","value":["24"," * ","30"]}]},{"value":[")"]}]}]}]},{"value":[" /* assuming 30 days in month */\n      "]},{"r":"236","s":[{"value":["when "]},{"r":"227","s":[{"value":["'years'"]}]},{"value":[" then "]},{"r":"235","s":[{"r":"231","s":[{"value":["("]},{"r":"231","s":[{"r":"228","value":["24.0"," / "]},{"r":"230","s":[{"r":"229","s":[{"value":["Frequency"]}]},{"value":["."]},{"r":"230","s":[{"value":["value"]}]}]}]},{"value":[")"]}]},{"value":[" / "]},{"r":"234","s":[{"value":["("]},{"r":"234","s":[{"r":"232","value":["24"," * ","365"]}]},{"value":[")"]}]}]}]},{"r":"237","value":[" /* assuming 365 days in year */\n      else ","null","\n    end"]}]}]}]}}],"expression":{"localId":"238","locator":"41:3-64:7","type":"Case","comparand":{"localId":"50","locator":"41:8-41:21","path":"unit","type":"Property","source":{"localId":"49","locator":"41:8-41:16","name":"Frequency","type":"OperandRef"}},"caseItem":[{"localId":"56","locator":"42:7-42:44","when":{"localId":"51","locator":"42:12-42:14","valueType":"{urn:hl7-org:elm-types:r1}String","value":"h","type":"Literal"},"then":{"localId":"55","locator":"42:21-42:44","type":"Divide","operand":[{"localId":"52","locator":"42:22-42:25","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"54","locator":"42:29-42:43","path":"value","type":"Property","source":{"localId":"53","locator":"42:29-42:37","name":"Frequency","type":"OperandRef"}}]}},{"localId":"64","locator":"43:7-43:51","when":{"localId":"57","locator":"43:12-43:16","valueType":"{urn:hl7-org:elm-types:r1}String","value":"min","type":"Literal"},"then":{"localId":"63","locator":"43:23-43:51","type":"Multiply","operand":[{"localId":"61","locator":"43:23-43:46","type":"Divide","operand":[{"localId":"58","locator":"43:24-43:27","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"60","locator":"43:31-43:45","path":"value","type":"Property","source":{"localId":"59","locator":"43:31-43:39","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"62","locator":"43:50-43:51","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]}},{"localId":"74","locator":"44:7-44:54","when":{"localId":"65","locator":"44:12-44:14","valueType":"{urn:hl7-org:elm-types:r1}String","value":"s","type":"Literal"},"then":{"localId":"73","locator":"44:21-44:54","type":"Multiply","operand":[{"localId":"71","locator":"44:21-44:49","type":"Multiply","operand":[{"localId":"69","locator":"44:21-44:44","type":"Divide","operand":[{"localId":"66","locator":"44:22-44:25","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"68","locator":"44:29-44:43","path":"value","type":"Property","source":{"localId":"67","locator":"44:29-44:37","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"70","locator":"44:48-44:49","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]},{"type":"ToDecimal","operand":{"localId":"72","locator":"44:53-44:54","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]}},{"localId":"82","locator":"45:7-45:49","when":{"localId":"75","locator":"45:12-45:14","valueType":"{urn:hl7-org:elm-types:r1}String","value":"d","type":"Literal"},"then":{"localId":"81","locator":"45:21-45:49","type":"Divide","operand":[{"localId":"79","locator":"45:21-45:44","type":"Divide","operand":[{"localId":"76","locator":"45:22-45:25","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"78","locator":"45:29-45:43","path":"value","type":"Property","source":{"localId":"77","locator":"45:29-45:37","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"80","locator":"45:48-45:49","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"}}]}},{"localId":"92","locator":"46:7-46:56","when":{"localId":"83","locator":"46:12-46:15","valueType":"{urn:hl7-org:elm-types:r1}String","value":"wk","type":"Literal"},"then":{"localId":"91","locator":"46:22-46:56","type":"Divide","operand":[{"localId":"87","locator":"46:22-46:45","type":"Divide","operand":[{"localId":"84","locator":"46:23-46:26","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"86","locator":"46:30-46:44","path":"value","type":"Property","source":{"localId":"85","locator":"46:30-46:38","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"90","locator":"46:49-46:56","type":"Multiply","operand":[{"localId":"88","locator":"46:50-46:51","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"89","locator":"46:55","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"7","type":"Literal"}]}}]}},{"localId":"102","locator":"47:7-47:57","when":{"localId":"93","locator":"47:12-47:15","valueType":"{urn:hl7-org:elm-types:r1}String","value":"mo","type":"Literal"},"then":{"localId":"101","locator":"47:22-47:57","type":"Divide","operand":[{"localId":"97","locator":"47:22-47:45","type":"Divide","operand":[{"localId":"94","locator":"47:23-47:26","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"96","locator":"47:30-47:44","path":"value","type":"Property","source":{"localId":"95","locator":"47:30-47:38","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"100","locator":"47:49-47:57","type":"Multiply","operand":[{"localId":"98","locator":"47:50-47:51","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"99","locator":"47:55-47:56","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"30","type":"Literal"}]}}]}},{"localId":"112","locator":"48:7-48:57","when":{"localId":"103","locator":"48:12-48:14","valueType":"{urn:hl7-org:elm-types:r1}String","value":"a","type":"Literal"},"then":{"localId":"111","locator":"48:21-48:57","type":"Divide","operand":[{"localId":"107","locator":"48:21-48:44","type":"Divide","operand":[{"localId":"104","locator":"48:22-48:25","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"106","locator":"48:29-48:43","path":"value","type":"Property","source":{"localId":"105","locator":"48:29-48:37","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"110","locator":"48:48-48:57","type":"Multiply","operand":[{"localId":"108","locator":"48:49-48:50","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"109","locator":"48:54-48:56","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"365","type":"Literal"}]}}]}},{"localId":"118","locator":"49:7-49:47","when":{"localId":"113","locator":"49:12-49:17","valueType":"{urn:hl7-org:elm-types:r1}String","value":"hour","type":"Literal"},"then":{"localId":"117","locator":"49:24-49:47","type":"Divide","operand":[{"localId":"114","locator":"49:25-49:28","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"116","locator":"49:32-49:46","path":"value","type":"Property","source":{"localId":"115","locator":"49:32-49:40","name":"Frequency","type":"OperandRef"}}]}},{"localId":"126","locator":"50:7-50:54","when":{"localId":"119","locator":"50:12-50:19","valueType":"{urn:hl7-org:elm-types:r1}String","value":"minute","type":"Literal"},"then":{"localId":"125","locator":"50:26-50:54","type":"Multiply","operand":[{"localId":"123","locator":"50:26-50:49","type":"Divide","operand":[{"localId":"120","locator":"50:27-50:30","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"122","locator":"50:34-50:48","path":"value","type":"Property","source":{"localId":"121","locator":"50:34-50:42","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"124","locator":"50:53-50:54","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]}},{"localId":"136","locator":"51:7-51:59","when":{"localId":"127","locator":"51:12-51:19","valueType":"{urn:hl7-org:elm-types:r1}String","value":"second","type":"Literal"},"then":{"localId":"135","locator":"51:26-51:59","type":"Multiply","operand":[{"localId":"133","locator":"51:26-51:54","type":"Multiply","operand":[{"localId":"131","locator":"51:26-51:49","type":"Divide","operand":[{"localId":"128","locator":"51:27-51:30","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"130","locator":"51:34-51:48","path":"value","type":"Property","source":{"localId":"129","locator":"51:34-51:42","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"132","locator":"51:53-51:54","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]},{"type":"ToDecimal","operand":{"localId":"134","locator":"51:58-51:59","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]}},{"localId":"144","locator":"52:7-52:51","when":{"localId":"137","locator":"52:12-52:16","valueType":"{urn:hl7-org:elm-types:r1}String","value":"day","type":"Literal"},"then":{"localId":"143","locator":"52:23-52:51","type":"Divide","operand":[{"localId":"141","locator":"52:23-52:46","type":"Divide","operand":[{"localId":"138","locator":"52:24-52:27","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"140","locator":"52:31-52:45","path":"value","type":"Property","source":{"localId":"139","locator":"52:31-52:39","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"142","locator":"52:50-52:51","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"}}]}},{"localId":"154","locator":"53:7-53:58","when":{"localId":"145","locator":"53:12-53:17","valueType":"{urn:hl7-org:elm-types:r1}String","value":"week","type":"Literal"},"then":{"localId":"153","locator":"53:24-53:58","type":"Divide","operand":[{"localId":"149","locator":"53:24-53:47","type":"Divide","operand":[{"localId":"146","locator":"53:25-53:28","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"148","locator":"53:32-53:46","path":"value","type":"Property","source":{"localId":"147","locator":"53:32-53:40","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"152","locator":"53:51-53:58","type":"Multiply","operand":[{"localId":"150","locator":"53:52-53:53","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"151","locator":"53:57","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"7","type":"Literal"}]}}]}},{"localId":"164","locator":"54:7-54:60","when":{"localId":"155","locator":"54:12-54:18","valueType":"{urn:hl7-org:elm-types:r1}String","value":"month","type":"Literal"},"then":{"localId":"163","locator":"54:25-54:60","type":"Divide","operand":[{"localId":"159","locator":"54:25-54:48","type":"Divide","operand":[{"localId":"156","locator":"54:26-54:29","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"158","locator":"54:33-54:47","path":"value","type":"Property","source":{"localId":"157","locator":"54:33-54:41","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"162","locator":"54:52-54:60","type":"Multiply","operand":[{"localId":"160","locator":"54:53-54:54","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"161","locator":"54:58-54:59","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"30","type":"Literal"}]}}]}},{"localId":"174","locator":"55:7-55:60","when":{"localId":"165","locator":"55:12-55:17","valueType":"{urn:hl7-org:elm-types:r1}String","value":"year","type":"Literal"},"then":{"localId":"173","locator":"55:24-55:60","type":"Divide","operand":[{"localId":"169","locator":"55:24-55:47","type":"Divide","operand":[{"localId":"166","locator":"55:25-55:28","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"168","locator":"55:32-55:46","path":"value","type":"Property","source":{"localId":"167","locator":"55:32-55:40","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"172","locator":"55:51-55:60","type":"Multiply","operand":[{"localId":"170","locator":"55:52-55:53","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"171","locator":"55:57-55:59","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"365","type":"Literal"}]}}]}},{"localId":"180","locator":"56:7-56:48","when":{"localId":"175","locator":"56:12-56:18","valueType":"{urn:hl7-org:elm-types:r1}String","value":"hours","type":"Literal"},"then":{"localId":"179","locator":"56:25-56:48","type":"Divide","operand":[{"localId":"176","locator":"56:26-56:29","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"178","locator":"56:33-56:47","path":"value","type":"Property","source":{"localId":"177","locator":"56:33-56:41","name":"Frequency","type":"OperandRef"}}]}},{"localId":"188","locator":"57:7-57:55","when":{"localId":"181","locator":"57:12-57:20","valueType":"{urn:hl7-org:elm-types:r1}String","value":"minutes","type":"Literal"},"then":{"localId":"187","locator":"57:27-57:55","type":"Multiply","operand":[{"localId":"185","locator":"57:27-57:50","type":"Divide","operand":[{"localId":"182","locator":"57:28-57:31","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"184","locator":"57:35-57:49","path":"value","type":"Property","source":{"localId":"183","locator":"57:35-57:43","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"186","locator":"57:54-57:55","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]}},{"localId":"198","locator":"58:7-58:60","when":{"localId":"189","locator":"58:12-58:20","valueType":"{urn:hl7-org:elm-types:r1}String","value":"seconds","type":"Literal"},"then":{"localId":"197","locator":"58:27-58:60","type":"Multiply","operand":[{"localId":"195","locator":"58:27-58:55","type":"Multiply","operand":[{"localId":"193","locator":"58:27-58:50","type":"Divide","operand":[{"localId":"190","locator":"58:28-58:31","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"192","locator":"58:35-58:49","path":"value","type":"Property","source":{"localId":"191","locator":"58:35-58:43","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"194","locator":"58:54-58:55","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]},{"type":"ToDecimal","operand":{"localId":"196","locator":"58:59-58:60","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"60","type":"Literal"}}]}},{"localId":"206","locator":"59:7-59:52","when":{"localId":"199","locator":"59:12-59:17","valueType":"{urn:hl7-org:elm-types:r1}String","value":"days","type":"Literal"},"then":{"localId":"205","locator":"59:24-59:52","type":"Divide","operand":[{"localId":"203","locator":"59:24-59:47","type":"Divide","operand":[{"localId":"200","locator":"59:25-59:28","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"202","locator":"59:32-59:46","path":"value","type":"Property","source":{"localId":"201","locator":"59:32-59:40","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"204","locator":"59:51-59:52","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"}}]}},{"localId":"216","locator":"60:7-60:59","when":{"localId":"207","locator":"60:12-60:18","valueType":"{urn:hl7-org:elm-types:r1}String","value":"weeks","type":"Literal"},"then":{"localId":"215","locator":"60:25-60:59","type":"Divide","operand":[{"localId":"211","locator":"60:25-60:48","type":"Divide","operand":[{"localId":"208","locator":"60:26-60:29","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"210","locator":"60:33-60:47","path":"value","type":"Property","source":{"localId":"209","locator":"60:33-60:41","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"214","locator":"60:52-60:59","type":"Multiply","operand":[{"localId":"212","locator":"60:53-60:54","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"213","locator":"60:58","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"7","type":"Literal"}]}}]}},{"localId":"226","locator":"61:7-61:61","when":{"localId":"217","locator":"61:12-61:19","valueType":"{urn:hl7-org:elm-types:r1}String","value":"months","type":"Literal"},"then":{"localId":"225","locator":"61:26-61:61","type":"Divide","operand":[{"localId":"221","locator":"61:26-61:49","type":"Divide","operand":[{"localId":"218","locator":"61:27-61:30","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"220","locator":"61:34-61:48","path":"value","type":"Property","source":{"localId":"219","locator":"61:34-61:42","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"224","locator":"61:53-61:61","type":"Multiply","operand":[{"localId":"222","locator":"61:54-61:55","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"223","locator":"61:59-61:60","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"30","type":"Literal"}]}}]}},{"localId":"236","locator":"62:7-62:61","when":{"localId":"227","locator":"62:12-62:18","valueType":"{urn:hl7-org:elm-types:r1}String","value":"years","type":"Literal"},"then":{"localId":"235","locator":"62:25-62:61","type":"Divide","operand":[{"localId":"231","locator":"62:25-62:48","type":"Divide","operand":[{"localId":"228","locator":"62:26-62:29","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"24.0","type":"Literal"},{"localId":"230","locator":"62:33-62:47","path":"value","type":"Property","source":{"localId":"229","locator":"62:33-62:41","name":"Frequency","type":"OperandRef"}}]},{"type":"ToDecimal","operand":{"localId":"234","locator":"62:52-62:61","type":"Multiply","operand":[{"localId":"232","locator":"62:53-62:54","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"24","type":"Literal"},{"localId":"233","locator":"62:58-62:60","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"365","type":"Literal"}]}}]}}],"else":{"asType":"{urn:hl7-org:elm-types:r1}Decimal","type":"As","operand":{"localId":"237","locator":"63:12-63:15","type":"Null"}}},"operand":[{"name":"Frequency","operandTypeSpecifier":{"localId":"48","locator":"40:45-40:52","name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"}}]},{"localId":"348","locator":"68:1-92:5","name":"CodeToDaily","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Returns the equivalent daily frequency (as a decimal) of the given code"},{"name":"description","value":"Returns the equivalent daily frequency (as a decimal) of the given code"},{"name":"comment","value":"Note that for ranges, the boundary resulting in the highest frequency result is used. E.g. `Every two to four hours` results in `12.0` and `One to two` times a day results in `2.0`."}],"s":{"r":"348","s":[{"value":["/*@description: Returns the equivalent daily frequency (as a decimal) of the given code\n@comment: Note that for ranges, the boundary resulting in the highest frequency result is used. E.g. `Every two to four hours` results in `12.0` and `One to two` times a day results in `2.0`.*/\n","define function ","\"CodeToDaily\"","(","Frequency"," "]},{"r":"240","s":[{"value":["Code"]}]},{"value":[" ):\n  "]},{"r":"347","s":[{"r":"347","s":[{"value":["case\n    "]},{"r":"245","s":[{"value":["when "]},{"r":"243","s":[{"r":"241","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"242","s":[{"value":["\"Once daily (qualifier value)\""]}]}]},{"r":"244","value":[" then ","1.0"]}]},{"value":["\n    "]},{"r":"250","s":[{"value":["when "]},{"r":"248","s":[{"r":"246","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"247","s":[{"value":["\"Twice a day (qualifier value)\""]}]}]},{"r":"249","value":[" then ","2.0"]}]},{"value":["\n    "]},{"r":"255","s":[{"value":["when "]},{"r":"253","s":[{"r":"251","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"252","s":[{"value":["\"Three times daily (qualifier value)\""]}]}]},{"r":"254","value":[" then ","3.0"]}]},{"value":["\n    "]},{"r":"260","s":[{"value":["when "]},{"r":"258","s":[{"r":"256","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"257","s":[{"value":["\"Four times daily (qualifier value)\""]}]}]},{"r":"259","value":[" then ","4.0"]}]},{"value":["\n    "]},{"r":"265","s":[{"value":["when "]},{"r":"263","s":[{"r":"261","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"262","s":[{"value":["\"Every twenty four hours (qualifier value)\""]}]}]},{"r":"264","value":[" then ","1.0"]}]},{"value":["\n    "]},{"r":"270","s":[{"value":["when "]},{"r":"268","s":[{"r":"266","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"267","s":[{"value":["\"Every twelve hours (qualifier value)\""]}]}]},{"r":"269","value":[" then ","2.0"]}]},{"value":["\n    "]},{"r":"275","s":[{"value":["when "]},{"r":"273","s":[{"r":"271","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"272","s":[{"value":["\"Every thirty six hours (qualifier value)\""]}]}]},{"r":"274","value":[" then ","0.67"]}]},{"value":["\n    "]},{"r":"280","s":[{"value":["when "]},{"r":"278","s":[{"r":"276","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"277","s":[{"value":["\"Every eight hours (qualifier value)\""]}]}]},{"r":"279","value":[" then ","3.0"]}]},{"value":["\n    "]},{"r":"285","s":[{"value":["when "]},{"r":"283","s":[{"r":"281","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"282","s":[{"value":["\"Every four hours (qualifier value)\""]}]}]},{"r":"284","value":[" then ","6.0"]}]},{"value":["\n    "]},{"r":"290","s":[{"value":["when "]},{"r":"288","s":[{"r":"286","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"287","s":[{"value":["\"Every six hours (qualifier value)\""]}]}]},{"r":"289","value":[" then ","4.0"]}]},{"value":["\n    "]},{"r":"295","s":[{"value":["when "]},{"r":"293","s":[{"r":"291","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"292","s":[{"value":["\"Every seventy two hours (qualifier value)\""]}]}]},{"r":"294","value":[" then ","0.33"]}]},{"value":["\n    "]},{"r":"300","s":[{"value":["when "]},{"r":"298","s":[{"r":"296","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"297","s":[{"value":["\"Every forty eight hours (qualifier value)\""]}]}]},{"r":"299","value":[" then ","0.5"]}]},{"value":["\n    "]},{"r":"305","s":[{"value":["when "]},{"r":"303","s":[{"r":"301","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"302","s":[{"value":["\"Every eight to twelve hours (qualifier value)\""]}]}]},{"r":"304","value":[" then ","3.0"]}]},{"value":["\n    "]},{"r":"310","s":[{"value":["when "]},{"r":"308","s":[{"r":"306","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"307","s":[{"value":["\"Every six to eight hours (qualifier value)\""]}]}]},{"r":"309","value":[" then ","4.0"]}]},{"value":["\n    "]},{"r":"315","s":[{"value":["when "]},{"r":"313","s":[{"r":"311","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"312","s":[{"value":["\"Every three to four hours (qualifier value)\""]}]}]},{"r":"314","value":[" then ","8.0"]}]},{"value":["\n    "]},{"r":"320","s":[{"value":["when "]},{"r":"318","s":[{"r":"316","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"317","s":[{"value":["\"Every three to six hours (qualifier value)\""]}]}]},{"r":"319","value":[" then ","8.0"]}]},{"value":["\n    "]},{"r":"325","s":[{"value":["when "]},{"r":"323","s":[{"r":"321","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"322","s":[{"value":["\"Every two to four hours (qualifier value)\""]}]}]},{"r":"324","value":[" then ","12.0"]}]},{"value":["\n    "]},{"r":"330","s":[{"value":["when "]},{"r":"328","s":[{"r":"326","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"327","s":[{"value":["\"One to four times a day (qualifier value)\""]}]}]},{"r":"329","value":[" then ","4.0"]}]},{"value":["\n    "]},{"r":"335","s":[{"value":["when "]},{"r":"333","s":[{"r":"331","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"332","s":[{"value":["\"One to three times a day (qualifier value)\""]}]}]},{"r":"334","value":[" then ","3.0"]}]},{"value":["\n    "]},{"r":"340","s":[{"value":["when "]},{"r":"338","s":[{"r":"336","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"337","s":[{"value":["\"One to two times a day (qualifier value)\""]}]}]},{"r":"339","value":[" then ","2.0"]}]},{"value":["\n    "]},{"r":"345","s":[{"value":["when "]},{"r":"343","s":[{"r":"341","s":[{"value":["Frequency"]}]},{"value":[" ","~"," "]},{"r":"342","s":[{"value":["\"Two to four times a day (qualifier value)\""]}]}]},{"r":"344","value":[" then ","4.0"]}]},{"r":"346","value":["\n    else ","null","\n  end"]}]}]}]}}],"expression":{"localId":"347","locator":"69:3-92:5","type":"Case","caseItem":[{"localId":"245","locator":"70:5-70:60","when":{"localId":"243","locator":"70:10-70:51","type":"Equivalent","operand":[{"localId":"241","locator":"70:10-70:18","name":"Frequency","type":"OperandRef"},{"localId":"242","locator":"70:22-70:51","name":"Once daily (qualifier value)","type":"CodeRef"}]},"then":{"localId":"244","locator":"70:58-70:60","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"1.0","type":"Literal"}},{"localId":"250","locator":"71:5-71:61","when":{"localId":"248","locator":"71:10-71:52","type":"Equivalent","operand":[{"localId":"246","locator":"71:10-71:18","name":"Frequency","type":"OperandRef"},{"localId":"247","locator":"71:22-71:52","name":"Twice a day (qualifier value)","type":"CodeRef"}]},"then":{"localId":"249","locator":"71:59-71:61","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"2.0","type":"Literal"}},{"localId":"255","locator":"72:5-72:67","when":{"localId":"253","locator":"72:10-72:58","type":"Equivalent","operand":[{"localId":"251","locator":"72:10-72:18","name":"Frequency","type":"OperandRef"},{"localId":"252","locator":"72:22-72:58","name":"Three times daily (qualifier value)","type":"CodeRef"}]},"then":{"localId":"254","locator":"72:65-72:67","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"3.0","type":"Literal"}},{"localId":"260","locator":"73:5-73:66","when":{"localId":"258","locator":"73:10-73:57","type":"Equivalent","operand":[{"localId":"256","locator":"73:10-73:18","name":"Frequency","type":"OperandRef"},{"localId":"257","locator":"73:22-73:57","name":"Four times daily (qualifier value)","type":"CodeRef"}]},"then":{"localId":"259","locator":"73:64-73:66","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"4.0","type":"Literal"}},{"localId":"265","locator":"74:5-74:73","when":{"localId":"263","locator":"74:10-74:64","type":"Equivalent","operand":[{"localId":"261","locator":"74:10-74:18","name":"Frequency","type":"OperandRef"},{"localId":"262","locator":"74:22-74:64","name":"Every twenty four hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"264","locator":"74:71-74:73","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"1.0","type":"Literal"}},{"localId":"270","locator":"75:5-75:68","when":{"localId":"268","locator":"75:10-75:59","type":"Equivalent","operand":[{"localId":"266","locator":"75:10-75:18","name":"Frequency","type":"OperandRef"},{"localId":"267","locator":"75:22-75:59","name":"Every twelve hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"269","locator":"75:66-75:68","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"2.0","type":"Literal"}},{"localId":"275","locator":"76:5-76:73","when":{"localId":"273","locator":"76:10-76:63","type":"Equivalent","operand":[{"localId":"271","locator":"76:10-76:18","name":"Frequency","type":"OperandRef"},{"localId":"272","locator":"76:22-76:63","name":"Every thirty six hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"274","locator":"76:70-76:73","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"0.67","type":"Literal"}},{"localId":"280","locator":"77:5-77:67","when":{"localId":"278","locator":"77:10-77:58","type":"Equivalent","operand":[{"localId":"276","locator":"77:10-77:18","name":"Frequency","type":"OperandRef"},{"localId":"277","locator":"77:22-77:58","name":"Every eight hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"279","locator":"77:65-77:67","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"3.0","type":"Literal"}},{"localId":"285","locator":"78:5-78:66","when":{"localId":"283","locator":"78:10-78:57","type":"Equivalent","operand":[{"localId":"281","locator":"78:10-78:18","name":"Frequency","type":"OperandRef"},{"localId":"282","locator":"78:22-78:57","name":"Every four hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"284","locator":"78:64-78:66","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"6.0","type":"Literal"}},{"localId":"290","locator":"79:5-79:65","when":{"localId":"288","locator":"79:10-79:56","type":"Equivalent","operand":[{"localId":"286","locator":"79:10-79:18","name":"Frequency","type":"OperandRef"},{"localId":"287","locator":"79:22-79:56","name":"Every six hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"289","locator":"79:63-79:65","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"4.0","type":"Literal"}},{"localId":"295","locator":"80:5-80:74","when":{"localId":"293","locator":"80:10-80:64","type":"Equivalent","operand":[{"localId":"291","locator":"80:10-80:18","name":"Frequency","type":"OperandRef"},{"localId":"292","locator":"80:22-80:64","name":"Every seventy two hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"294","locator":"80:71-80:74","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"0.33","type":"Literal"}},{"localId":"300","locator":"81:5-81:73","when":{"localId":"298","locator":"81:10-81:64","type":"Equivalent","operand":[{"localId":"296","locator":"81:10-81:18","name":"Frequency","type":"OperandRef"},{"localId":"297","locator":"81:22-81:64","name":"Every forty eight hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"299","locator":"81:71-81:73","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"0.5","type":"Literal"}},{"localId":"305","locator":"82:5-82:77","when":{"localId":"303","locator":"82:10-82:68","type":"Equivalent","operand":[{"localId":"301","locator":"82:10-82:18","name":"Frequency","type":"OperandRef"},{"localId":"302","locator":"82:22-82:68","name":"Every eight to twelve hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"304","locator":"82:75-82:77","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"3.0","type":"Literal"}},{"localId":"310","locator":"83:5-83:74","when":{"localId":"308","locator":"83:10-83:65","type":"Equivalent","operand":[{"localId":"306","locator":"83:10-83:18","name":"Frequency","type":"OperandRef"},{"localId":"307","locator":"83:22-83:65","name":"Every six to eight hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"309","locator":"83:72-83:74","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"4.0","type":"Literal"}},{"localId":"315","locator":"84:5-84:75","when":{"localId":"313","locator":"84:10-84:66","type":"Equivalent","operand":[{"localId":"311","locator":"84:10-84:18","name":"Frequency","type":"OperandRef"},{"localId":"312","locator":"84:22-84:66","name":"Every three to four hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"314","locator":"84:73-84:75","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"8.0","type":"Literal"}},{"localId":"320","locator":"85:5-85:74","when":{"localId":"318","locator":"85:10-85:65","type":"Equivalent","operand":[{"localId":"316","locator":"85:10-85:18","name":"Frequency","type":"OperandRef"},{"localId":"317","locator":"85:22-85:65","name":"Every three to six hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"319","locator":"85:72-85:74","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"8.0","type":"Literal"}},{"localId":"325","locator":"86:5-86:74","when":{"localId":"323","locator":"86:10-86:64","type":"Equivalent","operand":[{"localId":"321","locator":"86:10-86:18","name":"Frequency","type":"OperandRef"},{"localId":"322","locator":"86:22-86:64","name":"Every two to four hours (qualifier value)","type":"CodeRef"}]},"then":{"localId":"324","locator":"86:71-86:74","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"12.0","type":"Literal"}},{"localId":"330","locator":"87:5-87:73","when":{"localId":"328","locator":"87:10-87:64","type":"Equivalent","operand":[{"localId":"326","locator":"87:10-87:18","name":"Frequency","type":"OperandRef"},{"localId":"327","locator":"87:22-87:64","name":"One to four times a day (qualifier value)","type":"CodeRef"}]},"then":{"localId":"329","locator":"87:71-87:73","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"4.0","type":"Literal"}},{"localId":"335","locator":"88:5-88:74","when":{"localId":"333","locator":"88:10-88:65","type":"Equivalent","operand":[{"localId":"331","locator":"88:10-88:18","name":"Frequency","type":"OperandRef"},{"localId":"332","locator":"88:22-88:65","name":"One to three times a day (qualifier value)","type":"CodeRef"}]},"then":{"localId":"334","locator":"88:72-88:74","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"3.0","type":"Literal"}},{"localId":"340","locator":"89:5-89:72","when":{"localId":"338","locator":"89:10-89:63","type":"Equivalent","operand":[{"localId":"336","locator":"89:10-89:18","name":"Frequency","type":"OperandRef"},{"localId":"337","locator":"89:22-89:63","name":"One to two times a day (qualifier value)","type":"CodeRef"}]},"then":{"localId":"339","locator":"89:70-89:72","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"2.0","type":"Literal"}},{"localId":"345","locator":"90:5-90:73","when":{"localId":"343","locator":"90:10-90:64","type":"Equivalent","operand":[{"localId":"341","locator":"90:10-90:18","name":"Frequency","type":"OperandRef"},{"localId":"342","locator":"90:22-90:64","name":"Two to four times a day (qualifier value)","type":"CodeRef"}]},"then":{"localId":"344","locator":"90:71-90:73","valueType":"{urn:hl7-org:elm-types:r1}Decimal","value":"4.0","type":"Literal"}}],"else":{"asType":"{urn:hl7-org:elm-types:r1}Decimal","type":"As","operand":{"localId":"346","locator":"91:10-91:13","type":"Null"}}},"operand":[{"name":"Frequency","operandTypeSpecifier":{"localId":"240","locator":"68:41-68:44","name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}}]},{"localId":"365","locator":"95:1-99:5","name":"ToDaily","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Returns the daily frequency (as a decimal) of the given input*/"},{"name":"description","value":"Returns the daily frequency (as a decimal) of the given input*/"}],"s":{"r":"365","s":[{"value":["/*@description: Returns the daily frequency (as a decimal) of the given input*/\n","define function ","\"ToDaily\"","(","Frequency"," "]},{"r":"351","s":[{"value":["Choice\u003c"]},{"r":"349","s":[{"value":["Quantity"]}]},{"value":[", "]},{"r":"350","s":[{"value":["Code"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"364","s":[{"r":"364","s":[{"value":["case\n    "]},{"r":"359","s":[{"value":["when "]},{"r":"354","s":[{"r":"352","s":[{"value":["Frequency"]}]},{"value":[" is "]},{"r":"353","s":[{"value":["Quantity"]}]}]},{"value":[" then "]},{"r":"358","s":[{"value":["QuantityToDaily","("]},{"r":"357","s":[{"r":"355","s":[{"value":["Frequency"]}]},{"value":[" as "]},{"r":"356","s":[{"value":["Quantity"]}]}]},{"value":[")"]}]}]},{"value":["\n    else "]},{"r":"363","s":[{"value":["CodeToDaily","("]},{"r":"362","s":[{"r":"360","s":[{"value":["Frequency"]}]},{"value":[" as "]},{"r":"361","s":[{"value":["Code"]}]}]},{"value":[")"]}]},{"value":["\n  end"]}]}]}]}}],"expression":{"localId":"364","locator":"96:3-99:5","type":"Case","caseItem":[{"localId":"359","locator":"97:5-97:74","when":{"localId":"354","locator":"97:10-97:30","type":"Is","operand":{"localId":"352","locator":"97:10-97:18","name":"Frequency","type":"OperandRef"},"isTypeSpecifier":{"localId":"353","locator":"97:23-97:30","name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"}},"then":{"localId":"358","locator":"97:37-97:74","name":"QuantityToDaily","type":"FunctionRef","operand":[{"localId":"357","locator":"97:53-97:73","strict":false,"type":"As","operand":{"localId":"355","locator":"97:53-97:61","name":"Frequency","type":"OperandRef"},"asTypeSpecifier":{"localId":"356","locator":"97:66-97:73","name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"}}]}}],"else":{"localId":"363","locator":"98:10-98:39","name":"CodeToDaily","type":"FunctionRef","operand":[{"localId":"362","locator":"98:22-98:38","strict":false,"type":"As","operand":{"localId":"360","locator":"98:22-98:30","name":"Frequency","type":"OperandRef"},"asTypeSpecifier":{"localId":"361","locator":"98:35-98:38","name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}}]}},"operand":[{"name":"Frequency","operandTypeSpecifier":{"localId":"351","locator":"95:37-95:58","type":"ChoiceTypeSpecifier","choice":[{"localId":"349","locator":"95:44-95:51","name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"},{"localId":"350","locator":"95:54-95:57","name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}]}}]},{"localId":"368","locator":"105:1-106:9","name":"TherapeuticDuration","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Returns the established therapeutic duration for a given medication"},{"name":"description","value":"Returns the established therapeutic duration for a given medication"},{"name":"comment","value":"This is likely measure specific, though could potentially be established for any drug and distributed as a CodeSystem supplement. Defaulting to 14 days here for illustration."},{"name":"seealso","value":"[CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used."}],"s":{"r":"368","s":[{"value":["/*@description: Returns the established therapeutic duration for a given medication\n  @comment: This is likely measure specific, though could potentially be established for any drug and distributed as a CodeSystem supplement. Defaulting to 14 days here for illustration.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used.*/\n","define function ","\"TherapeuticDuration\"","(","medication"," "]},{"r":"366","s":[{"value":["Code"]}]},{"value":[" ):\n  "]},{"r":"367","s":[{"r":"367","s":[{"value":["14 ","days"]}]}]}]}}],"expression":{"localId":"367","locator":"106:3-106:9","value":14,"unit":"days","type":"Quantity"},"operand":[{"name":"medication","operandTypeSpecifier":{"localId":"366","locator":"105:50-105:53","name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}}]},{"localId":"400","locator":"112:1-121:15","name":"MedicationAdministrationPeriod","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Calculates Medication Period for a given Medication, Administration"},{"name":"description","value":"Calculates Medication Period for a given Medication, Administration"},{"name":"comment","value":"This function calculates the effective duration of a single medication administration event using the following approach: If a TherapeuticDuration is defined for the medication, the result is the interval from the earliest of the `relevantDatetime` and `relevantPeriod` elements, to the end of the therapeutic duration."},{"name":"seealso","value":"[CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used."}],"s":{"r":"400","s":[{"value":["/*@description: Calculates Medication Period for a given Medication, Administration\n  @comment: This function calculates the effective duration of a single medication administration event using the following approach: If a TherapeuticDuration is defined for the medication, the result is the interval from the earliest of the `relevantDatetime` and `relevantPeriod` elements, to the end of the therapeutic duration.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used.*/\n","define function ","\"MedicationAdministrationPeriod\"","(","MedAdministration"," "]},{"r":"369","s":[{"value":["\"Medication, Administered\""]}]},{"value":[" ):\n  "]},{"r":"399","s":[{"r":"399","s":[{"s":[{"r":"371","s":[{"r":"370","s":[{"s":[{"value":["MedAdministration"]}]}]},{"value":[" ","Administration"]}]}]},{"value":["\n       "]},{"s":[{"value":["let\n         "]},{"r":"375","s":[{"value":["therapeuticDuration",": "]},{"r":"374","s":[{"value":["TherapeuticDuration","("]},{"r":"373","s":[{"r":"372","s":[{"value":["Administration"]}]},{"value":["."]},{"r":"373","s":[{"value":["code"]}]}]},{"value":[")"]}]}]},{"value":[",\n         "]},{"r":"383","s":[{"value":["startDate",": "]},{"r":"382","s":[{"value":["date from "]},{"r":"381","s":[{"r":"376","s":[{"value":["Global"]}]},{"value":["."]},{"r":"381","s":[{"value":["EarliestOf","("]},{"r":"378","s":[{"r":"377","s":[{"value":["Administration"]}]},{"value":["."]},{"r":"378","s":[{"value":["relevantDatetime"]}]}]},{"value":[", "]},{"r":"380","s":[{"r":"379","s":[{"value":["Administration"]}]},{"value":["."]},{"r":"380","s":[{"value":["relevantPeriod"]}]}]},{"value":[")"]}]}]}]}]}]},{"value":["\n       "]},{"r":"398","s":[{"value":["return\n         "]},{"r":"397","s":[{"value":["if "]},{"r":"388","s":[{"r":"385","s":[{"r":"384","s":[{"value":["startDate"]}]},{"value":[" is not null"]}]},{"value":[" and "]},{"r":"387","s":[{"r":"386","s":[{"value":["therapeuticDuration"]}]},{"value":[" is not null"]}]}]},{"value":[" then\n           "]},{"r":"395","s":[{"value":["Interval["]},{"r":"389","s":[{"value":["startDate"]}]},{"value":[", "]},{"r":"394","s":[{"r":"392","s":[{"r":"390","s":[{"value":["startDate"]}]},{"value":[" + "]},{"r":"391","s":[{"value":["therapeuticDuration"]}]}]},{"r":"393","value":[" - ","1"]}]},{"value":["]"]}]},{"r":"396","value":["\n         else\n           ","null"]}]}]}]}]}]}}],"expression":{"localId":"399","locator":"113:3-121:15","type":"Query","source":[{"localId":"371","locator":"113:3-113:34","alias":"Administration","expression":{"localId":"370","locator":"113:3-113:19","name":"MedAdministration","type":"OperandRef"}}],"let":[{"localId":"375","locator":"115:10-115:70","identifier":"therapeuticDuration","expression":{"localId":"374","locator":"115:31-115:70","name":"TherapeuticDuration","type":"FunctionRef","operand":[{"localId":"373","locator":"115:51-115:69","path":"code","scope":"Administration","type":"Property"}]}},{"localId":"383","locator":"116:10-116:111","identifier":"startDate","expression":{"localId":"382","locator":"116:21-116:111","type":"DateFrom","operand":{"localId":"381","locator":"116:31-116:111","name":"EarliestOf","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"378","locator":"116:49-116:79","path":"relevantDatetime","scope":"Administration","type":"Property"},{"localId":"380","locator":"116:82-116:110","path":"relevantPeriod","scope":"Administration","type":"Property"}]}}}],"relationship":[],"return":{"localId":"398","locator":"117:8-121:15","expression":{"localId":"397","locator":"118:10-121:15","type":"If","condition":{"localId":"388","locator":"118:13-118:69","type":"And","operand":[{"localId":"385","locator":"118:13-118:33","type":"Not","operand":{"locator":"118:13-118:33","type":"IsNull","operand":{"localId":"384","locator":"118:13-118:21","name":"startDate","type":"QueryLetRef"}}},{"localId":"387","locator":"118:39-118:69","type":"Not","operand":{"locator":"118:39-118:69","type":"IsNull","operand":{"localId":"386","locator":"118:39-118:57","name":"therapeuticDuration","type":"QueryLetRef"}}}]},"then":{"localId":"395","locator":"119:12-119:67","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"389","locator":"119:21-119:29","name":"startDate","type":"QueryLetRef"},"high":{"localId":"394","locator":"119:32-119:66","type":"Subtract","operand":[{"localId":"392","locator":"119:32-119:62","type":"Add","operand":[{"localId":"390","locator":"119:32-119:40","name":"startDate","type":"QueryLetRef"},{"localId":"391","locator":"119:44-119:62","name":"therapeuticDuration","type":"QueryLetRef"}]},{"type":"ToQuantity","operand":{"localId":"393","locator":"119:66","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}}]}},"else":{"type":"As","operand":{"localId":"396","locator":"121:12-121:15","type":"Null"},"asTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}}},"operand":[{"name":"MedAdministration","operandTypeSpecifier":{"localId":"369","locator":"112:68-112:93","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationAdministered","type":"NamedTypeSpecifier"}}]},{"localId":"446","locator":"128:1-140:12","name":"MedicationDischargePeriod","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Calculates the Medication Period for a Medication, Discharge"},{"name":"description","value":"Calculates the Medication Period for a Medication, Discharge"},{"name":"comment","value":"This function calculates the effective duration of a single medication discharge event using the following approach: If the `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. Otherwise, the duration is calculated using `(supply / (dosage * frequency)) * (1 + refills)`. The result is then the interval from `authorDatetime` to `authorDatetime + daysSupplied`.\nNote that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL."},{"name":"seealso","value":"[CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\nNote that this function has not been tested."}],"s":{"r":"446","s":[{"value":["/*@description: Calculates the Medication Period for a Medication, Discharge\n@comment: This function calculates the effective duration of a single medication discharge event using the following approach: If the `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. Otherwise, the duration is calculated using `(supply / (dosage * frequency)) * (1 + refills)`. The result is then the interval from `authorDatetime` to `authorDatetime + daysSupplied`.\nNote that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n@seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\nNote that this function has not been tested.*/\n","define function ","\"MedicationDischargePeriod\"","(","Medication"," "]},{"r":"401","s":[{"value":["\"Medication, Discharge\""]}]},{"value":[" ):\n  "]},{"r":"445","s":[{"r":"445","s":[{"s":[{"r":"423","s":[{"r":"422","s":[{"value":["(\n    "]},{"r":"422","s":[{"r":"415","s":[{"value":["Coalesce","(\n      "]},{"r":"403","s":[{"r":"402","s":[{"value":["Medication"]}]},{"value":["."]},{"r":"403","s":[{"value":["daysSupplied"]}]}]},{"value":[",\n      "]},{"r":"414","s":[{"r":"406","s":[{"r":"405","s":[{"r":"404","s":[{"value":["Medication"]}]},{"value":["."]},{"r":"405","s":[{"value":["supply"]}]}]},{"value":["."]},{"r":"406","s":[{"value":["value"]}]}]},{"value":[" / "]},{"r":"413","s":[{"value":["("]},{"r":"413","s":[{"r":"409","s":[{"r":"408","s":[{"r":"407","s":[{"value":["Medication"]}]},{"value":["."]},{"r":"408","s":[{"value":["dosage"]}]}]},{"value":["."]},{"r":"409","s":[{"value":["value"]}]}]},{"value":[" * "]},{"r":"412","s":[{"value":["ToDaily","("]},{"r":"411","s":[{"r":"410","s":[{"value":["Medication"]}]},{"value":["."]},{"r":"411","s":[{"value":["frequency"]}]}]},{"value":[")"]}]}]},{"value":[")"]}]}]},{"value":["\n    )"]}]},{"value":[" * "]},{"r":"421","s":[{"value":["("]},{"r":"421","s":[{"r":"416","value":["1"," + "]},{"r":"420","s":[{"value":["Coalesce","("]},{"r":"418","s":[{"r":"417","s":[{"value":["Medication"]}]},{"value":["."]},{"r":"418","s":[{"value":["refills"]}]}]},{"r":"419","value":[", ","0",")"]}]}]},{"value":[")"]}]}]},{"value":["\n  )"]}]},{"value":[" ","totalDaysSupplied"]}]}]},{"value":["\n    "]},{"s":[{"value":["let "]},{"r":"427","s":[{"value":["startDate",": "]},{"r":"426","s":[{"value":["date from "]},{"r":"425","s":[{"r":"424","s":[{"value":["Medication"]}]},{"value":["."]},{"r":"425","s":[{"value":["authorDatetime"]}]}]}]}]}]},{"value":["\n    "]},{"r":"444","s":[{"value":["return\n      "]},{"r":"443","s":[{"value":["if "]},{"r":"432","s":[{"r":"429","s":[{"r":"428","s":[{"value":["startDate"]}]},{"value":[" is not null"]}]},{"value":[" and "]},{"r":"431","s":[{"r":"430","s":[{"value":["totalDaysSupplied"]}]},{"value":[" is not null"]}]}]},{"value":[" then\n        "]},{"r":"441","s":[{"value":["Interval["]},{"r":"433","s":[{"value":["startDate"]}]},{"value":[", "]},{"r":"440","s":[{"r":"434","s":[{"value":["startDate"]}]},{"value":[" + "]},{"r":"439","s":[{"value":["Quantity"," { "]},{"s":[{"value":["value",": "]},{"r":"437","s":[{"r":"435","s":[{"value":["totalDaysSupplied"]}]},{"r":"436","value":[" - ","1"]}]}]},{"value":[", "]},{"s":[{"value":["unit",": "]},{"r":"438","s":[{"value":["'day'"]}]}]},{"value":[" }"]}]}]},{"value":["]"]}]},{"r":"442","value":["\n      else\n        ","null"]}]}]}]}]}]}}],"expression":{"localId":"445","locator":"129:3-140:12","type":"Query","source":[{"localId":"423","locator":"129:3-134:21","alias":"totalDaysSupplied","expression":{"localId":"422","locator":"129:3-134:3","type":"Multiply","operand":[{"localId":"415","locator":"130:5-133:5","type":"Coalesce","operand":[{"type":"ToDecimal","operand":{"localId":"403","locator":"131:7-131:29","path":"daysSupplied","type":"Property","source":{"localId":"402","locator":"131:7-131:16","name":"Medication","type":"OperandRef"}}},{"localId":"414","locator":"132:7-132:89","type":"Divide","operand":[{"localId":"406","locator":"132:7-132:29","path":"value","type":"Property","source":{"localId":"405","locator":"132:7-132:23","path":"supply","type":"Property","source":{"localId":"404","locator":"132:7-132:16","name":"Medication","type":"OperandRef"}}},{"localId":"413","locator":"132:33-132:89","type":"Multiply","operand":[{"localId":"409","locator":"132:34-132:56","path":"value","type":"Property","source":{"localId":"408","locator":"132:34-132:50","path":"dosage","type":"Property","source":{"localId":"407","locator":"132:34-132:43","name":"Medication","type":"OperandRef"}}},{"localId":"412","locator":"132:60-132:88","name":"ToDaily","type":"FunctionRef","operand":[{"type":"As","operand":{"localId":"411","locator":"132:68-132:87","path":"frequency","type":"Property","source":{"localId":"410","locator":"132:68-132:77","name":"Medication","type":"OperandRef"}},"asTypeSpecifier":{"type":"ChoiceTypeSpecifier","choice":[{"name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"},{"name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}]}}]}]}]}]},{"type":"ToDecimal","operand":{"localId":"421","locator":"133:9-133:45","type":"Add","operand":[{"localId":"416","locator":"133:10","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"},{"localId":"420","locator":"133:14-133:44","type":"Coalesce","operand":[{"localId":"418","locator":"133:23-133:40","path":"refills","type":"Property","source":{"localId":"417","locator":"133:23-133:32","name":"Medication","type":"OperandRef"}},{"localId":"419","locator":"133:43","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}]}]}}]}}],"let":[{"localId":"427","locator":"135:9-135:54","identifier":"startDate","expression":{"localId":"426","locator":"135:20-135:54","type":"DateFrom","operand":{"localId":"425","locator":"135:30-135:54","path":"authorDatetime","type":"Property","source":{"localId":"424","locator":"135:30-135:39","name":"Medication","type":"OperandRef"}}}}],"relationship":[],"return":{"localId":"444","locator":"136:5-140:12","expression":{"localId":"443","locator":"137:7-140:12","type":"If","condition":{"localId":"432","locator":"137:10-137:64","type":"And","operand":[{"localId":"429","locator":"137:10-137:30","type":"Not","operand":{"locator":"137:10-137:30","type":"IsNull","operand":{"localId":"428","locator":"137:10-137:18","name":"startDate","type":"QueryLetRef"}}},{"localId":"431","locator":"137:36-137:64","type":"Not","operand":{"locator":"137:36-137:64","type":"IsNull","operand":{"localId":"430","locator":"137:36-137:52","name":"totalDaysSupplied","type":"AliasRef"}}}]},"then":{"localId":"441","locator":"138:9-138:95","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"433","locator":"138:18-138:26","name":"startDate","type":"QueryLetRef"},"high":{"localId":"440","locator":"138:29-138:94","type":"Add","operand":[{"localId":"434","locator":"138:29-138:37","name":"startDate","type":"QueryLetRef"},{"localId":"439","locator":"138:41-138:94","classType":"{urn:hl7-org:elm-types:r1}Quantity","type":"Instance","element":[{"name":"value","value":{"localId":"437","locator":"138:59-138:79","type":"Subtract","operand":[{"localId":"435","locator":"138:59-138:75","name":"totalDaysSupplied","type":"AliasRef"},{"type":"ToDecimal","operand":{"localId":"436","locator":"138:79","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}}]}},{"name":"unit","value":{"localId":"438","locator":"138:88-138:92","valueType":"{urn:hl7-org:elm-types:r1}String","value":"day","type":"Literal"}}]}]}},"else":{"type":"As","operand":{"localId":"442","locator":"140:9-140:12","type":"Null"},"asTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}}},"operand":[{"name":"Medication","operandTypeSpecifier":{"localId":"401","locator":"128:56-128:78","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDischarge","type":"NamedTypeSpecifier"}}]},{"localId":"467","locator":"144:1-151:13","name":"CumulativeDuration","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Returns the total duration in days covered by the given periods"},{"name":"description","value":"Returns the total duration in days covered by the given periods"},{"name":"comment","value":"This function calculates the total duration in days covered by the given periods. If multiple periods in the input include the same day, that day is only counted once in the final result."}],"s":{"r":"467","s":[{"value":["/*@description: Returns the total duration in days covered by the given periods\n  @comment: This function calculates the total duration in days covered by the given periods. If multiple periods in the input include the same day, that day is only counted once in the final result.*/\n","define function ","\"CumulativeDuration\"","(","Intervals"," "]},{"r":"449","s":[{"value":["List\u003c"]},{"r":"448","s":[{"value":["Interval\u003c"]},{"r":"447","s":[{"value":["Date"]}]},{"value":["\u003e"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"466","s":[{"r":"466","s":[{"value":["if "]},{"r":"451","s":[{"r":"450","s":[{"value":["Intervals"]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"464","s":[{"value":["( "]},{"r":"464","s":[{"value":["Sum","("]},{"r":"463","s":[{"s":[{"r":"454","s":[{"r":"453","s":[{"value":["("]},{"r":"453","s":[{"value":["collapse "]},{"r":"452","s":[{"value":["Intervals"]}]},{"value":[" per ","day"]}]},{"value":[")"]}]},{"value":["X"]}]}]},{"value":["\n        "]},{"r":"462","s":[{"value":["return all"]},{"r":"461","s":[{"r":"459","s":[{"value":["("]},{"r":"459","s":[{"value":["difference in days between "]},{"r":"456","s":[{"value":["start of "]},{"r":"455","s":[{"value":["X"]}]}]},{"value":[" and \n          "]},{"r":"458","s":[{"value":["end of "]},{"r":"457","s":[{"value":["X"]}]}]}]},{"value":["\n        )"]}]},{"r":"460","value":["+ ","1"]}]}]}]},{"value":["\n    )"]}]},{"value":["\n  )"]}]},{"r":"465","value":[" \n    else ","null"]}]}]}]}}],"expression":{"localId":"466","locator":"145:3-151:13","type":"If","condition":{"localId":"451","locator":"145:6-145:26","type":"Not","operand":{"locator":"145:6-145:26","type":"IsNull","operand":{"localId":"450","locator":"145:6-145:14","name":"Intervals","type":"OperandRef"}}},"then":{"localId":"464","locator":"145:33-150:3","type":"Sum","source":{"localId":"463","locator":"145:39-148:12","type":"Query","source":[{"localId":"454","locator":"145:39-145:67","alias":"X","expression":{"localId":"453","locator":"145:39-145:66","type":"Collapse","operand":[{"localId":"452","locator":"145:49-145:57","name":"Intervals","type":"OperandRef"},{"value":1.0,"unit":"day","type":"Quantity"}]}}],"relationship":[],"return":{"localId":"462","locator":"146:9-148:12","distinct":false,"expression":{"localId":"461","locator":"146:19-148:12","type":"Add","operand":[{"localId":"459","locator":"146:19-148:9","precision":"Day","type":"DifferenceBetween","operand":[{"localId":"456","locator":"146:47-146:56","type":"Start","operand":{"localId":"455","locator":"146:56","name":"X","type":"AliasRef"}},{"localId":"458","locator":"147:11-147:18","type":"End","operand":{"localId":"457","locator":"147:18","name":"X","type":"AliasRef"}}]},{"localId":"460","locator":"148:12","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}]}}}},"else":{"asType":"{urn:hl7-org:elm-types:r1}Integer","type":"As","operand":{"localId":"465","locator":"151:10-151:13","type":"Null"}}},"operand":[{"name":"Intervals","operandTypeSpecifier":{"localId":"449","locator":"144:48-144:67","type":"ListTypeSpecifier","elementType":{"localId":"448","locator":"144:53-144:66","type":"IntervalTypeSpecifier","pointType":{"localId":"447","locator":"144:62-144:65","name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}]},{"localId":"509","locator":"155:1-163:5","name":"RolloutIntervals","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Rolls out periods so that overlapping periods delay the start of subsequent periods"},{"name":"description","value":"Rolls out periods so that overlapping periods delay the start of subsequent periods"},{"name":"comment","value":"Returns the periods with overlapping periods delayed so that there is no overlap between any two periods in the result."}],"s":{"r":"509","s":[{"value":["/*@description: Rolls out periods so that overlapping periods delay the start of subsequent periods\n  @comment: Returns the periods with overlapping periods delayed so that there is no overlap between any two periods in the result.*/\n","define function ","\"RolloutIntervals\"","(","intervals"," "]},{"r":"470","s":[{"value":["List\u003c"]},{"r":"469","s":[{"value":["Interval\u003c"]},{"r":"468","s":[{"value":["Date"]}]},{"value":["\u003e"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"508","s":[{"r":"508","s":[{"s":[{"r":"472","s":[{"r":"471","s":[{"s":[{"value":["intervals"]}]}]},{"value":[" ","I"]}]}]},{"value":[" "]},{"r":"507","s":[{"value":["aggregate all ","R"," "]},{"r":"477","s":[{"value":["starting ( "]},{"r":"477","s":[{"r":"473","value":["null"," as "]},{"r":"476","s":[{"value":["List\u003c"]},{"r":"475","s":[{"value":["Interval\u003c"]},{"r":"474","s":[{"value":["Date"]}]},{"value":["\u003e"]}]},{"value":["\u003e"]}]}]},{"value":[")"]}]},{"value":[": "]},{"r":"506","s":[{"r":"478","s":[{"value":["R"]}]},{"value":["\n    union "]},{"r":"505","s":[{"value":["( "]},{"r":"505","s":[{"value":["{ "]},{"r":"504","s":[{"s":[{"r":"480","s":[{"r":"479","s":[{"s":[{"value":["I"]}]}]},{"value":[" ","X"]}]}]},{"value":["\n        "]},{"s":[{"value":["let "]},{"r":"490","s":[{"value":["S",": "]},{"r":"489","s":[{"value":["Max","("]},{"r":"488","s":[{"value":["{ \n          "]},{"r":"485","s":[{"r":"483","s":[{"value":["end of "]},{"r":"482","s":[{"value":["Last","("]},{"r":"481","s":[{"value":["R"]}]},{"value":[")"]}]}]},{"value":["+ "]},{"r":"484","s":[{"value":["1 ","day"]}]}]},{"value":[", "]},{"r":"487","s":[{"value":["start of "]},{"r":"486","s":[{"value":["X"]}]}]},{"value":[" }"]}]},{"value":["\n        )"]}]}]},{"value":[",\n        "]},{"r":"499","s":[{"value":["E",": "]},{"r":"498","s":[{"r":"491","s":[{"value":["S"]}]},{"value":[" + "]},{"r":"497","s":[{"value":["Quantity"," { "]},{"s":[{"value":["value",": "]},{"r":"495","s":[{"value":["Coalesce","("]},{"r":"493","s":[{"value":["duration in days of "]},{"r":"492","s":[{"value":["X"]}]}]},{"r":"494","value":[", ","0",")"]}]}]},{"value":[", "]},{"s":[{"value":["unit",": "]},{"r":"496","s":[{"value":["'day'"]}]}]},{"value":[" }"]}]}]}]}]},{"value":["\n        "]},{"r":"503","s":[{"value":["return "]},{"r":"502","s":[{"value":["Interval["]},{"r":"500","s":[{"value":["S"]}]},{"value":[", "]},{"r":"501","s":[{"value":["E"]}]},{"value":["]"]}]}]}]},{"value":["}"]}]},{"value":["\n    )"]}]}]}]}]}]}]}}],"expression":{"localId":"508","locator":"156:3-163:5","type":"Query","source":[{"localId":"472","locator":"156:3-156:13","alias":"I","expression":{"localId":"471","locator":"156:3-156:11","name":"intervals","type":"OperandRef"}}],"relationship":[],"aggregate":{"localId":"507","locator":"156:15-163:5","identifier":"R","distinct":false,"expression":{"localId":"506","locator":"156:73-163:5","type":"Union","operand":[{"localId":"478","locator":"156:73","name":"R","type":"QueryLetRef"},{"localId":"505","locator":"157:11-163:5","type":"List","element":[{"localId":"504","locator":"157:15-162:29","type":"Query","source":[{"localId":"480","locator":"157:15-157:17","alias":"X","expression":{"localId":"479","locator":"157:15","name":"I","type":"AliasRef"}}],"let":[{"localId":"490","locator":"158:13-160:9","identifier":"S","expression":{"localId":"489","locator":"158:16-160:9","type":"Max","source":{"localId":"488","locator":"158:20-159:45","type":"List","element":[{"localId":"485","locator":"159:11-159:31","type":"Add","operand":[{"localId":"483","locator":"159:11-159:24","type":"End","operand":{"localId":"482","locator":"159:18-159:24","type":"Last","source":{"localId":"481","locator":"159:23","name":"R","type":"QueryLetRef"}}},{"localId":"484","locator":"159:27-159:31","value":1,"unit":"day","type":"Quantity"}]},{"localId":"487","locator":"159:34-159:43","type":"Start","operand":{"localId":"486","locator":"159:43","name":"X","type":"AliasRef"}}]}}},{"localId":"499","locator":"161:9-161:82","identifier":"E","expression":{"localId":"498","locator":"161:12-161:82","type":"Add","operand":[{"localId":"491","locator":"161:12","name":"S","type":"QueryLetRef"},{"localId":"497","locator":"161:16-161:82","classType":"{urn:hl7-org:elm-types:r1}Quantity","type":"Instance","element":[{"name":"value","value":{"type":"ToDecimal","operand":{"localId":"495","locator":"161:34-161:67","type":"Coalesce","operand":[{"localId":"493","locator":"161:43-161:63","precision":"Day","type":"DurationBetween","operand":[{"type":"Start","operand":{"localId":"492","locator":"161:63","name":"X","type":"AliasRef"}},{"type":"End","operand":{"localId":"492","locator":"161:63","name":"X","type":"AliasRef"}}]},{"localId":"494","locator":"161:66","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}]}}},{"name":"unit","value":{"localId":"496","locator":"161:76-161:80","valueType":"{urn:hl7-org:elm-types:r1}String","value":"day","type":"Literal"}}]}]}}],"relationship":[],"return":{"localId":"503","locator":"162:9-162:29","expression":{"localId":"502","locator":"162:16-162:29","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"500","locator":"162:25","name":"S","type":"QueryLetRef"},"high":{"localId":"501","locator":"162:28","name":"E","type":"QueryLetRef"}}}}]}]},"starting":{"localId":"477","locator":"156:31-156:70","strict":false,"type":"As","operand":{"localId":"473","locator":"156:42-156:45","type":"Null"},"asTypeSpecifier":{"localId":"476","locator":"156:50-156:69","type":"ListTypeSpecifier","elementType":{"localId":"475","locator":"156:55-156:68","type":"IntervalTypeSpecifier","pointType":{"localId":"474","locator":"156:64-156:67","name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}}},"operand":[{"name":"intervals","operandTypeSpecifier":{"localId":"470","locator":"155:46-155:65","type":"ListTypeSpecifier","elementType":{"localId":"469","locator":"155:51-155:64","type":"IntervalTypeSpecifier","pointType":{"localId":"468","locator":"155:60-155:63","name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}]},{"localId":"579","locator":"218:1-225:15","name":"MedicationOrderPeriod","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Calculates the Medication Period for a single Medication, Order"},{"name":"description","value":"Calculates the Medication Period for a single Medication, Order"},{"name":"comment","value":"This function calculates the expected period of a medication order using the following approach: If `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency)) * (1 + refills)`.  The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL."},{"name":"seealso","value":"[CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary."}],"s":{"r":"579","s":[{"value":["/*@description: Calculates the Medication Period for a single Medication, Order\n  @comment: This function calculates the expected period of a medication order using the following approach: If `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency)) * (1 + refills)`.  The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary.*/\n","define function ","\"MedicationOrderPeriod\"","(","MedOrder"," "]},{"r":"516","s":[{"value":["\"Medication, Order\""]}]},{"value":[" ):\n  "]},{"r":"578","s":[{"r":"578","s":[{"s":[{"r":"518","s":[{"r":"517","s":[{"s":[{"value":["MedOrder"]}]}]},{"value":[" ","Order"]}]}]},{"value":["\n    "]},{"s":[{"value":["let "]},{"r":"526","s":[{"value":["startDate",": "]},{"r":"525","s":[{"value":["date from "]},{"r":"524","s":[{"value":["Coalesce","("]},{"r":"521","s":[{"r":"520","s":[{"r":"519","s":[{"value":["Order"]}]},{"value":["."]},{"r":"520","s":[{"value":["relevantPeriod"]}]}]},{"value":["."]},{"r":"521","s":[{"value":["low"]}]}]},{"value":[", "]},{"r":"523","s":[{"r":"522","s":[{"value":["Order"]}]},{"value":["."]},{"r":"523","s":[{"value":["authorDatetime"]}]}]},{"value":[")"]}]}]}]},{"value":[",\n    "]},{"r":"548","s":[{"value":["totalDaysSupplied",": "]},{"r":"547","s":[{"r":"540","s":[{"value":["Coalesce","("]},{"r":"528","s":[{"r":"527","s":[{"value":["Order"]}]},{"value":["."]},{"r":"528","s":[{"value":["daysSupplied"]}]}]},{"value":[", "]},{"r":"539","s":[{"r":"531","s":[{"r":"530","s":[{"r":"529","s":[{"value":["Order"]}]},{"value":["."]},{"r":"530","s":[{"value":["supply"]}]}]},{"value":["."]},{"r":"531","s":[{"value":["value"]}]}]},{"value":[" /"]},{"r":"538","s":[{"value":["("]},{"r":"538","s":[{"r":"534","s":[{"r":"533","s":[{"r":"532","s":[{"value":["Order"]}]},{"value":["."]},{"r":"533","s":[{"value":["dosage"]}]}]},{"value":["."]},{"r":"534","s":[{"value":["value"]}]}]},{"value":[" * "]},{"r":"537","s":[{"value":["ToDaily","("]},{"r":"536","s":[{"r":"535","s":[{"value":["Order"]}]},{"value":["."]},{"r":"536","s":[{"value":["frequency"]}]}]},{"value":[")"]}]}]},{"value":[")"]}]}]},{"value":[")"]}]},{"value":[" * "]},{"r":"546","s":[{"value":["( "]},{"r":"546","s":[{"r":"541","value":["1"," + "]},{"r":"545","s":[{"value":["Coalesce","("]},{"r":"543","s":[{"r":"542","s":[{"value":["Order"]}]},{"value":["."]},{"r":"543","s":[{"value":["refills"]}]}]},{"r":"544","value":[", ","0",")"]}]}]},{"value":[" )"]}]}]}]}]},{"value":["\n    "]},{"r":"577","s":[{"value":["return "]},{"r":"576","s":[{"value":["if "]},{"r":"550","s":[{"r":"549","s":[{"value":["startDate"]}]},{"value":[" is null"]}]},{"r":"551","value":[" then ","null"," \n      else "]},{"r":"575","s":[{"value":["if "]},{"r":"553","s":[{"r":"552","s":[{"value":["totalDaysSupplied"]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"562","s":[{"value":["Interval["]},{"r":"554","s":[{"value":["startDate"]}]},{"value":[", "]},{"r":"561","s":[{"r":"555","s":[{"value":["startDate"]}]},{"value":[" + "]},{"r":"560","s":[{"value":["Quantity"," { "]},{"s":[{"value":["value",": "]},{"r":"558","s":[{"r":"556","s":[{"value":["totalDaysSupplied"]}]},{"r":"557","value":[" - ","1"]}]}]},{"value":[", "]},{"s":[{"value":["unit",": "]},{"r":"559","s":[{"value":["'day'"]}]}]},{"value":[" }"]}]}]},{"value":["]"]}]},{"value":["\n      else "]},{"r":"574","s":[{"value":["if "]},{"r":"566","s":[{"r":"565","s":[{"r":"564","s":[{"r":"563","s":[{"value":["Order"]}]},{"value":["."]},{"r":"564","s":[{"value":["relevantPeriod"]}]}]},{"value":["."]},{"r":"565","s":[{"value":["high"]}]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"572","s":[{"value":["Interval["]},{"r":"567","s":[{"value":["startDate"]}]},{"value":[", "]},{"r":"571","s":[{"value":["date from "]},{"r":"570","s":[{"value":["end of "]},{"r":"569","s":[{"r":"568","s":[{"value":["Order"]}]},{"value":["."]},{"r":"569","s":[{"value":["relevantPeriod"]}]}]}]}]},{"value":["]"]}]},{"r":"573","value":["\n      else ","null"]}]}]}]}]}]}]}]}}],"expression":{"localId":"578","locator":"219:3-225:15","type":"Query","source":[{"localId":"518","locator":"219:3-219:16","alias":"Order","expression":{"localId":"517","locator":"219:3-219:10","name":"MedOrder","type":"OperandRef"}}],"let":[{"localId":"526","locator":"220:9-220:85","identifier":"startDate","expression":{"localId":"525","locator":"220:20-220:85","type":"DateFrom","operand":{"localId":"524","locator":"220:30-220:85","type":"Coalesce","operand":[{"localId":"521","locator":"220:39-220:62","path":"low","type":"Property","source":{"localId":"520","locator":"220:39-220:58","path":"relevantPeriod","scope":"Order","type":"Property"}},{"localId":"523","locator":"220:65-220:84","path":"authorDatetime","scope":"Order","type":"Property"}]}}},{"localId":"548","locator":"221:5-221:157","identifier":"totalDaysSupplied","expression":{"localId":"547","locator":"221:24-221:157","type":"Multiply","operand":[{"localId":"540","locator":"221:24-221:120","type":"Coalesce","operand":[{"type":"ToDecimal","operand":{"localId":"528","locator":"221:33-221:50","path":"daysSupplied","scope":"Order","type":"Property"}},{"localId":"539","locator":"221:53-221:119","type":"Divide","operand":[{"localId":"531","locator":"221:53-221:70","path":"value","type":"Property","source":{"localId":"530","locator":"221:53-221:64","path":"supply","scope":"Order","type":"Property"}},{"localId":"538","locator":"221:73-221:119","type":"Multiply","operand":[{"localId":"534","locator":"221:74-221:91","path":"value","type":"Property","source":{"localId":"533","locator":"221:74-221:85","path":"dosage","scope":"Order","type":"Property"}},{"localId":"537","locator":"221:95-221:118","name":"ToDaily","type":"FunctionRef","operand":[{"type":"As","operand":{"localId":"536","locator":"221:103-221:117","path":"frequency","scope":"Order","type":"Property"},"asTypeSpecifier":{"type":"ChoiceTypeSpecifier","choice":[{"name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"},{"name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}]}}]}]}]}]},{"type":"ToDecimal","operand":{"localId":"546","locator":"221:124-221:157","type":"Add","operand":[{"localId":"541","locator":"221:126","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"},{"localId":"545","locator":"221:130-221:155","type":"Coalesce","operand":[{"localId":"543","locator":"221:139-221:151","path":"refills","scope":"Order","type":"Property"},{"localId":"544","locator":"221:154","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"0","type":"Literal"}]}]}}]}}],"relationship":[],"return":{"localId":"577","locator":"222:5-225:15","expression":{"localId":"576","locator":"222:12-225:15","type":"If","condition":{"localId":"550","locator":"222:15-222:31","type":"IsNull","operand":{"localId":"549","locator":"222:15-222:23","name":"startDate","type":"QueryLetRef"}},"then":{"type":"As","operand":{"localId":"551","locator":"222:38-222:41","type":"Null"},"asTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}},"else":{"localId":"575","locator":"223:12-225:15","type":"If","condition":{"localId":"553","locator":"223:15-223:43","type":"Not","operand":{"locator":"223:15-223:43","type":"IsNull","operand":{"localId":"552","locator":"223:15-223:31","name":"totalDaysSupplied","type":"QueryLetRef"}}},"then":{"localId":"562","locator":"223:50-223:136","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"554","locator":"223:59-223:67","name":"startDate","type":"QueryLetRef"},"high":{"localId":"561","locator":"223:70-223:135","type":"Add","operand":[{"localId":"555","locator":"223:70-223:78","name":"startDate","type":"QueryLetRef"},{"localId":"560","locator":"223:82-223:135","classType":"{urn:hl7-org:elm-types:r1}Quantity","type":"Instance","element":[{"name":"value","value":{"localId":"558","locator":"223:100-223:120","type":"Subtract","operand":[{"localId":"556","locator":"223:100-223:116","name":"totalDaysSupplied","type":"QueryLetRef"},{"type":"ToDecimal","operand":{"localId":"557","locator":"223:120","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}}]}},{"name":"unit","value":{"localId":"559","locator":"223:129-223:133","valueType":"{urn:hl7-org:elm-types:r1}String","value":"day","type":"Literal"}}]}]}},"else":{"localId":"574","locator":"224:12-225:15","type":"If","condition":{"localId":"566","locator":"224:15-224:51","type":"Not","operand":{"locator":"224:15-224:51","type":"IsNull","operand":{"localId":"565","locator":"224:15-224:39","path":"high","type":"Property","source":{"localId":"564","locator":"224:15-224:34","path":"relevantPeriod","scope":"Order","type":"Property"}}}},"then":{"localId":"572","locator":"224:58-224:115","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"567","locator":"224:67-224:75","name":"startDate","type":"QueryLetRef"},"high":{"localId":"571","locator":"224:78-224:114","type":"DateFrom","operand":{"localId":"570","locator":"224:88-224:114","type":"End","operand":{"localId":"569","locator":"224:95-224:114","path":"relevantPeriod","scope":"Order","type":"Property"}}}},"else":{"type":"As","operand":{"localId":"573","locator":"225:12-225:15","type":"Null"},"asTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}}}}},"operand":[{"name":"MedOrder","operandTypeSpecifier":{"localId":"516","locator":"218:50-218:68","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationOrder","type":"NamedTypeSpecifier"}}]},{"localId":"640","locator":"204:1-211:15","name":"MedicationDispensedPeriod","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Calculates Medication Period for a given Medication, Dispensed"},{"name":"description","value":"Calculates Medication Period for a given Medication, Dispensed"},{"name":"comment","value":"This function calculates the effective duration of a single medication dispensing event using the following approach:  If `daysSupplied` element is present, the duration is `daysSupplied`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency))`. The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `relevantDatetime` to `relevantDatetime + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL."},{"name":"seealso","value":"[CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary."}],"s":{"r":"640","s":[{"value":["/*@description: Calculates Medication Period for a given Medication, Dispensed\n  @comment: This function calculates the effective duration of a single medication dispensing event using the following approach:  If `daysSupplied` element is present, the duration is `daysSupplied`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency))`. The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `relevantDatetime` to `relevantDatetime + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary.*/\n","define function ","\"MedicationDispensedPeriod\"","(","MedDispense"," "]},{"r":"582","s":[{"value":["\"Medication, Dispensed\""]}]},{"value":[" ):\n  "]},{"r":"639","s":[{"r":"639","s":[{"s":[{"r":"584","s":[{"r":"583","s":[{"s":[{"value":["MedDispense"]}]}]},{"value":[" ","Dispense"]}]}]},{"value":["\n    "]},{"s":[{"value":["let "]},{"r":"594","s":[{"value":["startDate",": "]},{"r":"593","s":[{"value":["date from "]},{"r":"592","s":[{"value":["Coalesce","("]},{"r":"587","s":[{"r":"586","s":[{"r":"585","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"586","s":[{"value":["relevantPeriod"]}]}]},{"value":["."]},{"r":"587","s":[{"value":["low"]}]}]},{"value":[", "]},{"r":"589","s":[{"r":"588","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"589","s":[{"value":["relevantDatetime"]}]}]},{"value":[", "]},{"r":"591","s":[{"r":"590","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"591","s":[{"value":["authorDatetime"]}]}]},{"value":[")"]}]}]}]},{"value":[",\n    "]},{"r":"609","s":[{"value":["totalDaysSupplied",": "]},{"r":"608","s":[{"value":["Coalesce","("]},{"r":"596","s":[{"r":"595","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"596","s":[{"value":["daysSupplied"]}]}]},{"value":[", "]},{"r":"607","s":[{"r":"599","s":[{"r":"598","s":[{"r":"597","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"598","s":[{"value":["supply"]}]}]},{"value":["."]},{"r":"599","s":[{"value":["value"]}]}]},{"value":[" /"]},{"r":"606","s":[{"value":["("]},{"r":"606","s":[{"r":"602","s":[{"r":"601","s":[{"r":"600","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"601","s":[{"value":["dosage"]}]}]},{"value":["."]},{"r":"602","s":[{"value":["value"]}]}]},{"value":[" * "]},{"r":"605","s":[{"value":["ToDaily","("]},{"r":"604","s":[{"r":"603","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"604","s":[{"value":["frequency"]}]}]},{"value":[")"]}]}]},{"value":[")"]}]}]},{"value":[")"]}]}]}]},{"value":["\n    "]},{"r":"638","s":[{"value":["return "]},{"r":"637","s":[{"value":["if "]},{"r":"611","s":[{"r":"610","s":[{"value":["startDate"]}]},{"value":[" is null"]}]},{"r":"612","value":[" then ","null"," \n      else "]},{"r":"636","s":[{"value":["if "]},{"r":"614","s":[{"r":"613","s":[{"value":["totalDaysSupplied"]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"623","s":[{"value":["Interval["]},{"r":"615","s":[{"value":["startDate"]}]},{"value":[", "]},{"r":"622","s":[{"r":"616","s":[{"value":["startDate"]}]},{"value":[" + "]},{"r":"621","s":[{"value":["Quantity"," { "]},{"s":[{"value":["value",": "]},{"r":"619","s":[{"r":"617","s":[{"value":["totalDaysSupplied"]}]},{"r":"618","value":[" - ","1"]}]}]},{"value":[", "]},{"s":[{"value":["unit",": "]},{"r":"620","s":[{"value":["'day'"]}]}]},{"value":[" }"]}]}]},{"value":["]"]}]},{"value":["\n      else "]},{"r":"635","s":[{"value":["if "]},{"r":"627","s":[{"r":"626","s":[{"r":"625","s":[{"r":"624","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"625","s":[{"value":["relevantPeriod"]}]}]},{"value":["."]},{"r":"626","s":[{"value":["high"]}]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"633","s":[{"value":["Interval["]},{"r":"628","s":[{"value":["startDate"]}]},{"value":[", "]},{"r":"632","s":[{"value":["date from "]},{"r":"631","s":[{"value":["end of "]},{"r":"630","s":[{"r":"629","s":[{"value":["Dispense"]}]},{"value":["."]},{"r":"630","s":[{"value":["relevantPeriod"]}]}]}]}]},{"value":["]"]}]},{"r":"634","value":["\n      else ","null"]}]}]}]}]}]}]}]}}],"expression":{"localId":"639","locator":"205:3-211:15","type":"Query","source":[{"localId":"584","locator":"205:3-205:22","alias":"Dispense","expression":{"localId":"583","locator":"205:3-205:13","name":"MedDispense","type":"OperandRef"}}],"let":[{"localId":"594","locator":"206:9-206:118","identifier":"startDate","expression":{"localId":"593","locator":"206:20-206:118","type":"DateFrom","operand":{"localId":"592","locator":"206:30-206:118","type":"Coalesce","operand":[{"localId":"587","locator":"206:39-206:65","path":"low","type":"Property","source":{"localId":"586","locator":"206:39-206:61","path":"relevantPeriod","scope":"Dispense","type":"Property"}},{"localId":"589","locator":"206:68-206:92","path":"relevantDatetime","scope":"Dispense","type":"Property"},{"localId":"591","locator":"206:95-206:117","path":"authorDatetime","scope":"Dispense","type":"Property"}]}}},{"localId":"609","locator":"207:5-207:132","identifier":"totalDaysSupplied","expression":{"localId":"608","locator":"207:24-207:132","type":"Coalesce","operand":[{"type":"ToDecimal","operand":{"localId":"596","locator":"207:33-207:53","path":"daysSupplied","scope":"Dispense","type":"Property"}},{"localId":"607","locator":"207:56-207:131","type":"Divide","operand":[{"localId":"599","locator":"207:56-207:76","path":"value","type":"Property","source":{"localId":"598","locator":"207:56-207:70","path":"supply","scope":"Dispense","type":"Property"}},{"localId":"606","locator":"207:79-207:131","type":"Multiply","operand":[{"localId":"602","locator":"207:80-207:100","path":"value","type":"Property","source":{"localId":"601","locator":"207:80-207:94","path":"dosage","scope":"Dispense","type":"Property"}},{"localId":"605","locator":"207:104-207:130","name":"ToDaily","type":"FunctionRef","operand":[{"type":"As","operand":{"localId":"604","locator":"207:112-207:129","path":"frequency","scope":"Dispense","type":"Property"},"asTypeSpecifier":{"type":"ChoiceTypeSpecifier","choice":[{"name":"{urn:hl7-org:elm-types:r1}Quantity","type":"NamedTypeSpecifier"},{"name":"{urn:hl7-org:elm-types:r1}Code","type":"NamedTypeSpecifier"}]}}]}]}]}]}}],"relationship":[],"return":{"localId":"638","locator":"208:5-211:15","expression":{"localId":"637","locator":"208:12-211:15","type":"If","condition":{"localId":"611","locator":"208:15-208:31","type":"IsNull","operand":{"localId":"610","locator":"208:15-208:23","name":"startDate","type":"QueryLetRef"}},"then":{"type":"As","operand":{"localId":"612","locator":"208:38-208:41","type":"Null"},"asTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}},"else":{"localId":"636","locator":"209:12-211:15","type":"If","condition":{"localId":"614","locator":"209:15-209:43","type":"Not","operand":{"locator":"209:15-209:43","type":"IsNull","operand":{"localId":"613","locator":"209:15-209:31","name":"totalDaysSupplied","type":"QueryLetRef"}}},"then":{"localId":"623","locator":"209:50-209:136","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"615","locator":"209:59-209:67","name":"startDate","type":"QueryLetRef"},"high":{"localId":"622","locator":"209:70-209:135","type":"Add","operand":[{"localId":"616","locator":"209:70-209:78","name":"startDate","type":"QueryLetRef"},{"localId":"621","locator":"209:82-209:135","classType":"{urn:hl7-org:elm-types:r1}Quantity","type":"Instance","element":[{"name":"value","value":{"localId":"619","locator":"209:100-209:120","type":"Subtract","operand":[{"localId":"617","locator":"209:100-209:116","name":"totalDaysSupplied","type":"QueryLetRef"},{"type":"ToDecimal","operand":{"localId":"618","locator":"209:120","valueType":"{urn:hl7-org:elm-types:r1}Integer","value":"1","type":"Literal"}}]}},{"name":"unit","value":{"localId":"620","locator":"209:129-209:133","valueType":"{urn:hl7-org:elm-types:r1}String","value":"day","type":"Literal"}}]}]}},"else":{"localId":"635","locator":"210:12-211:15","type":"If","condition":{"localId":"627","locator":"210:15-210:54","type":"Not","operand":{"locator":"210:15-210:54","type":"IsNull","operand":{"localId":"626","locator":"210:15-210:42","path":"high","type":"Property","source":{"localId":"625","locator":"210:15-210:37","path":"relevantPeriod","scope":"Dispense","type":"Property"}}}},"then":{"localId":"633","locator":"210:61-210:121","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"628","locator":"210:70-210:78","name":"startDate","type":"QueryLetRef"},"high":{"localId":"632","locator":"210:81-210:120","type":"DateFrom","operand":{"localId":"631","locator":"210:91-210:120","type":"End","operand":{"localId":"630","locator":"210:98-210:120","path":"relevantPeriod","scope":"Dispense","type":"Property"}}}},"else":{"type":"As","operand":{"localId":"634","locator":"211:12-211:15","type":"Null"},"asTypeSpecifier":{"type":"IntervalTypeSpecifier","pointType":{"name":"{urn:hl7-org:elm-types:r1}Date","type":"NamedTypeSpecifier"}}}}}}}},"operand":[{"name":"MedDispense","operandTypeSpecifier":{"localId":"582","locator":"204:57-204:79","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","type":"NamedTypeSpecifier"}}]},{"localId":"647","locator":"166:1-176:6","name":"MedicationPeriod","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Calculates the effective duration of the given medication event, whether it is an order, dispense, discharge, or administration. Note that this function is still under development and should not be used.*/"},{"name":"description","value":"Calculates the effective duration of the given medication event, whether it is an order, dispense, discharge, or administration. Note that this function is still under development and should not be used.*/"}],"s":{"r":"647","s":[{"value":["/*@description: Calculates the effective duration of the given medication event, whether it is an order, dispense, discharge, or administration. Note that this function is still under development and should not be used.*/\n","define function ","\"MedicationPeriod\"","(","Medication"," "]},{"r":"514","s":[{"value":["Choice\u003c"]},{"r":"510","s":[{"value":["\"Medication, Order\""]}]},{"value":[",\n       "]},{"r":"511","s":[{"value":["\"Medication, Dispensed\""]}]},{"value":[",\n       "]},{"r":"512","s":[{"value":["\"Medication, Discharge\""]}]},{"value":[",\n       "]},{"r":"513","s":[{"value":["\"Medication, Administered\""]}]},{"value":["\n     \u003e"]}]},{"value":[" ):\n  "]},{"r":"646","s":[{"r":"646","s":[{"value":["Coalesce","(\n       "]},{"r":"580","s":[{"value":["MedicationOrderPeriod","("]},{"r":"515","s":[{"value":["Medication"]}]},{"value":[")"]}]},{"value":[",\n       "]},{"r":"641","s":[{"value":["MedicationDispensedPeriod","("]},{"r":"581","s":[{"value":["Medication"]}]},{"value":[")"]}]},{"value":[",\n       "]},{"r":"643","s":[{"value":["MedicationDischargePeriod","("]},{"r":"642","s":[{"value":["Medication"]}]},{"value":[")"]}]},{"value":[",\n       "]},{"r":"645","s":[{"value":["MedicationAdministrationPeriod","("]},{"r":"644","s":[{"value":["Medication"]}]},{"value":[")"]}]},{"value":["\n     )"]}]}]}]}}],"expression":{"localId":"646","locator":"171:3-176:6","type":"Coalesce","operand":[{"localId":"580","locator":"172:8-172:40","name":"MedicationOrderPeriod","type":"FunctionRef","operand":[{"asType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationOrder","type":"As","operand":{"localId":"515","locator":"172:30-172:39","name":"Medication","type":"OperandRef"}}]},{"localId":"641","locator":"173:8-173:44","name":"MedicationDispensedPeriod","type":"FunctionRef","operand":[{"asType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","type":"As","operand":{"localId":"581","locator":"173:34-173:43","name":"Medication","type":"OperandRef"}}]},{"localId":"643","locator":"174:8-174:44","name":"MedicationDischargePeriod","type":"FunctionRef","operand":[{"asType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDischarge","type":"As","operand":{"localId":"642","locator":"174:34-174:43","name":"Medication","type":"OperandRef"}}]},{"localId":"645","locator":"175:8-175:49","name":"MedicationAdministrationPeriod","type":"FunctionRef","operand":[{"asType":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationAdministered","type":"As","operand":{"localId":"644","locator":"175:39-175:48","name":"Medication","type":"OperandRef"}}]}]},"operand":[{"name":"Medication","operandTypeSpecifier":{"localId":"514","locator":"166:47-170:6","type":"ChoiceTypeSpecifier","choice":[{"localId":"510","locator":"166:54-166:72","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationOrder","type":"NamedTypeSpecifier"},{"localId":"511","locator":"167:8-167:30","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","type":"NamedTypeSpecifier"},{"localId":"512","locator":"168:8-168:30","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDischarge","type":"NamedTypeSpecifier"},{"localId":"513","locator":"169:8-169:33","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationAdministered","type":"NamedTypeSpecifier"}]}}]},{"localId":"683","locator":"180:1-197:6","name":"CalculateCumulativeMedicationDuration","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Calculates the cumulative medication duration of the given medication events"},{"name":"description","value":"Calculates the cumulative medication duration of the given medication events"},{"name":"comment","value":"This function will _roll out_ periods from dispense and administration events, and then collapse across that result and periods from prescriptions. The separation of medications by type should already be done prior to using this function. In addition, calculations that combine dosages from different types of medications (such as Morphine Milligram Equivalent (MME)) require further consideration. Note that this function is still under development and should not be used."}],"s":{"r":"683","s":[{"value":["/*@description: Calculates the cumulative medication duration of the given medication events\n  @comment: This function will _roll out_ periods from dispense and administration events, and then collapse across that result and periods from prescriptions. The separation of medications by type should already be done prior to using this function. In addition, calculations that combine dosages from different types of medications (such as Morphine Milligram Equivalent (MME)) require further consideration. Note that this function is still under development and should not be used.*/\n","define function ","\"CalculateCumulativeMedicationDuration\"","(","Medications"," "]},{"r":"653","s":[{"value":["List\u003c"]},{"r":"652","s":[{"value":["Choice\u003c"]},{"r":"648","s":[{"value":["\"Medication, Order\""]}]},{"value":[",\n       "]},{"r":"649","s":[{"value":["\"Medication, Dispensed\""]}]},{"value":[",\n       "]},{"r":"650","s":[{"value":["\"Medication, Discharge\""]}]},{"value":[",\n       "]},{"r":"651","s":[{"value":["\"Medication, Administered\""]}]},{"value":["\n     \u003e"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"682","s":[{"r":"682","s":[{"value":["CumulativeDuration","("]},{"r":"681","s":[{"r":"666","s":[{"value":["(\n         "]},{"r":"666","s":[{"s":[{"r":"655","s":[{"r":"654","s":[{"s":[{"value":["Medications"]}]}]},{"value":[" ","M"]}]}]},{"value":["\n           "]},{"r":"662","s":[{"value":["where "]},{"r":"662","s":[{"r":"658","s":[{"r":"656","s":[{"value":["M"]}]},{"value":[" is "]},{"r":"657","s":[{"value":["\"Medication, Order\""]}]}]},{"value":[" or "]},{"r":"661","s":[{"r":"659","s":[{"value":["M"]}]},{"value":[" is "]},{"r":"660","s":[{"value":["\"Medication, Discharge\""]}]}]}]}]},{"value":["\n           "]},{"r":"665","s":[{"value":["return "]},{"r":"664","s":[{"value":["MedicationPeriod","("]},{"r":"663","s":[{"value":["M"]}]},{"value":[")"]}]}]}]},{"value":["\n       )"]}]},{"value":["\n         union "]},{"r":"680","s":[{"value":["(\n           "]},{"r":"680","s":[{"value":["RolloutIntervals","(\n             "]},{"r":"679","s":[{"s":[{"r":"668","s":[{"r":"667","s":[{"s":[{"value":["Medications"]}]}]},{"value":[" ","M"]}]}]},{"value":["\n               "]},{"r":"675","s":[{"value":["where "]},{"r":"675","s":[{"r":"671","s":[{"r":"669","s":[{"value":["M"]}]},{"value":[" is "]},{"r":"670","s":[{"value":["\"Medication, Dispensed\""]}]}]},{"value":[" or "]},{"r":"674","s":[{"r":"672","s":[{"value":["M"]}]},{"value":[" is "]},{"r":"673","s":[{"value":["\"Medication, Administered\""]}]}]}]}]},{"value":["\n               "]},{"r":"678","s":[{"value":["return "]},{"r":"677","s":[{"value":["MedicationPeriod","("]},{"r":"676","s":[{"value":["M"]}]},{"value":[")"]}]}]}]},{"value":["\n           )"]}]},{"value":["\n         )"]}]}]},{"value":["\n     )"]}]}]}]}}],"expression":{"localId":"682","locator":"185:3-197:6","name":"CumulativeDuration","type":"FunctionRef","operand":[{"localId":"681","locator":"185:22-196:10","type":"Union","operand":[{"localId":"666","locator":"185:22-189:8","type":"Query","source":[{"localId":"655","locator":"186:10-186:22","alias":"M","expression":{"localId":"654","locator":"186:10-186:20","name":"Medications","type":"OperandRef"}}],"relationship":[],"where":{"localId":"662","locator":"187:12-187:73","type":"Or","operand":[{"localId":"658","locator":"187:18-187:41","type":"Is","operand":{"localId":"656","locator":"187:18","name":"M","type":"AliasRef"},"isTypeSpecifier":{"localId":"657","locator":"187:23-187:41","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationOrder","type":"NamedTypeSpecifier"}},{"localId":"661","locator":"187:46-187:73","type":"Is","operand":{"localId":"659","locator":"187:46","name":"M","type":"AliasRef"},"isTypeSpecifier":{"localId":"660","locator":"187:51-187:73","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDischarge","type":"NamedTypeSpecifier"}}]},"return":{"localId":"665","locator":"188:12-188:37","expression":{"localId":"664","locator":"188:19-188:37","name":"MedicationPeriod","type":"FunctionRef","operand":[{"localId":"663","locator":"188:36","name":"M","type":"AliasRef"}]}}},{"localId":"680","locator":"190:16-196:10","name":"RolloutIntervals","type":"FunctionRef","operand":[{"localId":"679","locator":"192:14-194:41","type":"Query","source":[{"localId":"668","locator":"192:14-192:26","alias":"M","expression":{"localId":"667","locator":"192:14-192:24","name":"Medications","type":"OperandRef"}}],"relationship":[],"where":{"localId":"675","locator":"193:16-193:84","type":"Or","operand":[{"localId":"671","locator":"193:22-193:49","type":"Is","operand":{"localId":"669","locator":"193:22","name":"M","type":"AliasRef"},"isTypeSpecifier":{"localId":"670","locator":"193:27-193:49","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","type":"NamedTypeSpecifier"}},{"localId":"674","locator":"193:54-193:84","type":"Is","operand":{"localId":"672","locator":"193:54","name":"M","type":"AliasRef"},"isTypeSpecifier":{"localId":"673","locator":"193:59-193:84","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationAdministered","type":"NamedTypeSpecifier"}}]},"return":{"localId":"678","locator":"194:16-194:41","expression":{"localId":"677","locator":"194:23-194:41","name":"MedicationPeriod","type":"FunctionRef","operand":[{"localId":"676","locator":"194:40","name":"M","type":"AliasRef"}]}}}]}]}]},"operand":[{"name":"Medications","operandTypeSpecifier":{"localId":"653","locator":"180:69-184:7","type":"ListTypeSpecifier","elementType":{"localId":"652","locator":"180:74-184:6","type":"ChoiceTypeSpecifier","choice":[{"localId":"648","locator":"180:81-180:99","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationOrder","type":"NamedTypeSpecifier"},{"localId":"649","locator":"181:8-181:30","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDispensed","type":"NamedTypeSpecifier"},{"localId":"650","locator":"182:8-182:30","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationDischarge","type":"NamedTypeSpecifier"},{"localId":"651","locator":"183:8-183:33","name":"{urn:healthit-gov:qdm:v5_6}PositiveMedicationAdministered","type":"NamedTypeSpecifier"}]}}}]}]}}},"elm_annotations":{"statements":[{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Converts a frequency quantity to a daily frequency (as a decimal)\n@comment: This function considers both the value and unit of the given frequency. E.g. the frequency `30 'min'` will result in a daily frequency of `48.0`*/\ndefine function \"QuantityToDaily\"(Frequency "}]},{"children":[{"children":[{"text":"Quantity"}]}],"ref_id":"48"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"case "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"49"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"unit"}]}],"ref_id":"50"}],"ref_id":"50"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'h'"}]}],"ref_id":"51"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"52"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"53"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"54"}],"node_type":"Property","ref_id":"54"}],"ref_id":"55"},{"children":[{"text":")"}]}],"ref_id":"55"}],"ref_id":"56"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'min'"}]}],"ref_id":"57"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"58"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"59"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"60"}],"node_type":"Property","ref_id":"60"}],"node_type":"Divide","ref_id":"61"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"61"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"62"}],"ref_id":"63"}],"ref_id":"64"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'s'"}]}],"ref_id":"65"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"66"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"67"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"68"}],"node_type":"Property","ref_id":"68"}],"node_type":"Divide","ref_id":"69"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"69"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"70"}],"node_type":"Multiply","ref_id":"71"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"72"}],"ref_id":"73"}],"ref_id":"74"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'d'"}]}],"ref_id":"75"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"76"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"77"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"78"}],"node_type":"Property","ref_id":"78"}],"node_type":"Divide","ref_id":"79"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"79"},{"children":[{"text":" / 24"}],"node_type":"Literal","ref_id":"80"}],"ref_id":"81"}],"ref_id":"82"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'wk'"}]}],"ref_id":"83"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"84"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"85"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"86"}],"node_type":"Property","ref_id":"86"}],"node_type":"Divide","ref_id":"87"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"87"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 7"}],"node_type":"Literal","ref_id":"88"}],"node_type":"Multiply","ref_id":"90"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"90"}],"ref_id":"91"}],"ref_id":"92"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'mo'"}]}],"ref_id":"93"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"94"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"95"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"96"}],"node_type":"Property","ref_id":"96"}],"node_type":"Divide","ref_id":"97"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"97"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 30"}],"node_type":"Literal","ref_id":"98"}],"node_type":"Multiply","ref_id":"100"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"100"}],"ref_id":"101"}],"ref_id":"102"},{"children":[{"text":" /* assuming 30 days in month */\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'a'"}]}],"ref_id":"103"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"104"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"105"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"106"}],"node_type":"Property","ref_id":"106"}],"node_type":"Divide","ref_id":"107"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"107"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 365"}],"node_type":"Literal","ref_id":"108"}],"node_type":"Multiply","ref_id":"110"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"110"}],"ref_id":"111"}],"ref_id":"112"},{"children":[{"text":" /* assuming 365 days in year */\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'hour'"}]}],"ref_id":"113"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"114"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"115"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"116"}],"node_type":"Property","ref_id":"116"}],"ref_id":"117"},{"children":[{"text":")"}]}],"ref_id":"117"}],"ref_id":"118"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'minute'"}]}],"ref_id":"119"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"120"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"121"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"122"}],"node_type":"Property","ref_id":"122"}],"node_type":"Divide","ref_id":"123"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"123"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"124"}],"ref_id":"125"}],"ref_id":"126"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'second'"}]}],"ref_id":"127"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"128"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"129"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"130"}],"node_type":"Property","ref_id":"130"}],"node_type":"Divide","ref_id":"131"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"131"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"132"}],"node_type":"Multiply","ref_id":"133"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"134"}],"ref_id":"135"}],"ref_id":"136"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'day'"}]}],"ref_id":"137"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"138"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"139"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"140"}],"node_type":"Property","ref_id":"140"}],"node_type":"Divide","ref_id":"141"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"141"},{"children":[{"text":" / 24"}],"node_type":"Literal","ref_id":"142"}],"ref_id":"143"}],"ref_id":"144"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'week'"}]}],"ref_id":"145"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"146"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"147"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"148"}],"node_type":"Property","ref_id":"148"}],"node_type":"Divide","ref_id":"149"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"149"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 7"}],"node_type":"Literal","ref_id":"150"}],"node_type":"Multiply","ref_id":"152"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"152"}],"ref_id":"153"}],"ref_id":"154"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'month'"}]}],"ref_id":"155"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"156"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"157"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"158"}],"node_type":"Property","ref_id":"158"}],"node_type":"Divide","ref_id":"159"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"159"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 30"}],"node_type":"Literal","ref_id":"160"}],"node_type":"Multiply","ref_id":"162"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"162"}],"ref_id":"163"}],"ref_id":"164"},{"children":[{"text":" /* assuming 30 days in month */\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'year'"}]}],"ref_id":"165"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"166"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"167"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"168"}],"node_type":"Property","ref_id":"168"}],"node_type":"Divide","ref_id":"169"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"169"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 365"}],"node_type":"Literal","ref_id":"170"}],"node_type":"Multiply","ref_id":"172"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"172"}],"ref_id":"173"}],"ref_id":"174"},{"children":[{"text":" /* assuming 365 days in year */\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'hours'"}]}],"ref_id":"175"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"176"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"177"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"178"}],"node_type":"Property","ref_id":"178"}],"ref_id":"179"},{"children":[{"text":")"}]}],"ref_id":"179"}],"ref_id":"180"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'minutes'"}]}],"ref_id":"181"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"182"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"183"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"184"}],"node_type":"Property","ref_id":"184"}],"node_type":"Divide","ref_id":"185"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"185"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"186"}],"ref_id":"187"}],"ref_id":"188"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'seconds'"}]}],"ref_id":"189"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"190"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"191"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"192"}],"node_type":"Property","ref_id":"192"}],"node_type":"Divide","ref_id":"193"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"193"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"194"}],"node_type":"Multiply","ref_id":"195"},{"children":[{"text":" * 60"}],"node_type":"Literal","ref_id":"196"}],"ref_id":"197"}],"ref_id":"198"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'days'"}]}],"ref_id":"199"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"200"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"201"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"202"}],"node_type":"Property","ref_id":"202"}],"node_type":"Divide","ref_id":"203"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"203"},{"children":[{"text":" / 24"}],"node_type":"Literal","ref_id":"204"}],"ref_id":"205"}],"ref_id":"206"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'weeks'"}]}],"ref_id":"207"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"208"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"209"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"210"}],"node_type":"Property","ref_id":"210"}],"node_type":"Divide","ref_id":"211"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"211"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 7"}],"node_type":"Literal","ref_id":"212"}],"node_type":"Multiply","ref_id":"214"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"214"}],"ref_id":"215"}],"ref_id":"216"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'months'"}]}],"ref_id":"217"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"218"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"219"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"220"}],"node_type":"Property","ref_id":"220"}],"node_type":"Divide","ref_id":"221"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"221"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 30"}],"node_type":"Literal","ref_id":"222"}],"node_type":"Multiply","ref_id":"224"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"224"}],"ref_id":"225"}],"ref_id":"226"},{"children":[{"text":" /* assuming 30 days in month */\n      "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"text":"'years'"}]}],"ref_id":"227"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24.0 / "}],"node_type":"Literal","ref_id":"228"},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"ref_id":"229"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"230"}],"node_type":"Property","ref_id":"230"}],"node_type":"Divide","ref_id":"231"},{"children":[{"text":")"}]}],"node_type":"Divide","ref_id":"231"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"24 * 365"}],"node_type":"Literal","ref_id":"232"}],"node_type":"Multiply","ref_id":"234"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"234"}],"ref_id":"235"}],"ref_id":"236"},{"children":[{"text":" /* assuming 365 days in year */\n      else null\n    end"}],"node_type":"Null","ref_id":"237"}],"node_type":"Case","ref_id":"238"}],"node_type":"Case","ref_id":"238"}],"ref_id":"239"}],"define_name":"QuantityToDaily"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Returns the equivalent daily frequency (as a decimal) of the given code\n@comment: Note that for ranges, the boundary resulting in the highest frequency result is used. E.g. `Every two to four hours` results in `12.0` and `One to two` times a day results in `2.0`.*/\ndefine function \"CodeToDaily\"(Frequency "}]},{"children":[{"children":[{"text":"Code"}]}],"ref_id":"240"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"case\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"241"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Once daily (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"242"}],"ref_id":"243"},{"children":[{"text":" then 1.0"}],"ref_id":"244"}],"ref_id":"245"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"246"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Twice a day (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"247"}],"ref_id":"248"},{"children":[{"text":" then 2.0"}],"ref_id":"249"}],"ref_id":"250"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"251"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Three times daily (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"252"}],"ref_id":"253"},{"children":[{"text":" then 3.0"}],"ref_id":"254"}],"ref_id":"255"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"256"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Four times daily (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"257"}],"ref_id":"258"},{"children":[{"text":" then 4.0"}],"ref_id":"259"}],"ref_id":"260"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"261"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every twenty four hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"262"}],"ref_id":"263"},{"children":[{"text":" then 1.0"}],"ref_id":"264"}],"ref_id":"265"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"266"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every twelve hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"267"}],"ref_id":"268"},{"children":[{"text":" then 2.0"}],"ref_id":"269"}],"ref_id":"270"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"271"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every thirty six hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"272"}],"ref_id":"273"},{"children":[{"text":" then 0.67"}],"ref_id":"274"}],"ref_id":"275"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"276"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every eight hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"277"}],"ref_id":"278"},{"children":[{"text":" then 3.0"}],"ref_id":"279"}],"ref_id":"280"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"281"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every four hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"282"}],"ref_id":"283"},{"children":[{"text":" then 6.0"}],"ref_id":"284"}],"ref_id":"285"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"286"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every six hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"287"}],"ref_id":"288"},{"children":[{"text":" then 4.0"}],"ref_id":"289"}],"ref_id":"290"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"291"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every seventy two hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"292"}],"ref_id":"293"},{"children":[{"text":" then 0.33"}],"ref_id":"294"}],"ref_id":"295"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"296"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every forty eight hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"297"}],"ref_id":"298"},{"children":[{"text":" then 0.5"}],"ref_id":"299"}],"ref_id":"300"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"301"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every eight to twelve hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"302"}],"ref_id":"303"},{"children":[{"text":" then 3.0"}],"ref_id":"304"}],"ref_id":"305"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"306"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every six to eight hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"307"}],"ref_id":"308"},{"children":[{"text":" then 4.0"}],"ref_id":"309"}],"ref_id":"310"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"311"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every three to four hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"312"}],"ref_id":"313"},{"children":[{"text":" then 8.0"}],"ref_id":"314"}],"ref_id":"315"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"316"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every three to six hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"317"}],"ref_id":"318"},{"children":[{"text":" then 8.0"}],"ref_id":"319"}],"ref_id":"320"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"321"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Every two to four hours (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"322"}],"ref_id":"323"},{"children":[{"text":" then 12.0"}],"ref_id":"324"}],"ref_id":"325"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"326"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"One to four times a day (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"327"}],"ref_id":"328"},{"children":[{"text":" then 4.0"}],"ref_id":"329"}],"ref_id":"330"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"331"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"One to three times a day (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"332"}],"ref_id":"333"},{"children":[{"text":" then 3.0"}],"ref_id":"334"}],"ref_id":"335"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"336"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"One to two times a day (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"337"}],"ref_id":"338"},{"children":[{"text":" then 2.0"}],"ref_id":"339"}],"ref_id":"340"},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"341"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Two to four times a day (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"342"}],"ref_id":"343"},{"children":[{"text":" then 4.0"}],"ref_id":"344"}],"ref_id":"345"},{"children":[{"text":"\n    else null\n  end"}],"node_type":"Null","ref_id":"346"}],"node_type":"Case","ref_id":"347"}],"node_type":"Case","ref_id":"347"}],"ref_id":"348"}],"define_name":"CodeToDaily"},{"children":[{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Returns the daily frequency (as a decimal) of the given input*/\ndefine function \"ToDaily\"(Frequency "}]},{"children":[{"children":[{"text":"Choice\u003c"}]},{"children":[{"children":[{"text":"Quantity"}]}],"ref_id":"349"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"Code"}]}],"ref_id":"350"},{"children":[{"text":"\u003e"}]}],"ref_id":"351"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"case\n    "}]},{"children":[{"children":[{"text":"when "}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"352"},{"children":[{"text":" is "}]},{"children":[{"children":[{"text":"Quantity"}]}],"ref_id":"353"}],"ref_id":"354"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"QuantityToDaily("}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"355"},{"children":[{"text":" as "}]},{"children":[{"children":[{"text":"Quantity"}]}],"ref_id":"356"}],"node_type":"As","ref_id":"357"},{"children":[{"text":")"}]}],"ref_id":"358"}],"ref_id":"359"},{"children":[{"text":"\n    else "}]},{"children":[{"children":[{"text":"CodeToDaily("}]},{"children":[{"children":[{"children":[{"text":"Frequency"}]}],"node_type":"OperandRef","ref_id":"360"},{"children":[{"text":" as "}]},{"children":[{"children":[{"text":"Code"}]}],"ref_id":"361"}],"node_type":"As","ref_id":"362"},{"children":[{"text":")"}]}],"ref_id":"363"},{"children":[{"text":"\n  end"}]}],"node_type":"Case","ref_id":"364"}],"node_type":"Case","ref_id":"364"}],"ref_id":"365"}],"define_name":"ToDaily"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Returns the established therapeutic duration for a given medication\n  @comment: This is likely measure specific, though could potentially be established for any drug and distributed as a CodeSystem supplement. Defaulting to 14 days here for illustration.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used.*/\ndefine function \"TherapeuticDuration\"(medication "}]},{"children":[{"children":[{"text":"Code"}]}],"ref_id":"366"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"14 days"}]}],"node_type":"Quantity","ref_id":"367"}],"node_type":"Quantity","ref_id":"367"}],"ref_id":"368"}],"define_name":"TherapeuticDuration"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Calculates Medication Period for a given Medication, Administration\n  @comment: This function calculates the effective duration of a single medication administration event using the following approach: If a TherapeuticDuration is defined for the medication, the result is the interval from the earliest of the `relevantDatetime` and `relevantPeriod` elements, to the end of the therapeutic duration.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that this function is still under development and should not be used.*/\ndefine function \"MedicationAdministrationPeriod\"(MedAdministration "}]},{"children":[{"children":[{"text":"\"Medication, Administered\""}]}],"ref_id":"369"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"MedAdministration"}]}]}],"node_type":"OperandRef","ref_id":"370"},{"children":[{"text":" Administration"}]}],"ref_id":"371"}]},{"children":[{"text":"\n       "}]},{"children":[{"children":[{"text":"let\n         "}]},{"children":[{"children":[{"text":"therapeuticDuration: "}]},{"children":[{"children":[{"text":"TherapeuticDuration("}]},{"children":[{"children":[{"children":[{"text":"Administration"}]}],"ref_id":"372"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"code"}]}],"node_type":"Property","ref_id":"373"}],"node_type":"Property","ref_id":"373"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"374"}],"ref_id":"375"},{"children":[{"text":",\n         "}]},{"children":[{"children":[{"text":"startDate: "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"376"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"EarliestOf("}]},{"children":[{"children":[{"children":[{"text":"Administration"}]}],"ref_id":"377"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"Property","ref_id":"378"}],"node_type":"Property","ref_id":"378"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"Administration"}]}],"ref_id":"379"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"380"}],"node_type":"Property","ref_id":"380"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"381"}],"node_type":"FunctionRef","ref_id":"381"}],"node_type":"DateFrom","ref_id":"382"}],"ref_id":"383"}]},{"children":[{"text":"\n       "}]},{"children":[{"children":[{"text":"return\n         "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"384"},{"children":[{"text":" is not null"}]}],"node_type":"Not","ref_id":"385"},{"children":[{"text":" and "}]},{"children":[{"children":[{"children":[{"text":"therapeuticDuration"}]}],"node_type":"QueryLetRef","ref_id":"386"},{"children":[{"text":" is not null"}]}],"node_type":"Not","ref_id":"387"}],"ref_id":"388"},{"children":[{"text":" then\n           "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"startDate"}]}],"ref_id":"389"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"390"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"therapeuticDuration"}]}],"node_type":"QueryLetRef","ref_id":"391"}],"node_type":"Add","ref_id":"392"},{"children":[{"text":" - 1"}],"node_type":"Literal","ref_id":"393"}],"ref_id":"394"},{"children":[{"text":"]"}]}],"ref_id":"395"},{"children":[{"text":"\n         else\n           null"}],"node_type":"Null","ref_id":"396"}],"node_type":"If","ref_id":"397"}],"ref_id":"398"}],"node_type":"Query","ref_id":"399"}],"node_type":"Query","ref_id":"399"}],"ref_id":"400"}],"define_name":"MedicationAdministrationPeriod"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Calculates the Medication Period for a Medication, Discharge\n@comment: This function calculates the effective duration of a single medication discharge event using the following approach: If the `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. Otherwise, the duration is calculated using `(supply / (dosage * frequency)) * (1 + refills)`. The result is then the interval from `authorDatetime` to `authorDatetime + daysSupplied`.\nNote that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n@seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\nNote that this function has not been tested.*/\ndefine function \"MedicationDischargePeriod\"(Medication "}]},{"children":[{"children":[{"text":"\"Medication, Discharge\""}]}],"ref_id":"401"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"(\n    "}]},{"children":[{"children":[{"children":[{"text":"Coalesce(\n      "}]},{"children":[{"children":[{"children":[{"text":"Medication"}]}],"ref_id":"402"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"daysSupplied"}]}],"node_type":"Property","ref_id":"403"}],"node_type":"Property","ref_id":"403"},{"children":[{"text":",\n      "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Medication"}]}],"ref_id":"404"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"supply"}]}],"ref_id":"405"}],"ref_id":"405"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"406"}],"node_type":"Property","ref_id":"406"},{"children":[{"text":" / "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Medication"}]}],"ref_id":"407"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"dosage"}]}],"ref_id":"408"}],"ref_id":"408"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"409"}],"node_type":"Property","ref_id":"409"},{"children":[{"text":" * "}]},{"children":[{"children":[{"text":"ToDaily("}]},{"children":[{"children":[{"children":[{"text":"Medication"}]}],"ref_id":"410"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"frequency"}]}],"node_type":"Property","ref_id":"411"}],"node_type":"Property","ref_id":"411"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"412"}],"node_type":"Multiply","ref_id":"413"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"413"}],"node_type":"Divide","ref_id":"414"},{"children":[{"text":"\n    )"}]}],"node_type":"Coalesce","ref_id":"415"},{"children":[{"text":" * "}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"1 + "}],"node_type":"Literal","ref_id":"416"},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"children":[{"text":"Medication"}]}],"ref_id":"417"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"refills"}]}],"node_type":"Property","ref_id":"418"}],"node_type":"Property","ref_id":"418"},{"children":[{"text":", 0)"}],"node_type":"Literal","ref_id":"419"}],"node_type":"Coalesce","ref_id":"420"}],"node_type":"Add","ref_id":"421"},{"children":[{"text":")"}]}],"node_type":"Add","ref_id":"421"}],"node_type":"Multiply","ref_id":"422"},{"children":[{"text":"\n  )"}]}],"node_type":"Multiply","ref_id":"422"},{"children":[{"text":" totalDaysSupplied"}]}],"ref_id":"423"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"startDate: "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"children":[{"text":"Medication"}]}],"ref_id":"424"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"authorDatetime"}]}],"node_type":"Property","ref_id":"425"}],"node_type":"Property","ref_id":"425"}],"node_type":"DateFrom","ref_id":"426"}],"ref_id":"427"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return\n      "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"428"},{"children":[{"text":" is not null"}]}],"node_type":"Not","ref_id":"429"},{"children":[{"text":" and "}]},{"children":[{"children":[{"children":[{"text":"totalDaysSupplied"}]}],"node_type":"AliasRef","ref_id":"430"},{"children":[{"text":" is not null"}]}],"node_type":"Not","ref_id":"431"}],"ref_id":"432"},{"children":[{"text":" then\n        "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"startDate"}]}],"ref_id":"433"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"434"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"Quantity { "}]},{"children":[{"children":[{"text":"value: "}]},{"children":[{"children":[{"children":[{"text":"totalDaysSupplied"}]}],"node_type":"AliasRef","ref_id":"435"},{"children":[{"text":" - 1"}],"node_type":"Literal","ref_id":"436"}],"ref_id":"437"}]},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"unit: "}]},{"children":[{"children":[{"text":"'day'"}]}],"ref_id":"438"}]},{"children":[{"text":" }"}]}],"node_type":"Instance","ref_id":"439"}],"ref_id":"440"},{"children":[{"text":"]"}]}],"ref_id":"441"},{"children":[{"text":"\n      else\n        null"}],"node_type":"Null","ref_id":"442"}],"node_type":"If","ref_id":"443"}],"ref_id":"444"}],"node_type":"Query","ref_id":"445"}],"node_type":"Query","ref_id":"445"}],"ref_id":"446"}],"define_name":"MedicationDischargePeriod"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Returns the total duration in days covered by the given periods\n  @comment: This function calculates the total duration in days covered by the given periods. If multiple periods in the input include the same day, that day is only counted once in the final result.*/\ndefine function \"CumulativeDuration\"(Intervals "}]},{"children":[{"children":[{"text":"List\u003c"}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"Date"}]}],"ref_id":"447"},{"children":[{"text":"\u003e"}]}],"ref_id":"448"},{"children":[{"text":"\u003e"}]}],"ref_id":"449"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"Intervals"}]}],"node_type":"OperandRef","ref_id":"450"},{"children":[{"text":" is not null"}]}],"ref_id":"451"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"text":"Sum("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"collapse "}]},{"children":[{"children":[{"text":"Intervals"}]}],"node_type":"OperandRef","ref_id":"452"},{"children":[{"text":" per day"}]}],"node_type":"Collapse","ref_id":"453"},{"children":[{"text":")"}]}],"node_type":"Collapse","ref_id":"453"},{"children":[{"text":"X"}]}],"ref_id":"454"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"return all"}]},{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"difference in days between "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"X"}]}],"node_type":"AliasRef","ref_id":"455"}],"node_type":"Start","ref_id":"456"},{"children":[{"text":" and \n          "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"X"}]}],"node_type":"AliasRef","ref_id":"457"}],"node_type":"End","ref_id":"458"}],"node_type":"DifferenceBetween","ref_id":"459"},{"children":[{"text":"\n        )"}]}],"node_type":"DifferenceBetween","ref_id":"459"},{"children":[{"text":"+ 1"}],"node_type":"Literal","ref_id":"460"}],"node_type":"Add","ref_id":"461"}],"ref_id":"462"}],"ref_id":"463"},{"children":[{"text":"\n    )"}]}],"ref_id":"464"},{"children":[{"text":"\n  )"}]}],"ref_id":"464"},{"children":[{"text":" \n    else null"}],"node_type":"Null","ref_id":"465"}],"node_type":"If","ref_id":"466"}],"node_type":"If","ref_id":"466"}],"ref_id":"467"}],"define_name":"CumulativeDuration"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Rolls out periods so that overlapping periods delay the start of subsequent periods\n  @comment: Returns the periods with overlapping periods delayed so that there is no overlap between any two periods in the result.*/\ndefine function \"RolloutIntervals\"(intervals "}]},{"children":[{"children":[{"text":"List\u003c"}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"Date"}]}],"ref_id":"468"},{"children":[{"text":"\u003e"}]}],"ref_id":"469"},{"children":[{"text":"\u003e"}]}],"ref_id":"470"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"intervals"}]}]}],"node_type":"OperandRef","ref_id":"471"},{"children":[{"text":" I"}]}],"ref_id":"472"}]},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"aggregate all R "}]},{"children":[{"children":[{"text":"starting ( "}]},{"children":[{"children":[{"text":"null as "}],"node_type":"Null","ref_id":"473"},{"children":[{"children":[{"text":"List\u003c"}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"Date"}]}],"ref_id":"474"},{"children":[{"text":"\u003e"}]}],"ref_id":"475"},{"children":[{"text":"\u003e"}]}],"ref_id":"476"}],"ref_id":"477"},{"children":[{"text":")"}]}],"ref_id":"477"},{"children":[{"text":": "}]},{"children":[{"children":[{"children":[{"text":"R"}]}],"node_type":"QueryLetRef","ref_id":"478"},{"children":[{"text":"\n    union "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"text":"{ "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"I"}]}]}],"node_type":"AliasRef","ref_id":"479"},{"children":[{"text":" X"}]}],"ref_id":"480"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"S: "}]},{"children":[{"children":[{"text":"Max("}]},{"children":[{"children":[{"text":"{ \n          "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"text":"R"}]}],"ref_id":"481"},{"children":[{"text":")"}]}],"node_type":"Last","ref_id":"482"}],"node_type":"End","ref_id":"483"},{"children":[{"text":"+ "}]},{"children":[{"children":[{"text":"1 day"}]}],"node_type":"Quantity","ref_id":"484"}],"ref_id":"485"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"X"}]}],"node_type":"AliasRef","ref_id":"486"}],"ref_id":"487"},{"children":[{"text":" }"}]}],"ref_id":"488"},{"children":[{"text":"\n        )"}]}],"node_type":"Max","ref_id":"489"}],"ref_id":"490"},{"children":[{"text":",\n        "}]},{"children":[{"children":[{"text":"E: "}]},{"children":[{"children":[{"children":[{"text":"S"}]}],"node_type":"QueryLetRef","ref_id":"491"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"Quantity { "}]},{"children":[{"children":[{"text":"value: "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"duration in days of "}]},{"children":[{"children":[{"text":"X"}]}],"node_type":"AliasRef","ref_id":"492"}],"node_type":"DurationBetween","ref_id":"493"},{"children":[{"text":", 0)"}],"node_type":"Literal","ref_id":"494"}],"node_type":"Coalesce","ref_id":"495"}]},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"unit: "}]},{"children":[{"children":[{"text":"'day'"}]}],"ref_id":"496"}]},{"children":[{"text":" }"}]}],"node_type":"Instance","ref_id":"497"}],"node_type":"Add","ref_id":"498"}],"ref_id":"499"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"S"}]}],"ref_id":"500"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"E"}]}],"ref_id":"501"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"502"}],"ref_id":"503"}],"ref_id":"504"},{"children":[{"text":"}"}]}],"node_type":"List","ref_id":"505"},{"children":[{"text":"\n    )"}]}],"node_type":"List","ref_id":"505"}],"node_type":"Union","ref_id":"506"}],"ref_id":"507"}],"node_type":"Query","ref_id":"508"}],"node_type":"Query","ref_id":"508"}],"ref_id":"509"}],"define_name":"RolloutIntervals"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Calculates the Medication Period for a single Medication, Order\n  @comment: This function calculates the expected period of a medication order using the following approach: If `daysSupplied` element is present, the duration is `daysSupplied * (1 + refills)`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency)) * (1 + refills)`.  The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary.*/\ndefine function \"MedicationOrderPeriod\"(MedOrder "}]},{"children":[{"children":[{"text":"\"Medication, Order\""}]}],"ref_id":"516"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"MedOrder"}]}]}],"node_type":"OperandRef","ref_id":"517"},{"children":[{"text":" Order"}]}],"ref_id":"518"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"startDate: "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"519"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"ref_id":"520"}],"ref_id":"520"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"low"}]}],"node_type":"Property","ref_id":"521"}],"node_type":"Property","ref_id":"521"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"522"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"authorDatetime"}]}],"node_type":"Property","ref_id":"523"}],"node_type":"Property","ref_id":"523"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"524"}],"node_type":"DateFrom","ref_id":"525"}],"ref_id":"526"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"totalDaysSupplied: "}]},{"children":[{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"527"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"daysSupplied"}]}],"node_type":"Property","ref_id":"528"}],"node_type":"Property","ref_id":"528"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"529"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"supply"}]}],"ref_id":"530"}],"ref_id":"530"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"531"}],"node_type":"Property","ref_id":"531"},{"children":[{"text":" /"}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"532"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"dosage"}]}],"ref_id":"533"}],"ref_id":"533"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"534"}],"node_type":"Property","ref_id":"534"},{"children":[{"text":" * "}]},{"children":[{"children":[{"text":"ToDaily("}]},{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"535"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"frequency"}]}],"node_type":"Property","ref_id":"536"}],"node_type":"Property","ref_id":"536"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"537"}],"node_type":"Multiply","ref_id":"538"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"538"}],"node_type":"Divide","ref_id":"539"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"540"},{"children":[{"text":" * "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"text":"1 + "}],"node_type":"Literal","ref_id":"541"},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"542"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"refills"}]}],"node_type":"Property","ref_id":"543"}],"node_type":"Property","ref_id":"543"},{"children":[{"text":", 0)"}],"node_type":"Literal","ref_id":"544"}],"node_type":"Coalesce","ref_id":"545"}],"node_type":"Add","ref_id":"546"},{"children":[{"text":" )"}]}],"node_type":"Add","ref_id":"546"}],"node_type":"Multiply","ref_id":"547"}],"ref_id":"548"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"549"},{"children":[{"text":" is null"}]}],"ref_id":"550"},{"children":[{"text":" then null \n      else "}],"node_type":"Null","ref_id":"551"},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"totalDaysSupplied"}]}],"node_type":"QueryLetRef","ref_id":"552"},{"children":[{"text":" is not null"}]}],"ref_id":"553"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"startDate"}]}],"ref_id":"554"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"555"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"Quantity { "}]},{"children":[{"children":[{"text":"value: "}]},{"children":[{"children":[{"children":[{"text":"totalDaysSupplied"}]}],"node_type":"QueryLetRef","ref_id":"556"},{"children":[{"text":" - 1"}],"node_type":"Literal","ref_id":"557"}],"ref_id":"558"}]},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"unit: "}]},{"children":[{"children":[{"text":"'day'"}]}],"ref_id":"559"}]},{"children":[{"text":" }"}]}],"node_type":"Instance","ref_id":"560"}],"ref_id":"561"},{"children":[{"text":"]"}]}],"ref_id":"562"},{"children":[{"text":"\n      else "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"563"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"ref_id":"564"}],"ref_id":"564"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"high"}]}],"node_type":"Property","ref_id":"565"}],"node_type":"Property","ref_id":"565"},{"children":[{"text":" is not null"}]}],"ref_id":"566"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"startDate"}]}],"ref_id":"567"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Order"}]}],"ref_id":"568"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"569"}],"node_type":"Property","ref_id":"569"}],"node_type":"End","ref_id":"570"}],"ref_id":"571"},{"children":[{"text":"]"}]}],"ref_id":"572"},{"children":[{"text":"\n      else null"}],"node_type":"Null","ref_id":"573"}],"ref_id":"574"}],"ref_id":"575"}],"node_type":"If","ref_id":"576"}],"ref_id":"577"}],"node_type":"Query","ref_id":"578"}],"node_type":"Query","ref_id":"578"}],"ref_id":"579"}],"define_name":"MedicationOrderPeriod"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Calculates Medication Period for a given Medication, Dispensed\n  @comment: This function calculates the effective duration of a single medication dispensing event using the following approach:  If `daysSupplied` element is present, the duration is `daysSupplied`. If `supply`, `dosage`, and `frequency` elements are present, `daysSupplied` is derived by calculating `(supply / (dosage * frequency))`. The result is then the interval from `relevantPeriod.low` to `relevantPeriod.low + daysSupplied`, or `relevantDatetime` to `relevantDatetime + daysSupplied`, or `authorDatetime` to `authorDatetime + daysSupplied`. Otherwise, the `relevantPeriod` element is used if present and completely specified.\n  Note that the supply and dosage Quantity values on the order are assumed to be in terms of the same unit, typically a tablet or mL.\n  @seealso: [CumulativeMedicationDuration](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/blob/master/Source/Libraries)\n  Note that relevantPeriod.low represents the interval's lower boundary and relevantPeriod.high represents the interval's higher boundary.*/\ndefine function \"MedicationDispensedPeriod\"(MedDispense "}]},{"children":[{"children":[{"text":"\"Medication, Dispensed\""}]}],"ref_id":"582"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"MedDispense"}]}]}],"node_type":"OperandRef","ref_id":"583"},{"children":[{"text":" Dispense"}]}],"ref_id":"584"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"startDate: "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"585"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"ref_id":"586"}],"ref_id":"586"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"low"}]}],"node_type":"Property","ref_id":"587"}],"node_type":"Property","ref_id":"587"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"588"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"Property","ref_id":"589"}],"node_type":"Property","ref_id":"589"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"590"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"authorDatetime"}]}],"node_type":"Property","ref_id":"591"}],"node_type":"Property","ref_id":"591"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"592"}],"node_type":"DateFrom","ref_id":"593"}],"ref_id":"594"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"totalDaysSupplied: "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"595"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"daysSupplied"}]}],"node_type":"Property","ref_id":"596"}],"node_type":"Property","ref_id":"596"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"597"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"supply"}]}],"ref_id":"598"}],"ref_id":"598"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"599"}],"node_type":"Property","ref_id":"599"},{"children":[{"text":" /"}]},{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"600"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"dosage"}]}],"ref_id":"601"}],"ref_id":"601"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"value"}]}],"node_type":"Property","ref_id":"602"}],"node_type":"Property","ref_id":"602"},{"children":[{"text":" * "}]},{"children":[{"children":[{"text":"ToDaily("}]},{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"603"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"frequency"}]}],"node_type":"Property","ref_id":"604"}],"node_type":"Property","ref_id":"604"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"605"}],"node_type":"Multiply","ref_id":"606"},{"children":[{"text":")"}]}],"node_type":"Multiply","ref_id":"606"}],"node_type":"Divide","ref_id":"607"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"608"}],"ref_id":"609"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"610"},{"children":[{"text":" is null"}]}],"ref_id":"611"},{"children":[{"text":" then null \n      else "}],"node_type":"Null","ref_id":"612"},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"totalDaysSupplied"}]}],"node_type":"QueryLetRef","ref_id":"613"},{"children":[{"text":" is not null"}]}],"ref_id":"614"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"startDate"}]}],"ref_id":"615"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"startDate"}]}],"node_type":"QueryLetRef","ref_id":"616"},{"children":[{"text":" + "}]},{"children":[{"children":[{"text":"Quantity { "}]},{"children":[{"children":[{"text":"value: "}]},{"children":[{"children":[{"children":[{"text":"totalDaysSupplied"}]}],"node_type":"QueryLetRef","ref_id":"617"},{"children":[{"text":" - 1"}],"node_type":"Literal","ref_id":"618"}],"ref_id":"619"}]},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"unit: "}]},{"children":[{"children":[{"text":"'day'"}]}],"ref_id":"620"}]},{"children":[{"text":" }"}]}],"node_type":"Instance","ref_id":"621"}],"ref_id":"622"},{"children":[{"text":"]"}]}],"ref_id":"623"},{"children":[{"text":"\n      else "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"624"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"ref_id":"625"}],"ref_id":"625"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"high"}]}],"node_type":"Property","ref_id":"626"}],"node_type":"Property","ref_id":"626"},{"children":[{"text":" is not null"}]}],"ref_id":"627"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"startDate"}]}],"ref_id":"628"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Dispense"}]}],"ref_id":"629"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"630"}],"node_type":"Property","ref_id":"630"}],"node_type":"End","ref_id":"631"}],"ref_id":"632"},{"children":[{"text":"]"}]}],"ref_id":"633"},{"children":[{"text":"\n      else null"}],"node_type":"Null","ref_id":"634"}],"ref_id":"635"}],"ref_id":"636"}],"node_type":"If","ref_id":"637"}],"ref_id":"638"}],"node_type":"Query","ref_id":"639"}],"node_type":"Query","ref_id":"639"}],"ref_id":"640"}],"define_name":"MedicationDispensedPeriod"},{"children":[{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Calculates the effective duration of the given medication event, whether it is an order, dispense, discharge, or administration. Note that this function is still under development and should not be used.*/\ndefine function \"MedicationPeriod\"(Medication "}]},{"children":[{"children":[{"text":"Choice\u003c"}]},{"children":[{"children":[{"text":"\"Medication, Order\""}]}],"ref_id":"510"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"\"Medication, Dispensed\""}]}],"ref_id":"511"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"\"Medication, Discharge\""}]}],"ref_id":"512"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"\"Medication, Administered\""}]}],"ref_id":"513"},{"children":[{"text":"\n     \u003e"}]}],"ref_id":"514"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"Coalesce(\n       "}]},{"children":[{"children":[{"text":"MedicationOrderPeriod("}]},{"children":[{"children":[{"text":"Medication"}]}],"node_type":"OperandRef","ref_id":"515"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"580"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"MedicationDispensedPeriod("}]},{"children":[{"children":[{"text":"Medication"}]}],"node_type":"OperandRef","ref_id":"581"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"641"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"MedicationDischargePeriod("}]},{"children":[{"children":[{"text":"Medication"}]}],"node_type":"OperandRef","ref_id":"642"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"643"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"MedicationAdministrationPeriod("}]},{"children":[{"children":[{"text":"Medication"}]}],"node_type":"OperandRef","ref_id":"644"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"645"},{"children":[{"text":"\n     )"}]}],"node_type":"Coalesce","ref_id":"646"}],"node_type":"Coalesce","ref_id":"646"}],"ref_id":"647"}],"define_name":"MedicationPeriod"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Calculates the cumulative medication duration of the given medication events\n  @comment: This function will _roll out_ periods from dispense and administration events, and then collapse across that result and periods from prescriptions. The separation of medications by type should already be done prior to using this function. In addition, calculations that combine dosages from different types of medications (such as Morphine Milligram Equivalent (MME)) require further consideration. Note that this function is still under development and should not be used.*/\ndefine function \"CalculateCumulativeMedicationDuration\"(Medications "}]},{"children":[{"children":[{"text":"List\u003c"}]},{"children":[{"children":[{"text":"Choice\u003c"}]},{"children":[{"children":[{"text":"\"Medication, Order\""}]}],"ref_id":"648"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"\"Medication, Dispensed\""}]}],"ref_id":"649"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"\"Medication, Discharge\""}]}],"ref_id":"650"},{"children":[{"text":",\n       "}]},{"children":[{"children":[{"text":"\"Medication, Administered\""}]}],"ref_id":"651"},{"children":[{"text":"\n     \u003e"}]}],"ref_id":"652"},{"children":[{"text":"\u003e"}]}],"ref_id":"653"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"CumulativeDuration("}]},{"children":[{"children":[{"children":[{"text":"(\n         "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Medications"}]}]}],"node_type":"OperandRef","ref_id":"654"},{"children":[{"text":" M"}]}],"ref_id":"655"}]},{"children":[{"text":"\n           "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"M"}]}],"node_type":"AliasRef","ref_id":"656"},{"children":[{"text":" is "}]},{"children":[{"children":[{"text":"\"Medication, Order\""}]}],"ref_id":"657"}],"node_type":"Is","ref_id":"658"},{"children":[{"text":" or "}]},{"children":[{"children":[{"children":[{"text":"M"}]}],"node_type":"AliasRef","ref_id":"659"},{"children":[{"text":" is "}]},{"children":[{"children":[{"text":"\"Medication, Discharge\""}]}],"ref_id":"660"}],"node_type":"Is","ref_id":"661"}],"ref_id":"662"}],"ref_id":"662"},{"children":[{"text":"\n           "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"MedicationPeriod("}]},{"children":[{"children":[{"text":"M"}]}],"node_type":"AliasRef","ref_id":"663"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"664"}],"ref_id":"665"}],"node_type":"Query","ref_id":"666"},{"children":[{"text":"\n       )"}]}],"node_type":"Query","ref_id":"666"},{"children":[{"text":"\n         union "}]},{"children":[{"children":[{"text":"(\n           "}]},{"children":[{"children":[{"text":"RolloutIntervals(\n             "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Medications"}]}]}],"node_type":"OperandRef","ref_id":"667"},{"children":[{"text":" M"}]}],"ref_id":"668"}]},{"children":[{"text":"\n               "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"M"}]}],"node_type":"AliasRef","ref_id":"669"},{"children":[{"text":" is "}]},{"children":[{"children":[{"text":"\"Medication, Dispensed\""}]}],"ref_id":"670"}],"node_type":"Is","ref_id":"671"},{"children":[{"text":" or "}]},{"children":[{"children":[{"children":[{"text":"M"}]}],"node_type":"AliasRef","ref_id":"672"},{"children":[{"text":" is "}]},{"children":[{"children":[{"text":"\"Medication, Administered\""}]}],"ref_id":"673"}],"node_type":"Is","ref_id":"674"}],"ref_id":"675"}],"ref_id":"675"},{"children":[{"text":"\n               "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"MedicationPeriod("}]},{"children":[{"children":[{"text":"M"}]}],"node_type":"AliasRef","ref_id":"676"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"677"}],"ref_id":"678"}],"node_type":"Query","ref_id":"679"},{"children":[{"text":"\n           )"}]}],"node_type":"FunctionRef","ref_id":"680"},{"children":[{"text":"\n         )"}]}],"node_type":"FunctionRef","ref_id":"680"}],"node_type":"Union","ref_id":"681"},{"children":[{"text":"\n     )"}]}],"node_type":"FunctionRef","ref_id":"682"}],"node_type":"FunctionRef","ref_id":"682"}],"ref_id":"683"}],"define_name":"CalculateCumulativeMedicationDuration"}],"identifier":{"id":"CumulativeMedicationDurationQDM","version":"3.0.000"}},"is_main_library":false,"is_top_level":true,"library_name":"CumulativeMedicationDurationQDM","library_version":"3.0.000","statement_dependencies":[{"_id":"68923b74a83e15671c2c8b9c","statement_name":"MedicationDispensedPeriod","statement_references":[{"_id":"68923b7ca83e15671c2c8e3e","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"ToDaily"}]},{"_id":"68923b74a83e15671c2c8b9d","statement_name":"ToDaily","statement_references":[{"_id":"68923b74a83e15671c2c8b9a","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"QuantityToDaily"},{"_id":"68923b74a83e15671c2c8b9b","hqmf_id":null,"library_name":"CumulativeMedicationDurationQDM","statement_name":"CodeToDaily"}]},{"_id":"68923b74a83e15671c2c8b9e","statement_name":"QuantityToDaily"},{"_id":"68923b74a83e15671c2c8b9f","statement_name":"CodeToDaily"},{"_id":"68923b74a83e15671c2c8ba0","statement_name":"CumulativeDuration"}]},{"_id":"68923b74a83e15671c2c8ba5","cql":"library HospiceQDM version '6.0.000'\n\nusing QDM version '5.6'\n\ninclude MATGlobalCommonFunctionsQDM version '8.0.000' called Global\n\ncodesystem \"SNOMEDCT\": 'urn:oid:2.16.840.1.113883.6.96' \ncodesystem \"LOINC\": 'urn:oid:2.16.840.1.113883.6.1' \n\nvalueset \"Encounter Inpatient\": 'urn:oid:2.16.840.1.113883.3.666.5.307' \nvalueset \"Hospice Care Ambulatory\": 'urn:oid:2.16.840.1.113883.3.526.3.1584' \nvalueset \"Hospice Diagnosis\": 'urn:oid:2.16.840.1.113883.3.464.1003.1165' \nvalueset \"Hospice Encounter\": 'urn:oid:2.16.840.1.113883.3.464.1003.1003' \n\ncode \"Discharge to healthcare facility for hospice care (procedure)\": '428371000124100' from \"SNOMEDCT\" display 'Discharge to healthcare facility for hospice care (procedure)'\ncode \"Discharge to home for hospice care (procedure)\": '428361000124107' from \"SNOMEDCT\" display 'Discharge to home for hospice care (procedure)'\ncode \"Hospice care [Minimum Data Set]\": '45755-6' from \"LOINC\" display 'Hospice care [Minimum Data Set]'\ncode \"Yes (qualifier value)\": '373066001' from \"SNOMEDCT\" display 'Yes (qualifier value)'\n\nparameter \"Measurement Period\" Interval\u003cDateTime\u003e\n\ncontext Patient\n\ndefine \"Has Hospice Services\":\n  exists ( [\"Encounter, Performed\": \"Encounter Inpatient\"] InpatientEncounter\n      where ( InpatientEncounter.dischargeDisposition ~ \"Discharge to home for hospice care (procedure)\"\n          or InpatientEncounter.dischargeDisposition ~ \"Discharge to healthcare facility for hospice care (procedure)\"\n      )\n        and InpatientEncounter.relevantPeriod ends during day of \"Measurement Period\"\n  )\n    or exists ( [\"Encounter, Performed\": \"Hospice Encounter\"] HospiceEncounter\n        where HospiceEncounter.relevantPeriod overlaps day of \"Measurement Period\"\n    )\n    or exists ( [\"Assessment, Performed\": \"Hospice care [Minimum Data Set]\"] HospiceAssessment\n        where HospiceAssessment.result ~ \"Yes (qualifier value)\"\n          and Global.\"NormalizeInterval\" ( HospiceAssessment.relevantDatetime, HospiceAssessment.relevantPeriod ) overlaps day of \"Measurement Period\"\n    )\n    or exists ( [\"Intervention, Order\": \"Hospice Care Ambulatory\"] HospiceOrder\n        where HospiceOrder.authorDatetime during day of \"Measurement Period\"\n    )\n    or exists ( [\"Intervention, Performed\": \"Hospice Care Ambulatory\"] HospicePerformed\n        where Global.\"NormalizeInterval\" ( HospicePerformed.relevantDatetime, HospicePerformed.relevantPeriod ) overlaps day of \"Measurement Period\"\n    )\n  or exists ( [\"Diagnosis\": \"Hospice Diagnosis\"] HospiceCareDiagnosis\n        where HospiceCareDiagnosis.prevalencePeriod overlaps day of \"Measurement Period\"\n    )\n\n","elm":{"library":{"annotation":[{"translatorOptions":"EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion,DisableMethodInvocation","type":"CqlToElmInfo"},{"type":"Annotation","s":{"r":"96","s":[{"value":["","library HospiceQDM version '6.0.000'"]}]}}],"identifier":{"id":"HospiceQDM","version":"6.0.000"},"schemaIdentifier":{"id":"urn:hl7-org:elm","version":"r1"},"usings":{"def":[{"localIdentifier":"System","uri":"urn:hl7-org:elm-types:r1"},{"localId":"1","locator":"3:1-3:23","localIdentifier":"QDM","uri":"urn:healthit-gov:qdm:v5_6","version":"5.6","annotation":[{"type":"Annotation","s":{"r":"1","s":[{"value":["","using "]},{"s":[{"value":["QDM"]}]},{"value":[" version ","'5.6'"]}]}}]}]},"includes":{"def":[{"localId":"2","locator":"5:1-5:67","localIdentifier":"Global","path":"MATGlobalCommonFunctionsQDM","version":"8.0.000","annotation":[{"type":"Annotation","s":{"r":"2","s":[{"value":["","include "]},{"s":[{"value":["MATGlobalCommonFunctionsQDM"]}]},{"value":[" version ","'8.0.000'"," called ","Global"]}]}}]}]},"parameters":{"def":[{"localId":"19","locator":"20:1-20:49","name":"Measurement Period","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"19","s":[{"value":["","parameter ","\"Measurement Period\""," "]},{"r":"18","s":[{"value":["Interval\u003c"]},{"r":"17","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]}]}}],"parameterTypeSpecifier":{"localId":"18","locator":"20:32-20:49","type":"IntervalTypeSpecifier","pointType":{"localId":"17","locator":"20:41-20:48","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},"codeSystems":{"def":[{"localId":"3","locator":"7:1-7:55","name":"SNOMEDCT","id":"2.16.840.1.113883.6.96","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"3","s":[{"value":["","codesystem ","\"SNOMEDCT\"",": ","'urn:oid:2.16.840.1.113883.6.96'"]}]}}]},{"localId":"4","locator":"8:1-8:51","name":"LOINC","id":"2.16.840.1.113883.6.1","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"4","s":[{"value":["","codesystem ","\"LOINC\"",": ","'urn:oid:2.16.840.1.113883.6.1'"]}]}}]}]},"valueSets":{"def":[{"localId":"5","locator":"10:1-10:71","name":"Encounter Inpatient","id":"2.16.840.1.113883.3.666.5.307","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"5","s":[{"value":["","valueset ","\"Encounter Inpatient\"",": ","'urn:oid:2.16.840.1.113883.3.666.5.307'"]}]}}]},{"localId":"6","locator":"11:1-11:76","name":"Hospice Care Ambulatory","id":"2.16.840.1.113883.3.526.3.1584","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"6","s":[{"value":["","valueset ","\"Hospice Care Ambulatory\"",": ","'urn:oid:2.16.840.1.113883.3.526.3.1584'"]}]}}]},{"localId":"7","locator":"12:1-12:73","name":"Hospice Diagnosis","id":"2.16.840.1.113883.3.464.1003.1165","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"7","s":[{"value":["","valueset ","\"Hospice Diagnosis\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.1165'"]}]}}]},{"localId":"8","locator":"13:1-13:73","name":"Hospice Encounter","id":"2.16.840.1.113883.3.464.1003.1003","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"8","s":[{"value":["","valueset ","\"Hospice Encounter\"",": ","'urn:oid:2.16.840.1.113883.3.464.1003.1003'"]}]}}]}]},"codes":{"def":[{"localId":"10","locator":"15:1-15:175","name":"Discharge to healthcare facility for hospice care (procedure)","id":"428371000124100","display":"Discharge to healthcare facility for hospice care (procedure)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"10","s":[{"value":["","code ","\"Discharge to healthcare facility for hospice care (procedure)\"",": ","'428371000124100'"," from "]},{"r":"9","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Discharge to healthcare facility for hospice care (procedure)'"]}]}}],"codeSystem":{"localId":"9","locator":"15:94-15:103","name":"SNOMEDCT"}},{"localId":"12","locator":"16:1-16:145","name":"Discharge to home for hospice care (procedure)","id":"428361000124107","display":"Discharge to home for hospice care (procedure)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"12","s":[{"value":["","code ","\"Discharge to home for hospice care (procedure)\"",": ","'428361000124107'"," from "]},{"r":"11","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Discharge to home for hospice care (procedure)'"]}]}}],"codeSystem":{"localId":"11","locator":"16:79-16:88","name":"SNOMEDCT"}},{"localId":"14","locator":"17:1-17:104","name":"Hospice care [Minimum Data Set]","id":"45755-6","display":"Hospice care [Minimum Data Set]","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"14","s":[{"value":["","code ","\"Hospice care [Minimum Data Set]\"",": ","'45755-6'"," from "]},{"r":"13","s":[{"value":["\"LOINC\""]}]},{"value":[" display ","'Hospice care [Minimum Data Set]'"]}]}}],"codeSystem":{"localId":"13","locator":"17:56-17:62","name":"LOINC"}},{"localId":"16","locator":"18:1-18:89","name":"Yes (qualifier value)","id":"373066001","display":"Yes (qualifier value)","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"16","s":[{"value":["","code ","\"Yes (qualifier value)\"",": ","'373066001'"," from "]},{"r":"15","s":[{"value":["\"SNOMEDCT\""]}]},{"value":[" display ","'Yes (qualifier value)'"]}]}}],"codeSystem":{"localId":"15","locator":"18:48-18:57","name":"SNOMEDCT"}}]},"contexts":{"def":[{"locator":"22:1-22:15","name":"Patient"}]},"statements":{"def":[{"locator":"22:1-22:15","name":"Patient","context":"Patient","expression":{"type":"SingletonFrom","operand":{"locator":"22:1-22:15","dataType":"{urn:healthit-gov:qdm:v5_6}Patient","templateId":"Patient","type":"Retrieve"}}},{"localId":"96","locator":"24:1-46:5","name":"Has Hospice Services","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"96","s":[{"value":["","define ","\"Has Hospice Services\"",":\n  "]},{"r":"95","s":[{"r":"86","s":[{"r":"73","s":[{"r":"64","s":[{"r":"46","s":[{"r":"37","s":[{"value":["exists "]},{"r":"36","s":[{"value":["( "]},{"r":"36","s":[{"s":[{"r":"21","s":[{"r":"20","s":[{"r":"20","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Encounter Inpatient\""]}]},{"value":["]"]}]}]},{"value":[" ","InpatientEncounter"]}]}]},{"value":["\n      "]},{"r":"35","s":[{"value":["where "]},{"r":"35","s":[{"r":"30","s":[{"value":["( "]},{"r":"30","s":[{"r":"25","s":[{"r":"23","s":[{"r":"22","s":[{"value":["InpatientEncounter"]}]},{"value":["."]},{"r":"23","s":[{"value":["dischargeDisposition"]}]}]},{"value":[" ","~"," "]},{"r":"24","s":[{"value":["\"Discharge to home for hospice care (procedure)\""]}]}]},{"value":["\n          or "]},{"r":"29","s":[{"r":"27","s":[{"r":"26","s":[{"value":["InpatientEncounter"]}]},{"value":["."]},{"r":"27","s":[{"value":["dischargeDisposition"]}]}]},{"value":[" ","~"," "]},{"r":"28","s":[{"value":["\"Discharge to healthcare facility for hospice care (procedure)\""]}]}]}]},{"value":["\n      )"]}]},{"value":["\n        and "]},{"r":"34","s":[{"r":"32","s":[{"r":"31","s":[{"value":["InpatientEncounter"]}]},{"value":["."]},{"r":"32","s":[{"value":["relevantPeriod"]}]}]},{"r":"34","value":[" ","ends during day of"," "]},{"r":"33","s":[{"value":["\"Measurement Period\""]}]}]}]}]}]},{"value":["\n  )"]}]}]},{"value":["\n    or "]},{"r":"45","s":[{"value":["exists "]},{"r":"44","s":[{"value":["( "]},{"r":"44","s":[{"s":[{"r":"39","s":[{"r":"38","s":[{"r":"38","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Hospice Encounter\""]}]},{"value":["]"]}]}]},{"value":[" ","HospiceEncounter"]}]}]},{"value":["\n        "]},{"r":"43","s":[{"value":["where "]},{"r":"43","s":[{"r":"41","s":[{"r":"40","s":[{"value":["HospiceEncounter"]}]},{"value":["."]},{"r":"41","s":[{"value":["relevantPeriod"]}]}]},{"r":"43","value":[" ","overlaps day of"," "]},{"r":"42","s":[{"value":["\"Measurement Period\""]}]}]}]}]},{"value":["\n    )"]}]}]}]},{"value":["\n    or "]},{"r":"63","s":[{"value":["exists "]},{"r":"62","s":[{"value":["( "]},{"r":"62","s":[{"s":[{"r":"48","s":[{"r":"47","s":[{"r":"47","s":[{"value":["[","\"Assessment, Performed\"",": "]},{"s":[{"value":["\"Hospice care [Minimum Data Set]\""]}]},{"value":["]"]}]}]},{"value":[" ","HospiceAssessment"]}]}]},{"value":["\n        "]},{"r":"61","s":[{"value":["where "]},{"r":"61","s":[{"r":"52","s":[{"r":"50","s":[{"r":"49","s":[{"value":["HospiceAssessment"]}]},{"value":["."]},{"r":"50","s":[{"value":["result"]}]}]},{"value":[" ","~"," "]},{"r":"51","s":[{"value":["\"Yes (qualifier value)\""]}]}]},{"value":["\n          and "]},{"r":"60","s":[{"r":"58","s":[{"r":"53","s":[{"value":["Global"]}]},{"value":["."]},{"r":"58","s":[{"value":["\"NormalizeInterval\""," ( "]},{"r":"55","s":[{"r":"54","s":[{"value":["HospiceAssessment"]}]},{"value":["."]},{"r":"55","s":[{"value":["relevantDatetime"]}]}]},{"value":[", "]},{"r":"57","s":[{"r":"56","s":[{"value":["HospiceAssessment"]}]},{"value":["."]},{"r":"57","s":[{"value":["relevantPeriod"]}]}]},{"value":[" )"]}]}]},{"r":"60","value":[" ","overlaps day of"," "]},{"r":"59","s":[{"value":["\"Measurement Period\""]}]}]}]}]}]},{"value":["\n    )"]}]}]}]},{"value":["\n    or "]},{"r":"72","s":[{"value":["exists "]},{"r":"71","s":[{"value":["( "]},{"r":"71","s":[{"s":[{"r":"66","s":[{"r":"65","s":[{"r":"65","s":[{"value":["[","\"Intervention, Order\"",": "]},{"s":[{"value":["\"Hospice Care Ambulatory\""]}]},{"value":["]"]}]}]},{"value":[" ","HospiceOrder"]}]}]},{"value":["\n        "]},{"r":"70","s":[{"value":["where "]},{"r":"70","s":[{"r":"68","s":[{"r":"67","s":[{"value":["HospiceOrder"]}]},{"value":["."]},{"r":"68","s":[{"value":["authorDatetime"]}]}]},{"r":"70","value":[" ","during day of"," "]},{"r":"69","s":[{"value":["\"Measurement Period\""]}]}]}]}]},{"value":["\n    )"]}]}]}]},{"value":["\n    or "]},{"r":"85","s":[{"value":["exists "]},{"r":"84","s":[{"value":["( "]},{"r":"84","s":[{"s":[{"r":"75","s":[{"r":"74","s":[{"r":"74","s":[{"value":["[","\"Intervention, Performed\"",": "]},{"s":[{"value":["\"Hospice Care Ambulatory\""]}]},{"value":["]"]}]}]},{"value":[" ","HospicePerformed"]}]}]},{"value":["\n        "]},{"r":"83","s":[{"value":["where "]},{"r":"83","s":[{"r":"81","s":[{"r":"76","s":[{"value":["Global"]}]},{"value":["."]},{"r":"81","s":[{"value":["\"NormalizeInterval\""," ( "]},{"r":"78","s":[{"r":"77","s":[{"value":["HospicePerformed"]}]},{"value":["."]},{"r":"78","s":[{"value":["relevantDatetime"]}]}]},{"value":[", "]},{"r":"80","s":[{"r":"79","s":[{"value":["HospicePerformed"]}]},{"value":["."]},{"r":"80","s":[{"value":["relevantPeriod"]}]}]},{"value":[" )"]}]}]},{"r":"83","value":[" ","overlaps day of"," "]},{"r":"82","s":[{"value":["\"Measurement Period\""]}]}]}]}]},{"value":["\n    )"]}]}]}]},{"value":["\n  or "]},{"r":"94","s":[{"value":["exists "]},{"r":"93","s":[{"value":["( "]},{"r":"93","s":[{"s":[{"r":"88","s":[{"r":"87","s":[{"r":"87","s":[{"value":["[","\"Diagnosis\"",": "]},{"s":[{"value":["\"Hospice Diagnosis\""]}]},{"value":["]"]}]}]},{"value":[" ","HospiceCareDiagnosis"]}]}]},{"value":["\n        "]},{"r":"92","s":[{"value":["where "]},{"r":"92","s":[{"r":"90","s":[{"r":"89","s":[{"value":["HospiceCareDiagnosis"]}]},{"value":["."]},{"r":"90","s":[{"value":["prevalencePeriod"]}]}]},{"r":"92","value":[" ","overlaps day of"," "]},{"r":"91","s":[{"value":["\"Measurement Period\""]}]}]}]}]},{"value":["\n    )"]}]}]}]}]}}],"expression":{"localId":"95","locator":"25:3-46:5","type":"Or","operand":[{"localId":"86","locator":"25:3-43:5","type":"Or","operand":[{"localId":"73","locator":"25:3-40:5","type":"Or","operand":[{"localId":"64","locator":"25:3-37:5","type":"Or","operand":[{"localId":"46","locator":"25:3-33:5","type":"Or","operand":[{"localId":"37","locator":"25:3-30:3","type":"Exists","operand":{"localId":"36","locator":"25:10-30:3","type":"Query","source":[{"localId":"21","locator":"25:12-25:77","alias":"InpatientEncounter","expression":{"localId":"20","locator":"25:12-25:58","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"25:37-25:57","name":"Encounter Inpatient","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"35","locator":"26:7-29:85","type":"And","operand":[{"localId":"30","locator":"26:13-28:7","type":"Or","operand":[{"localId":"25","locator":"26:15-26:104","type":"Equivalent","operand":[{"localId":"23","locator":"26:15-26:53","path":"dischargeDisposition","scope":"InpatientEncounter","type":"Property"},{"localId":"24","locator":"26:57-26:104","name":"Discharge to home for hospice care (procedure)","type":"CodeRef"}]},{"localId":"29","locator":"27:14-27:118","type":"Equivalent","operand":[{"localId":"27","locator":"27:14-27:52","path":"dischargeDisposition","scope":"InpatientEncounter","type":"Property"},{"localId":"28","locator":"27:56-27:118","name":"Discharge to healthcare facility for hospice care (procedure)","type":"CodeRef"}]}]},{"localId":"34","locator":"29:13-29:85","precision":"Day","type":"In","operand":[{"locator":"29:47-29:50","type":"End","operand":{"localId":"32","locator":"29:13-29:45","path":"relevantPeriod","scope":"InpatientEncounter","type":"Property"}},{"localId":"33","locator":"29:66-29:85","name":"Measurement Period","type":"ParameterRef"}]}]}}},{"localId":"45","locator":"31:8-33:5","type":"Exists","operand":{"localId":"44","locator":"31:15-33:5","type":"Query","source":[{"localId":"39","locator":"31:17-31:78","alias":"HospiceEncounter","expression":{"localId":"38","locator":"31:17-31:61","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"31:42-31:60","name":"Hospice Encounter","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"43","locator":"32:9-32:82","precision":"Day","type":"Overlaps","operand":[{"localId":"41","locator":"32:15-32:45","path":"relevantPeriod","scope":"HospiceEncounter","type":"Property"},{"localId":"42","locator":"32:63-32:82","name":"Measurement Period","type":"ParameterRef"}]}}}]},{"localId":"63","locator":"34:8-37:5","type":"Exists","operand":{"localId":"62","locator":"34:15-37:5","type":"Query","source":[{"localId":"48","locator":"34:17-34:94","alias":"HospiceAssessment","expression":{"localId":"47","locator":"34:17-34:76","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveAssessmentPerformed","templateId":"PositiveAssessmentPerformed","codeProperty":"code","codeComparator":"~","type":"Retrieve","codes":{"type":"ToList","operand":{"locator":"34:43-34:75","name":"Hospice care [Minimum Data Set]","type":"CodeRef"}}}}],"relationship":[],"where":{"localId":"61","locator":"35:9-36:150","type":"And","operand":[{"localId":"52","locator":"35:15-35:64","type":"Equivalent","operand":[{"asType":"{urn:hl7-org:elm-types:r1}Code","type":"As","operand":{"localId":"50","locator":"35:15-35:38","path":"result","scope":"HospiceAssessment","type":"Property"}},{"localId":"51","locator":"35:42-35:64","name":"Yes (qualifier value)","type":"CodeRef"}]},{"localId":"60","locator":"36:15-36:150","precision":"Day","type":"Overlaps","operand":[{"localId":"58","locator":"36:15-36:113","name":"NormalizeInterval","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"55","locator":"36:44-36:77","path":"relevantDatetime","scope":"HospiceAssessment","type":"Property"},{"localId":"57","locator":"36:80-36:111","path":"relevantPeriod","scope":"HospiceAssessment","type":"Property"}]},{"localId":"59","locator":"36:131-36:150","name":"Measurement Period","type":"ParameterRef"}]}]}}}]},{"localId":"72","locator":"38:8-40:5","type":"Exists","operand":{"localId":"71","locator":"38:15-40:5","type":"Query","source":[{"localId":"66","locator":"38:17-38:79","alias":"HospiceOrder","expression":{"localId":"65","locator":"38:17-38:66","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveInterventionOrder","templateId":"PositiveInterventionOrder","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"38:41-38:65","name":"Hospice Care Ambulatory","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"70","locator":"39:9-39:76","precision":"Day","type":"In","operand":[{"localId":"68","locator":"39:15-39:41","path":"authorDatetime","scope":"HospiceOrder","type":"Property"},{"localId":"69","locator":"39:57-39:76","name":"Measurement Period","type":"ParameterRef"}]}}}]},{"localId":"85","locator":"41:8-43:5","type":"Exists","operand":{"localId":"84","locator":"41:15-43:5","type":"Query","source":[{"localId":"75","locator":"41:17-41:87","alias":"HospicePerformed","expression":{"localId":"74","locator":"41:17-41:70","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveInterventionPerformed","templateId":"PositiveInterventionPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"41:45-41:69","name":"Hospice Care Ambulatory","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"83","locator":"42:9-42:148","precision":"Day","type":"Overlaps","operand":[{"localId":"81","locator":"42:15-42:111","name":"NormalizeInterval","libraryName":"Global","type":"FunctionRef","operand":[{"localId":"78","locator":"42:44-42:76","path":"relevantDatetime","scope":"HospicePerformed","type":"Property"},{"localId":"80","locator":"42:79-42:109","path":"relevantPeriod","scope":"HospicePerformed","type":"Property"}]},{"localId":"82","locator":"42:129-42:148","name":"Measurement Period","type":"ParameterRef"}]}}}]},{"localId":"94","locator":"44:6-46:5","type":"Exists","operand":{"localId":"93","locator":"44:13-46:5","type":"Query","source":[{"localId":"88","locator":"44:15-44:69","alias":"HospiceCareDiagnosis","expression":{"localId":"87","locator":"44:15-44:48","dataType":"{urn:healthit-gov:qdm:v5_6}Diagnosis","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"44:29-44:47","name":"Hospice Diagnosis","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"92","locator":"45:9-45:88","precision":"Day","type":"Overlaps","operand":[{"localId":"90","locator":"45:15-45:51","path":"prevalencePeriod","scope":"HospiceCareDiagnosis","type":"Property"},{"localId":"91","locator":"45:69-45:88","name":"Measurement Period","type":"ParameterRef"}]}}}]}}]}}},"elm_annotations":{"statements":[{"children":[{"children":[{"children":[{"text":"define \"Has Hospice Services\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Encounter Inpatient\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"20"}],"node_type":"Retrieve","ref_id":"20"},{"children":[{"text":" InpatientEncounter"}]}],"ref_id":"21"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"InpatientEncounter"}]}],"ref_id":"22"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"dischargeDisposition"}]}],"node_type":"Property","ref_id":"23"}],"node_type":"Property","ref_id":"23"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Discharge to home for hospice care (procedure)\""}]}],"node_type":"CodeRef","ref_id":"24"}],"node_type":"Equivalent","ref_id":"25"},{"children":[{"text":"\n          or "}]},{"children":[{"children":[{"children":[{"children":[{"text":"InpatientEncounter"}]}],"ref_id":"26"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"dischargeDisposition"}]}],"node_type":"Property","ref_id":"27"}],"node_type":"Property","ref_id":"27"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Discharge to healthcare facility for hospice care (procedure)\""}]}],"node_type":"CodeRef","ref_id":"28"}],"node_type":"Equivalent","ref_id":"29"}],"node_type":"Or","ref_id":"30"},{"children":[{"text":"\n      )"}]}],"node_type":"Or","ref_id":"30"},{"children":[{"text":"\n        and "}]},{"children":[{"children":[{"children":[{"children":[{"text":"InpatientEncounter"}]}],"ref_id":"31"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"32"}],"node_type":"Property","ref_id":"32"},{"children":[{"text":" ends during day of "}],"node_type":"In","ref_id":"34"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"33"}],"node_type":"In","ref_id":"34"}],"ref_id":"35"}],"ref_id":"35"}],"node_type":"Query","ref_id":"36"},{"children":[{"text":"\n  )"}]}],"node_type":"Query","ref_id":"36"}],"node_type":"Exists","ref_id":"37"},{"children":[{"text":"\n    or "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Hospice Encounter\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"38"}],"node_type":"Retrieve","ref_id":"38"},{"children":[{"text":" HospiceEncounter"}]}],"ref_id":"39"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"HospiceEncounter"}]}],"ref_id":"40"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"41"}],"node_type":"Property","ref_id":"41"},{"children":[{"text":" overlaps day of "}],"ref_id":"43"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"42"}],"ref_id":"43"}],"ref_id":"43"}],"node_type":"Query","ref_id":"44"},{"children":[{"text":"\n    )"}]}],"node_type":"Query","ref_id":"44"}],"node_type":"Exists","ref_id":"45"}],"node_type":"Or","ref_id":"46"},{"children":[{"text":"\n    or "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Assessment, Performed\": "}]},{"children":[{"children":[{"text":"\"Hospice care [Minimum Data Set]\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"47"}],"node_type":"Retrieve","ref_id":"47"},{"children":[{"text":" HospiceAssessment"}]}],"ref_id":"48"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"HospiceAssessment"}]}],"ref_id":"49"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"result"}]}],"node_type":"Property","ref_id":"50"}],"node_type":"Property","ref_id":"50"},{"children":[{"text":" ~ "}]},{"children":[{"children":[{"text":"\"Yes (qualifier value)\""}]}],"node_type":"CodeRef","ref_id":"51"}],"node_type":"Equivalent","ref_id":"52"},{"children":[{"text":"\n          and "}]},{"children":[{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"53"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"NormalizeInterval\" ( "}]},{"children":[{"children":[{"children":[{"text":"HospiceAssessment"}]}],"ref_id":"54"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"Property","ref_id":"55"}],"node_type":"Property","ref_id":"55"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"HospiceAssessment"}]}],"ref_id":"56"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"57"}],"node_type":"Property","ref_id":"57"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"58"}],"node_type":"FunctionRef","ref_id":"58"},{"children":[{"text":" overlaps day of "}],"node_type":"Overlaps","ref_id":"60"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"59"}],"node_type":"Overlaps","ref_id":"60"}],"ref_id":"61"}],"ref_id":"61"}],"node_type":"Query","ref_id":"62"},{"children":[{"text":"\n    )"}]}],"node_type":"Query","ref_id":"62"}],"node_type":"Exists","ref_id":"63"}],"node_type":"Or","ref_id":"64"},{"children":[{"text":"\n    or "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Intervention, Order\": "}]},{"children":[{"children":[{"text":"\"Hospice Care Ambulatory\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"65"}],"node_type":"Retrieve","ref_id":"65"},{"children":[{"text":" HospiceOrder"}]}],"ref_id":"66"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"HospiceOrder"}]}],"ref_id":"67"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"authorDatetime"}]}],"node_type":"Property","ref_id":"68"}],"node_type":"Property","ref_id":"68"},{"children":[{"text":" during day of "}],"ref_id":"70"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"69"}],"ref_id":"70"}],"ref_id":"70"}],"node_type":"Query","ref_id":"71"},{"children":[{"text":"\n    )"}]}],"node_type":"Query","ref_id":"71"}],"node_type":"Exists","ref_id":"72"}],"node_type":"Or","ref_id":"73"},{"children":[{"text":"\n    or "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Intervention, Performed\": "}]},{"children":[{"children":[{"text":"\"Hospice Care Ambulatory\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"74"}],"node_type":"Retrieve","ref_id":"74"},{"children":[{"text":" HospicePerformed"}]}],"ref_id":"75"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"Global"}]}],"ref_id":"76"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"\"NormalizeInterval\" ( "}]},{"children":[{"children":[{"children":[{"text":"HospicePerformed"}]}],"ref_id":"77"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantDatetime"}]}],"node_type":"Property","ref_id":"78"}],"node_type":"Property","ref_id":"78"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"HospicePerformed"}]}],"ref_id":"79"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"80"}],"node_type":"Property","ref_id":"80"},{"children":[{"text":" )"}]}],"node_type":"FunctionRef","ref_id":"81"}],"node_type":"FunctionRef","ref_id":"81"},{"children":[{"text":" overlaps day of "}],"ref_id":"83"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"82"}],"ref_id":"83"}],"ref_id":"83"}],"node_type":"Query","ref_id":"84"},{"children":[{"text":"\n    )"}]}],"node_type":"Query","ref_id":"84"}],"node_type":"Exists","ref_id":"85"}],"node_type":"Or","ref_id":"86"},{"children":[{"text":"\n  or "}]},{"children":[{"children":[{"text":"exists "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Diagnosis\": "}]},{"children":[{"children":[{"text":"\"Hospice Diagnosis\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"87"}],"node_type":"Retrieve","ref_id":"87"},{"children":[{"text":" HospiceCareDiagnosis"}]}],"ref_id":"88"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"HospiceCareDiagnosis"}]}],"ref_id":"89"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"prevalencePeriod"}]}],"node_type":"Property","ref_id":"90"}],"node_type":"Property","ref_id":"90"},{"children":[{"text":" overlaps day of "}],"ref_id":"92"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"91"}],"ref_id":"92"}],"ref_id":"92"}],"node_type":"Query","ref_id":"93"},{"children":[{"text":"\n    )"}]}],"node_type":"Query","ref_id":"93"}],"node_type":"Exists","ref_id":"94"}],"node_type":"Or","ref_id":"95"}],"ref_id":"96"}],"define_name":"Has Hospice Services"}],"identifier":{"id":"HospiceQDM","version":"6.0.000"}},"is_main_library":false,"is_top_level":true,"library_name":"HospiceQDM","library_version":"6.0.000","statement_dependencies":[{"_id":"68923b7ca83e15671c2c8e3f","statement_name":"Has Hospice Services","statement_references":[{"_id":"68923b7ca83e15671c2c8e40","hqmf_id":null,"library_name":"MATGlobalCommonFunctionsQDM","statement_name":"NormalizeInterval"}]}]},{"_id":"68923b74a83e15671c2c8ba6","cql":"library MATGlobalCommonFunctionsQDM version '8.0.000'\n\n/*1. Upversion to 8.0.000 to support 2024 AU efforts.  No content changes were made from version 7.2.000 to this version 8.0.000*/\n\nusing QDM version '5.6'\n\nvalueset \"Emergency Department Visit\": 'urn:oid:2.16.840.1.113883.3.117.1.7.1.292' \nvalueset \"Encounter Inpatient\": 'urn:oid:2.16.840.1.113883.3.666.5.307' \nvalueset \"Intensive Care Unit\": 'urn:oid:2.16.840.1.113762.1.4.1029.206' \nvalueset \"Observation Services\": 'urn:oid:2.16.840.1.113762.1.4.1111.143' \nvalueset \"Outpatient Surgery Service\": 'urn:oid:2.16.840.1.113762.1.4.1110.38' \n\nparameter \"Measurement Period\" Interval\u003cDateTime\u003e\n\ncontext Patient\n\ndefine \"ED Encounter\":\n  [\"Encounter, Performed\": \"Emergency Department Visit\"]\n\ndefine \"Inpatient Encounter\":\n  [\"Encounter, Performed\": \"Encounter Inpatient\"] EncounterInpatient\n    where EncounterInpatient.relevantPeriod ends during day of \"Measurement Period\"\n\n/*@description: Returns an interval of date values extracted from the input interval of date-time values\n@comment: This function returns an interval constructed using the `date from` extractor on the start\nand end values of the input date-time interval. Note that using a precision specifier as part of a\ntiming phrase is preferred to communicate intent to perform day-level comparison, as well as for\ngeneral readability.*/\ndefine function \"ToDateInterval\"(period Interval\u003cDateTime\u003e ):\n  Interval[date from start of period, date from end of period]\n\n/*calculates the difference in calendar days between the start and end of the given interval.*/\ndefine function \"LengthInDays\"(Value Interval\u003cDateTime\u003e ):\n  difference in days between start of Value and end of Value\n\n/*returns list of all locations within an encounter, including locations for immediately prior ED visit.*/\ndefine function \"HospitalizationLocations\"(Encounter \"Encounter, Performed\" ):\n  Encounter Visit\n  \tlet EDVisit: Last([\"Encounter, Performed\": \"Emergency Department Visit\"] LastED\n  \t\t\twhere LastED.relevantPeriod ends 1 hour or less on or before start of Visit.relevantPeriod\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t)\n  \treturn if EDVisit is null then Visit.facilityLocations \n  \t\telse flatten { EDVisit.facilityLocations, Visit.facilityLocations }\n\n/*Returns the arrival time in the ED for the encounter.*/\ndefine function \"EmergencyDepartmentArrivalTime\"(Encounter \"Encounter, Performed\" ):\n  start of First((\"HospitalizationLocations\"(Encounter))HospitalLocation\n  \t\twhere HospitalLocation.code in \"Emergency Department Visit\"\n  \t\tsort by start of locationPeriod\n  ).locationPeriod\n\n/*Returns admission time for an encounter or for immediately prior emergency department visit.*/\ndefine function \"HospitalAdmissionTime\"(Encounter \"Encounter, Performed\" ):\n  start of \"Hospitalization\"(Encounter)\n\n/*Returns earliest arrival time for an encounter including any prior ED visit.*/\ndefine function \"HospitalArrivalTime\"(Encounter \"Encounter, Performed\" ):\n  start of First((\"HospitalizationLocations\"(Encounter))HospitalLocation\n  \t\tsort by start of locationPeriod\n  ).locationPeriod\n\n/*Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.*/\ndefine function \"Hospitalization\"(Encounter \"Encounter, Performed\" ):\n  Encounter Visit\n  \tlet EDVisit: Last([\"Encounter, Performed\": \"Emergency Department Visit\"] LastED\n  \t\t\twhere LastED.relevantPeriod ends 1 hour or less on or before start of Visit.relevantPeriod\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t)\n  \treturn Interval[Coalesce(start of EDVisit.relevantPeriod, start of Visit.relevantPeriod), \n  \tend of Visit.relevantPeriod]\n\n/*Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter*/\ndefine function \"HospitalizationLengthofStay\"(Encounter \"Encounter, Performed\" ):\n  LengthInDays(\"Hospitalization\"(Encounter))\n\n/*Returns the latest departure time for encounter including any prior ED visit.*/\ndefine function \"HospitalDepartureTime\"(Encounter \"Encounter, Performed\" ):\n  end of Last((\"HospitalizationLocations\"(Encounter))HospitalLocation\n  \t\tsort by start of locationPeriod\n  ).locationPeriod\n\n/*Hospital Discharge Time returns the discharge time for an encounter*/\ndefine function \"HospitalDischargeTime\"(Encounter \"Encounter, Performed\" ):\n  end of Encounter.relevantPeriod\n\n/*Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.*/\ndefine function \"HospitalizationWithObservationAndOutpatientSurgeryService\"(Encounter \"Encounter, Performed\" ):\n  Encounter Visit\n  \tlet ObsVisit: Last([\"Encounter, Performed\": \"Observation Services\"] LastObs\n  \t\t\twhere LastObs.relevantPeriod ends 1 hour or less on or before start of Visit.relevantPeriod\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t),\n  \tVisitStart: Coalesce(start of ObsVisit.relevantPeriod, start of Visit.relevantPeriod),\n  \tEDVisit: Last([\"Encounter, Performed\": \"Emergency Department Visit\"] LastED\n  \t\t\twhere LastED.relevantPeriod ends 1 hour or less on or before VisitStart\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t),\n  \tVisitStartWithED: Coalesce(start of EDVisit.relevantPeriod, VisitStart),\n  \tOutpatientSurgeryVisit: Last([\"Encounter, Performed\": \"Outpatient Surgery Service\"] LastSurgeryOP\n  \t\t\twhere LastSurgeryOP.relevantPeriod ends 1 hour or less on or before VisitStartWithED\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t)\n  \treturn Interval[Coalesce(start of OutpatientSurgeryVisit.relevantPeriod, VisitStartWithED), \n  \tend of Visit.relevantPeriod]\n\n/*Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/\ndefine function \"HospitalizationWithObservation\"(Encounter \"Encounter, Performed\" ):\n  Encounter Visit\n  \tlet ObsVisit: Last([\"Encounter, Performed\": \"Observation Services\"] LastObs\n  \t\t\twhere LastObs.relevantPeriod ends 1 hour or less on or before start of Visit.relevantPeriod\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t),\n  \tVisitStart: Coalesce(start of ObsVisit.relevantPeriod, start of Visit.relevantPeriod),\n  \tEDVisit: Last([\"Encounter, Performed\": \"Emergency Department Visit\"] LastED\n  \t\t\twhere LastED.relevantPeriod ends 1 hour or less on or before VisitStart\n  \t\t\tsort by \n  \t\t\tend of relevantPeriod\n  \t)\n  \treturn Interval[Coalesce(start of EDVisit.relevantPeriod, VisitStart), \n  \tend of Visit.relevantPeriod]\n\n/*Hospitalization with Observation Length of Stay returns the length in days from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/\ndefine function \"HospitalizationWithObservationLengthofStay\"(Encounter \"Encounter, Performed\" ):\n  \"LengthInDays\"(\"HospitalizationWithObservation\"(Encounter))\n\n/*First Inpatient Intensive Care Unit returns the first intensive care unit for the given encounter, without considering any immediately prior emergency department visit.*/\ndefine function \"FirstInpatientIntensiveCareUnit\"(Encounter \"Encounter, Performed\" ):\n  First((Encounter.facilityLocations)HospitalLocation\n      where HospitalLocation.code in \"Intensive Care Unit\"\n        and HospitalLocation.locationPeriod during Encounter.relevantPeriod\n      sort by start of locationPeriod\n  )\n\n/*Given a datetime and a period, returns the period (if a period is provided) or the interval beginning and ending on the datetime (if a datetime is provided)*/\ndefine function \"NormalizeInterval\"(pointInTime DateTime, period Interval\u003cDateTime\u003e ):\n  if pointInTime is not null then Interval[pointInTime, pointInTime]\n    else if period is not null then period \n    else null as Interval\u003cDateTime\u003e\n\n/*Given an interval, return true if the interval has a starting boundary specified (i.e. the start of the interval is not null and not the minimum DateTime value)*/\ndefine function \"HasStart\"(period Interval\u003cDateTime\u003e ):\n  not ( start of period is null\n      or start of period = minimum DateTime\n  )\n\n/*Given an interval, return true if the interval has an ending boundary specified (i.e. the end of the interval is not null and not the maximum DateTime value)*/\ndefine function \"HasEnd\"(period Interval\u003cDateTime\u003e ):\n  not ( \n    end of period is null\n      or \n      end of period = maximum DateTime\n  )\n\n/*Given an interval, return the ending point if the interval has an ending boundary specified, otherwise, return the starting point*/\ndefine function \"Latest\"(period Interval\u003cDateTime\u003e ):\n  if ( HasEnd(period)) then \n  end of period \n    else start of period\n\n/*Given an interval, return the starting point if the interval has a starting boundary specified, otherwise, return the ending point*/\ndefine function \"Earliest\"(period Interval\u003cDateTime\u003e ):\n  if ( HasStart(period)) then start of period \n    else \n  end of period\n\n/*Given a pointInTime or period, if the pointInTime is specified, returns the pointInTime, returns the ending point of the period if the period has an ending boundary specified, otherwise returns the starting point of the interval*/\ndefine function \"LatestOf\"(pointInTime DateTime, period Interval\u003cDateTime\u003e ):\n  Latest(NormalizeInterval(pointInTime, period))\n\n/*Given a pointInTime or period, if the pointInTime is specified, returns the pointInTime, returns the starting point of the period if the period has a starting boundary specified, otherwise returns the ending point of the period*/\ndefine function \"EarliestOf\"(pointInTime DateTime, period Interval\u003cDateTime\u003e ):\n  Earliest(NormalizeInterval(pointInTime, period))\n\n","elm":{"library":{"annotation":[{"translatorOptions":"EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion,DisableMethodInvocation","type":"CqlToElmInfo"},{"type":"Annotation","s":{"r":"395","s":[{"value":["","library MATGlobalCommonFunctionsQDM version '8.0.000'"]}]}}],"identifier":{"id":"MATGlobalCommonFunctionsQDM","version":"8.0.000"},"schemaIdentifier":{"id":"urn:hl7-org:elm","version":"r1"},"usings":{"def":[{"localIdentifier":"System","uri":"urn:hl7-org:elm-types:r1"},{"localId":"1","locator":"5:1-5:23","localIdentifier":"QDM","uri":"urn:healthit-gov:qdm:v5_6","version":"5.6","annotation":[{"type":"Annotation","s":{"r":"1","s":[{"value":["/*1. Upversion to 8.0.000 to support 2024 AU efforts.  No content changes were made from version 7.2.000 to this version 8.0.000*/\n","using "]},{"s":[{"value":["QDM"]}]},{"value":[" version ","'5.6'"]}]}}]}]},"parameters":{"def":[{"localId":"9","locator":"13:1-13:49","name":"Measurement Period","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"9","s":[{"value":["","parameter ","\"Measurement Period\""," "]},{"r":"8","s":[{"value":["Interval\u003c"]},{"r":"7","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]}]}}],"parameterTypeSpecifier":{"localId":"8","locator":"13:32-13:49","type":"IntervalTypeSpecifier","pointType":{"localId":"7","locator":"13:41-13:48","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},"valueSets":{"def":[{"localId":"2","locator":"7:1-7:82","name":"Emergency Department Visit","id":"2.16.840.1.113883.3.117.1.7.1.292","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"2","s":[{"value":["","valueset ","\"Emergency Department Visit\"",": ","'urn:oid:2.16.840.1.113883.3.117.1.7.1.292'"]}]}}]},{"localId":"3","locator":"8:1-8:71","name":"Encounter Inpatient","id":"2.16.840.1.113883.3.666.5.307","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"3","s":[{"value":["","valueset ","\"Encounter Inpatient\"",": ","'urn:oid:2.16.840.1.113883.3.666.5.307'"]}]}}]},{"localId":"4","locator":"9:1-9:72","name":"Intensive Care Unit","id":"2.16.840.1.113762.1.4.1029.206","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"4","s":[{"value":["","valueset ","\"Intensive Care Unit\"",": ","'urn:oid:2.16.840.1.113762.1.4.1029.206'"]}]}}]},{"localId":"5","locator":"10:1-10:73","name":"Observation Services","id":"2.16.840.1.113762.1.4.1111.143","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"5","s":[{"value":["","valueset ","\"Observation Services\"",": ","'urn:oid:2.16.840.1.113762.1.4.1111.143'"]}]}}]},{"localId":"6","locator":"11:1-11:78","name":"Outpatient Surgery Service","id":"2.16.840.1.113762.1.4.1110.38","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"6","s":[{"value":["","valueset ","\"Outpatient Surgery Service\"",": ","'urn:oid:2.16.840.1.113762.1.4.1110.38'"]}]}}]}]},"contexts":{"def":[{"locator":"15:1-15:15","name":"Patient"}]},"statements":{"def":[{"locator":"15:1-15:15","name":"Patient","context":"Patient","expression":{"type":"SingletonFrom","operand":{"locator":"15:1-15:15","dataType":"{urn:healthit-gov:qdm:v5_6}Patient","templateId":"Patient","type":"Retrieve"}}},{"localId":"11","locator":"17:1-18:56","name":"ED Encounter","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"11","s":[{"value":["","define ","\"ED Encounter\"",":\n  "]},{"r":"10","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Emergency Department Visit\""]}]},{"value":["]"]}]}]}}],"expression":{"localId":"10","locator":"18:3-18:56","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"18:28-18:55","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}},{"localId":"19","locator":"20:1-22:83","name":"Inpatient Encounter","context":"Patient","accessLevel":"Public","annotation":[{"type":"Annotation","s":{"r":"19","s":[{"value":["","define ","\"Inpatient Encounter\"",":\n  "]},{"r":"18","s":[{"s":[{"r":"13","s":[{"r":"12","s":[{"r":"12","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Encounter Inpatient\""]}]},{"value":["]"]}]}]},{"value":[" ","EncounterInpatient"]}]}]},{"value":["\n    "]},{"r":"17","s":[{"value":["where "]},{"r":"17","s":[{"r":"15","s":[{"r":"14","s":[{"value":["EncounterInpatient"]}]},{"value":["."]},{"r":"15","s":[{"value":["relevantPeriod"]}]}]},{"r":"17","value":[" ","ends during day of"," "]},{"r":"16","s":[{"value":["\"Measurement Period\""]}]}]}]}]}]}}],"expression":{"localId":"18","locator":"21:3-22:83","type":"Query","source":[{"localId":"13","locator":"21:3-21:68","alias":"EncounterInpatient","expression":{"localId":"12","locator":"21:3-21:49","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"21:28-21:48","name":"Encounter Inpatient","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"17","locator":"22:5-22:83","precision":"Day","type":"In","operand":[{"locator":"22:45-22:48","type":"End","operand":{"localId":"15","locator":"22:11-22:43","path":"relevantPeriod","scope":"EncounterInpatient","type":"Property"}},{"localId":"16","locator":"22:64-22:83","name":"Measurement Period","type":"ParameterRef"}]}}},{"localId":"29","locator":"29:1-30:62","name":"ToDateInterval","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","t":[{"name":"description","value":"Returns an interval of date values extracted from the input interval of date-time values"},{"name":"description","value":"Returns an interval of date values extracted from the input interval of date-time values"},{"name":"comment","value":"This function returns an interval constructed using the `date from` extractor on the start\nand end values of the input date-time interval. Note that using a precision specifier as part of a\ntiming phrase is preferred to communicate intent to perform day-level comparison, as well as for\ngeneral readability."}],"s":{"r":"29","s":[{"value":["/*@description: Returns an interval of date values extracted from the input interval of date-time values\n@comment: This function returns an interval constructed using the `date from` extractor on the start\nand end values of the input date-time interval. Note that using a precision specifier as part of a\ntiming phrase is preferred to communicate intent to perform day-level comparison, as well as for\ngeneral readability.*/\n","define function ","\"ToDateInterval\"","(","period"," "]},{"r":"21","s":[{"value":["Interval\u003c"]},{"r":"20","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"28","s":[{"r":"28","s":[{"value":["Interval["]},{"r":"24","s":[{"value":["date from "]},{"r":"23","s":[{"value":["start of "]},{"r":"22","s":[{"value":["period"]}]}]}]},{"value":[", "]},{"r":"27","s":[{"value":["date from "]},{"r":"26","s":[{"value":["end of "]},{"r":"25","s":[{"value":["period"]}]}]}]},{"value":["]"]}]}]}]}}],"expression":{"localId":"28","locator":"30:3-30:62","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"24","locator":"30:12-30:36","type":"DateFrom","operand":{"localId":"23","locator":"30:22-30:36","type":"Start","operand":{"localId":"22","locator":"30:31-30:36","name":"period","type":"OperandRef"}}},"high":{"localId":"27","locator":"30:39-30:61","type":"DateFrom","operand":{"localId":"26","locator":"30:49-30:61","type":"End","operand":{"localId":"25","locator":"30:56-30:61","name":"period","type":"OperandRef"}}}},"operand":[{"name":"period","operandTypeSpecifier":{"localId":"21","locator":"29:41-29:58","type":"IntervalTypeSpecifier","pointType":{"localId":"20","locator":"29:50-29:57","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"37","locator":"33:1-34:60","name":"LengthInDays","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"37","s":[{"value":["/*calculates the difference in calendar days between the start and end of the given interval.*/\n","define function ","\"LengthInDays\"","(","Value"," "]},{"r":"31","s":[{"value":["Interval\u003c"]},{"r":"30","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"36","s":[{"r":"36","s":[{"value":["difference in days between "]},{"r":"33","s":[{"value":["start of "]},{"r":"32","s":[{"value":["Value"]}]}]},{"value":[" and "]},{"r":"35","s":[{"value":["end of "]},{"r":"34","s":[{"value":["Value"]}]}]}]}]}]}}],"expression":{"localId":"36","locator":"34:3-34:60","precision":"Day","type":"DifferenceBetween","operand":[{"localId":"33","locator":"34:30-34:43","type":"Start","operand":{"localId":"32","locator":"34:39-34:43","name":"Value","type":"OperandRef"}},{"localId":"35","locator":"34:49-34:60","type":"End","operand":{"localId":"34","locator":"34:56-34:60","name":"Value","type":"OperandRef"}}]},"operand":[{"name":"Value","operandTypeSpecifier":{"localId":"31","locator":"33:38-33:55","type":"IntervalTypeSpecifier","pointType":{"localId":"30","locator":"33:47-33:54","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"70","locator":"37:1-45:71","name":"HospitalizationLocations","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"70","s":[{"value":["/*returns list of all locations within an encounter, including locations for immediately prior ED visit.*/\n","define function ","\"HospitalizationLocations\"","(","Encounter"," "]},{"r":"38","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"69","s":[{"r":"69","s":[{"s":[{"r":"40","s":[{"r":"39","s":[{"s":[{"value":["Encounter"]}]}]},{"value":[" ","Visit"]}]}]},{"value":["\n  \t"]},{"s":[{"value":["let "]},{"r":"56","s":[{"value":["EDVisit",": "]},{"r":"55","s":[{"value":["Last","("]},{"r":"54","s":[{"s":[{"r":"42","s":[{"r":"41","s":[{"r":"41","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Emergency Department Visit\""]}]},{"value":["]"]}]}]},{"value":[" ","LastED"]}]}]},{"value":["\n  \t\t\t"]},{"r":"49","s":[{"value":["where "]},{"r":"49","s":[{"r":"44","s":[{"r":"43","s":[{"value":["LastED"]}]},{"value":["."]},{"r":"44","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"49","s":[{"value":["ends "]},{"r":"48","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"47","s":[{"value":["start of "]},{"r":"46","s":[{"r":"45","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"46","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"53","s":[{"value":["sort by \n  \t\t\t"]},{"r":"52","s":[{"r":"51","s":[{"value":["end of "]},{"r":"50","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]}]},{"value":["\n  \t"]},{"r":"68","s":[{"value":["return "]},{"r":"67","s":[{"value":["if "]},{"r":"58","s":[{"r":"57","s":[{"value":["EDVisit"]}]},{"value":[" is null"]}]},{"value":[" then "]},{"r":"60","s":[{"r":"59","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"60","s":[{"value":["facilityLocations"]}]}]},{"value":[" \n  \t\telse "]},{"r":"66","s":[{"value":["flatten "]},{"r":"65","s":[{"value":["{ "]},{"r":"62","s":[{"r":"61","s":[{"value":["EDVisit"]}]},{"value":["."]},{"r":"62","s":[{"value":["facilityLocations"]}]}]},{"value":[", "]},{"r":"64","s":[{"r":"63","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"64","s":[{"value":["facilityLocations"]}]}]},{"value":[" }"]}]}]}]}]}]}]}]}}],"expression":{"localId":"69","locator":"38:3-45:71","type":"Query","source":[{"localId":"40","locator":"38:3-38:17","alias":"Visit","expression":{"localId":"39","locator":"38:3-38:11","name":"Encounter","type":"OperandRef"}}],"let":[{"localId":"56","locator":"39:8-43:4","identifier":"EDVisit","expression":{"localId":"55","locator":"39:17-43:4","type":"Last","source":{"localId":"54","locator":"39:22-42:26","type":"Query","source":[{"localId":"42","locator":"39:22-39:82","alias":"LastED","expression":{"localId":"41","locator":"39:22-39:75","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"39:47-39:74","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"49","locator":"40:6-40:95","type":"And","operand":[{"locator":"40:39-40:52","type":"In","operand":[{"locator":"40:34-40:37","type":"End","operand":{"localId":"44","locator":"40:12-40:32","path":"relevantPeriod","scope":"LastED","type":"Property"}},{"locator":"40:39-40:52","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"40:67-40:95","type":"Subtract","operand":[{"localId":"47","locator":"40:67-40:95","type":"Start","operand":{"localId":"46","locator":"40:76-40:95","path":"relevantPeriod","scope":"Visit","type":"Property"}},{"localId":"48","locator":"40:39-40:44","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"47","locator":"40:67-40:95","type":"Start","operand":{"localId":"46","locator":"40:76-40:95","path":"relevantPeriod","scope":"Visit","type":"Property"}}}]},{"locator":"40:39-40:52","type":"Not","operand":{"locator":"40:39-40:52","type":"IsNull","operand":{"localId":"47","locator":"40:67-40:95","type":"Start","operand":{"localId":"46","locator":"40:76-40:95","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}]},"sort":{"localId":"53","locator":"41:6-42:26","by":[{"localId":"52","locator":"42:6-42:26","direction":"asc","type":"ByExpression","expression":{"localId":"51","locator":"42:6-42:26","type":"End","operand":{"localId":"50","locator":"42:13-42:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}}],"relationship":[],"return":{"localId":"68","locator":"44:4-45:71","expression":{"localId":"67","locator":"44:11-45:71","type":"If","condition":{"localId":"58","locator":"44:14-44:28","type":"IsNull","operand":{"localId":"57","locator":"44:14-44:20","name":"EDVisit","type":"QueryLetRef"}},"then":{"localId":"60","locator":"44:35-44:57","path":"facilityLocations","scope":"Visit","type":"Property"},"else":{"localId":"66","locator":"45:10-45:71","type":"Flatten","operand":{"localId":"65","locator":"45:18-45:71","type":"List","element":[{"localId":"62","locator":"45:20-45:44","path":"facilityLocations","type":"Property","source":{"localId":"61","locator":"45:20-45:26","name":"EDVisit","type":"QueryLetRef"}},{"localId":"64","locator":"45:47-45:69","path":"facilityLocations","scope":"Visit","type":"Property"}]}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"38","locator":"37:54-37:75","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"87","locator":"48:1-52:18","name":"EmergencyDepartmentArrivalTime","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"87","s":[{"value":["/*Returns the arrival time in the ED for the encounter.*/\n","define function ","\"EmergencyDepartmentArrivalTime\"","(","Encounter"," "]},{"r":"71","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"86","s":[{"r":"86","s":[{"value":["start of "]},{"r":"85","s":[{"r":"84","s":[{"value":["First","("]},{"r":"83","s":[{"s":[{"r":"74","s":[{"r":"73","s":[{"value":["("]},{"r":"73","s":[{"value":["\"HospitalizationLocations\"","("]},{"r":"72","s":[{"value":["Encounter"]}]},{"value":[")"]}]},{"value":[")"]}]},{"value":["HospitalLocation"]}]}]},{"value":["\n  \t\t"]},{"r":"78","s":[{"value":["where "]},{"r":"78","s":[{"r":"76","s":[{"r":"75","s":[{"value":["HospitalLocation"]}]},{"value":["."]},{"r":"76","s":[{"value":["code"]}]}]},{"value":[" in "]},{"r":"77","s":[{"value":["\"Emergency Department Visit\""]}]}]}]},{"value":["\n  \t\t"]},{"r":"82","s":[{"value":["sort by "]},{"r":"81","s":[{"r":"80","s":[{"value":["start of "]},{"r":"79","s":[{"value":["locationPeriod"]}]}]}]}]}]},{"value":["\n  )"]}]},{"value":["."]},{"r":"85","s":[{"value":["locationPeriod"]}]}]}]}]}]}}],"expression":{"localId":"86","locator":"49:3-52:18","type":"Start","operand":{"localId":"85","locator":"49:12-52:18","path":"locationPeriod","type":"Property","source":{"localId":"84","locator":"49:12-52:3","type":"First","source":{"localId":"83","locator":"49:18-51:35","type":"Query","source":[{"localId":"74","locator":"49:18-49:72","alias":"HospitalLocation","expression":{"localId":"73","locator":"49:18-49:56","name":"HospitalizationLocations","type":"FunctionRef","operand":[{"localId":"72","locator":"49:46-49:54","name":"Encounter","type":"OperandRef"}]}}],"relationship":[],"where":{"localId":"78","locator":"50:5-50:63","type":"InValueSet","code":{"localId":"76","locator":"50:11-50:31","path":"code","scope":"HospitalLocation","type":"Property"},"valueset":{"localId":"77","locator":"50:36-50:63","name":"Emergency Department Visit","preserve":true}},"sort":{"localId":"82","locator":"51:5-51:35","by":[{"localId":"81","locator":"51:13-51:35","direction":"asc","type":"ByExpression","expression":{"localId":"80","locator":"51:13-51:35","type":"Start","operand":{"localId":"79","locator":"51:22-51:35","name":"locationPeriod","type":"IdentifierRef"}}}]}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"71","locator":"48:60-48:81","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"122","locator":"65:1-73:31","name":"Hospitalization","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"122","s":[{"value":["/*Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.*/\n","define function ","\"Hospitalization\"","(","Encounter"," "]},{"r":"90","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"121","s":[{"r":"121","s":[{"s":[{"r":"92","s":[{"r":"91","s":[{"s":[{"value":["Encounter"]}]}]},{"value":[" ","Visit"]}]}]},{"value":["\n  \t"]},{"s":[{"value":["let "]},{"r":"108","s":[{"value":["EDVisit",": "]},{"r":"107","s":[{"value":["Last","("]},{"r":"106","s":[{"s":[{"r":"94","s":[{"r":"93","s":[{"r":"93","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Emergency Department Visit\""]}]},{"value":["]"]}]}]},{"value":[" ","LastED"]}]}]},{"value":["\n  \t\t\t"]},{"r":"101","s":[{"value":["where "]},{"r":"101","s":[{"r":"96","s":[{"r":"95","s":[{"value":["LastED"]}]},{"value":["."]},{"r":"96","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"101","s":[{"value":["ends "]},{"r":"100","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"99","s":[{"value":["start of "]},{"r":"98","s":[{"r":"97","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"98","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"105","s":[{"value":["sort by \n  \t\t\t"]},{"r":"104","s":[{"r":"103","s":[{"value":["end of "]},{"r":"102","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]}]},{"value":["\n  \t"]},{"r":"120","s":[{"value":["return "]},{"r":"119","s":[{"value":["Interval["]},{"r":"115","s":[{"value":["Coalesce","("]},{"r":"111","s":[{"value":["start of "]},{"r":"110","s":[{"r":"109","s":[{"value":["EDVisit"]}]},{"value":["."]},{"r":"110","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[", "]},{"r":"114","s":[{"value":["start of "]},{"r":"113","s":[{"r":"112","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"113","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[")"]}]},{"value":[", \n  \t"]},{"r":"118","s":[{"value":["end of "]},{"r":"117","s":[{"r":"116","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"117","s":[{"value":["relevantPeriod"]}]}]}]},{"value":["]"]}]}]}]}]}]}}],"expression":{"localId":"121","locator":"66:3-73:31","type":"Query","source":[{"localId":"92","locator":"66:3-66:17","alias":"Visit","expression":{"localId":"91","locator":"66:3-66:11","name":"Encounter","type":"OperandRef"}}],"let":[{"localId":"108","locator":"67:8-71:4","identifier":"EDVisit","expression":{"localId":"107","locator":"67:17-71:4","type":"Last","source":{"localId":"106","locator":"67:22-70:26","type":"Query","source":[{"localId":"94","locator":"67:22-67:82","alias":"LastED","expression":{"localId":"93","locator":"67:22-67:75","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"67:47-67:74","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"101","locator":"68:6-68:95","type":"And","operand":[{"locator":"68:39-68:52","type":"In","operand":[{"locator":"68:34-68:37","type":"End","operand":{"localId":"96","locator":"68:12-68:32","path":"relevantPeriod","scope":"LastED","type":"Property"}},{"locator":"68:39-68:52","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"68:67-68:95","type":"Subtract","operand":[{"localId":"99","locator":"68:67-68:95","type":"Start","operand":{"localId":"98","locator":"68:76-68:95","path":"relevantPeriod","scope":"Visit","type":"Property"}},{"localId":"100","locator":"68:39-68:44","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"99","locator":"68:67-68:95","type":"Start","operand":{"localId":"98","locator":"68:76-68:95","path":"relevantPeriod","scope":"Visit","type":"Property"}}}]},{"locator":"68:39-68:52","type":"Not","operand":{"locator":"68:39-68:52","type":"IsNull","operand":{"localId":"99","locator":"68:67-68:95","type":"Start","operand":{"localId":"98","locator":"68:76-68:95","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}]},"sort":{"localId":"105","locator":"69:6-70:26","by":[{"localId":"104","locator":"70:6-70:26","direction":"asc","type":"ByExpression","expression":{"localId":"103","locator":"70:6-70:26","type":"End","operand":{"localId":"102","locator":"70:13-70:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}}],"relationship":[],"return":{"localId":"120","locator":"72:4-73:31","expression":{"localId":"119","locator":"72:11-73:31","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"115","locator":"72:20-72:91","type":"Coalesce","operand":[{"localId":"111","locator":"72:29-72:59","type":"Start","operand":{"localId":"110","locator":"72:38-72:59","path":"relevantPeriod","type":"Property","source":{"localId":"109","locator":"72:38-72:44","name":"EDVisit","type":"QueryLetRef"}}},{"localId":"114","locator":"72:62-72:90","type":"Start","operand":{"localId":"113","locator":"72:71-72:90","path":"relevantPeriod","scope":"Visit","type":"Property"}}]},"high":{"localId":"118","locator":"73:4-73:30","type":"End","operand":{"localId":"117","locator":"73:11-73:30","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"90","locator":"65:45-65:66","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"125","locator":"55:1-56:39","name":"HospitalAdmissionTime","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"125","s":[{"value":["/*Returns admission time for an encounter or for immediately prior emergency department visit.*/\n","define function ","\"HospitalAdmissionTime\"","(","Encounter"," "]},{"r":"88","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"124","s":[{"r":"124","s":[{"value":["start of "]},{"r":"123","s":[{"value":["\"Hospitalization\"","("]},{"r":"89","s":[{"value":["Encounter"]}]},{"value":[")"]}]}]}]}]}}],"expression":{"localId":"124","locator":"56:3-56:39","type":"Start","operand":{"localId":"123","locator":"56:12-56:39","name":"Hospitalization","type":"FunctionRef","operand":[{"localId":"89","locator":"56:30-56:38","name":"Encounter","type":"OperandRef"}]}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"88","locator":"55:51-55:72","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"138","locator":"59:1-62:18","name":"HospitalArrivalTime","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"138","s":[{"value":["/*Returns earliest arrival time for an encounter including any prior ED visit.*/\n","define function ","\"HospitalArrivalTime\"","(","Encounter"," "]},{"r":"126","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"137","s":[{"r":"137","s":[{"value":["start of "]},{"r":"136","s":[{"r":"135","s":[{"value":["First","("]},{"r":"134","s":[{"s":[{"r":"129","s":[{"r":"128","s":[{"value":["("]},{"r":"128","s":[{"value":["\"HospitalizationLocations\"","("]},{"r":"127","s":[{"value":["Encounter"]}]},{"value":[")"]}]},{"value":[")"]}]},{"value":["HospitalLocation"]}]}]},{"value":["\n  \t\t"]},{"r":"133","s":[{"value":["sort by "]},{"r":"132","s":[{"r":"131","s":[{"value":["start of "]},{"r":"130","s":[{"value":["locationPeriod"]}]}]}]}]}]},{"value":["\n  )"]}]},{"value":["."]},{"r":"136","s":[{"value":["locationPeriod"]}]}]}]}]}]}}],"expression":{"localId":"137","locator":"60:3-62:18","type":"Start","operand":{"localId":"136","locator":"60:12-62:18","path":"locationPeriod","type":"Property","source":{"localId":"135","locator":"60:12-62:3","type":"First","source":{"localId":"134","locator":"60:18-61:35","type":"Query","source":[{"localId":"129","locator":"60:18-60:72","alias":"HospitalLocation","expression":{"localId":"128","locator":"60:18-60:56","name":"HospitalizationLocations","type":"FunctionRef","operand":[{"localId":"127","locator":"60:46-60:54","name":"Encounter","type":"OperandRef"}]}}],"relationship":[],"sort":{"localId":"133","locator":"61:5-61:35","by":[{"localId":"132","locator":"61:13-61:35","direction":"asc","type":"ByExpression","expression":{"localId":"131","locator":"61:13-61:35","type":"Start","operand":{"localId":"130","locator":"61:22-61:35","name":"locationPeriod","type":"IdentifierRef"}}}]}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"126","locator":"59:49-59:70","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"145","locator":"76:1-77:44","name":"HospitalizationLengthofStay","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"145","s":[{"value":["/*Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter*/\n","define function ","\"HospitalizationLengthofStay\"","(","Encounter"," "]},{"r":"141","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"144","s":[{"r":"144","s":[{"value":["LengthInDays","("]},{"r":"143","s":[{"value":["\"Hospitalization\"","("]},{"r":"142","s":[{"value":["Encounter"]}]},{"value":[")"]}]},{"value":[")"]}]}]}]}}],"expression":{"localId":"144","locator":"77:3-77:44","name":"LengthInDays","type":"FunctionRef","operand":[{"localId":"143","locator":"77:16-77:43","name":"Hospitalization","type":"FunctionRef","operand":[{"localId":"142","locator":"77:34-77:42","name":"Encounter","type":"OperandRef"}]}]},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"141","locator":"76:57-76:78","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"158","locator":"80:1-83:18","name":"HospitalDepartureTime","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"158","s":[{"value":["/*Returns the latest departure time for encounter including any prior ED visit.*/\n","define function ","\"HospitalDepartureTime\"","(","Encounter"," "]},{"r":"146","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"157","s":[{"r":"157","s":[{"value":["end of "]},{"r":"156","s":[{"r":"155","s":[{"value":["Last","("]},{"r":"154","s":[{"s":[{"r":"149","s":[{"r":"148","s":[{"value":["("]},{"r":"148","s":[{"value":["\"HospitalizationLocations\"","("]},{"r":"147","s":[{"value":["Encounter"]}]},{"value":[")"]}]},{"value":[")"]}]},{"value":["HospitalLocation"]}]}]},{"value":["\n  \t\t"]},{"r":"153","s":[{"value":["sort by "]},{"r":"152","s":[{"r":"151","s":[{"value":["start of "]},{"r":"150","s":[{"value":["locationPeriod"]}]}]}]}]}]},{"value":["\n  )"]}]},{"value":["."]},{"r":"156","s":[{"value":["locationPeriod"]}]}]}]}]}]}}],"expression":{"localId":"157","locator":"81:3-83:18","type":"End","operand":{"localId":"156","locator":"81:10-83:18","path":"locationPeriod","type":"Property","source":{"localId":"155","locator":"81:10-83:3","type":"Last","source":{"localId":"154","locator":"81:15-82:35","type":"Query","source":[{"localId":"149","locator":"81:15-81:69","alias":"HospitalLocation","expression":{"localId":"148","locator":"81:15-81:53","name":"HospitalizationLocations","type":"FunctionRef","operand":[{"localId":"147","locator":"81:43-81:51","name":"Encounter","type":"OperandRef"}]}}],"relationship":[],"sort":{"localId":"153","locator":"82:5-82:35","by":[{"localId":"152","locator":"82:13-82:35","direction":"asc","type":"ByExpression","expression":{"localId":"151","locator":"82:13-82:35","type":"Start","operand":{"localId":"150","locator":"82:22-82:35","name":"locationPeriod","type":"IdentifierRef"}}}]}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"146","locator":"80:51-80:72","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"163","locator":"86:1-87:33","name":"HospitalDischargeTime","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"163","s":[{"value":["/*Hospital Discharge Time returns the discharge time for an encounter*/\n","define function ","\"HospitalDischargeTime\"","(","Encounter"," "]},{"r":"159","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"162","s":[{"r":"162","s":[{"value":["end of "]},{"r":"161","s":[{"r":"160","s":[{"value":["Encounter"]}]},{"value":["."]},{"r":"161","s":[{"value":["relevantPeriod"]}]}]}]}]}]}}],"expression":{"localId":"162","locator":"87:3-87:33","type":"End","operand":{"localId":"161","locator":"87:10-87:33","path":"relevantPeriod","type":"Property","source":{"localId":"160","locator":"87:10-87:18","name":"Encounter","type":"OperandRef"}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"159","locator":"86:51-86:72","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"236","locator":"90:1-110:31","name":"HospitalizationWithObservationAndOutpatientSurgeryService","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"236","s":[{"value":["/*Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.*/\n","define function ","\"HospitalizationWithObservationAndOutpatientSurgeryService\"","(","Encounter"," "]},{"r":"164","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"235","s":[{"r":"235","s":[{"s":[{"r":"166","s":[{"r":"165","s":[{"s":[{"value":["Encounter"]}]}]},{"value":[" ","Visit"]}]}]},{"value":["\n  \t"]},{"s":[{"value":["let "]},{"r":"182","s":[{"value":["ObsVisit",": "]},{"r":"181","s":[{"value":["Last","("]},{"r":"180","s":[{"s":[{"r":"168","s":[{"r":"167","s":[{"r":"167","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Observation Services\""]}]},{"value":["]"]}]}]},{"value":[" ","LastObs"]}]}]},{"value":["\n  \t\t\t"]},{"r":"175","s":[{"value":["where "]},{"r":"175","s":[{"r":"170","s":[{"r":"169","s":[{"value":["LastObs"]}]},{"value":["."]},{"r":"170","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"175","s":[{"value":["ends "]},{"r":"174","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"173","s":[{"value":["start of "]},{"r":"172","s":[{"r":"171","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"172","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"179","s":[{"value":["sort by \n  \t\t\t"]},{"r":"178","s":[{"r":"177","s":[{"value":["end of "]},{"r":"176","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]},{"value":[",\n  \t"]},{"r":"190","s":[{"value":["VisitStart",": "]},{"r":"189","s":[{"value":["Coalesce","("]},{"r":"185","s":[{"value":["start of "]},{"r":"184","s":[{"r":"183","s":[{"value":["ObsVisit"]}]},{"value":["."]},{"r":"184","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[", "]},{"r":"188","s":[{"value":["start of "]},{"r":"187","s":[{"r":"186","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"187","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[")"]}]}]},{"value":[",\n  \t"]},{"r":"204","s":[{"value":["EDVisit",": "]},{"r":"203","s":[{"value":["Last","("]},{"r":"202","s":[{"s":[{"r":"192","s":[{"r":"191","s":[{"r":"191","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Emergency Department Visit\""]}]},{"value":["]"]}]}]},{"value":[" ","LastED"]}]}]},{"value":["\n  \t\t\t"]},{"r":"197","s":[{"value":["where "]},{"r":"197","s":[{"r":"194","s":[{"r":"193","s":[{"value":["LastED"]}]},{"value":["."]},{"r":"194","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"197","s":[{"value":["ends "]},{"r":"196","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"195","s":[{"value":["VisitStart"]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"201","s":[{"value":["sort by \n  \t\t\t"]},{"r":"200","s":[{"r":"199","s":[{"value":["end of "]},{"r":"198","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]},{"value":[",\n  \t"]},{"r":"210","s":[{"value":["VisitStartWithED",": "]},{"r":"209","s":[{"value":["Coalesce","("]},{"r":"207","s":[{"value":["start of "]},{"r":"206","s":[{"r":"205","s":[{"value":["EDVisit"]}]},{"value":["."]},{"r":"206","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[", "]},{"r":"208","s":[{"value":["VisitStart"]}]},{"value":[")"]}]}]},{"value":[",\n  \t"]},{"r":"224","s":[{"value":["OutpatientSurgeryVisit",": "]},{"r":"223","s":[{"value":["Last","("]},{"r":"222","s":[{"s":[{"r":"212","s":[{"r":"211","s":[{"r":"211","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Outpatient Surgery Service\""]}]},{"value":["]"]}]}]},{"value":[" ","LastSurgeryOP"]}]}]},{"value":["\n  \t\t\t"]},{"r":"217","s":[{"value":["where "]},{"r":"217","s":[{"r":"214","s":[{"r":"213","s":[{"value":["LastSurgeryOP"]}]},{"value":["."]},{"r":"214","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"217","s":[{"value":["ends "]},{"r":"216","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"215","s":[{"value":["VisitStartWithED"]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"221","s":[{"value":["sort by \n  \t\t\t"]},{"r":"220","s":[{"r":"219","s":[{"value":["end of "]},{"r":"218","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]}]},{"value":["\n  \t"]},{"r":"234","s":[{"value":["return "]},{"r":"233","s":[{"value":["Interval["]},{"r":"229","s":[{"value":["Coalesce","("]},{"r":"227","s":[{"value":["start of "]},{"r":"226","s":[{"r":"225","s":[{"value":["OutpatientSurgeryVisit"]}]},{"value":["."]},{"r":"226","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[", "]},{"r":"228","s":[{"value":["VisitStartWithED"]}]},{"value":[")"]}]},{"value":[", \n  \t"]},{"r":"232","s":[{"value":["end of "]},{"r":"231","s":[{"r":"230","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"231","s":[{"value":["relevantPeriod"]}]}]}]},{"value":["]"]}]}]}]}]}]}}],"expression":{"localId":"235","locator":"91:3-110:31","type":"Query","source":[{"localId":"166","locator":"91:3-91:17","alias":"Visit","expression":{"localId":"165","locator":"91:3-91:11","name":"Encounter","type":"OperandRef"}}],"let":[{"localId":"182","locator":"92:8-96:4","identifier":"ObsVisit","expression":{"localId":"181","locator":"92:18-96:4","type":"Last","source":{"localId":"180","locator":"92:23-95:26","type":"Query","source":[{"localId":"168","locator":"92:23-92:78","alias":"LastObs","expression":{"localId":"167","locator":"92:23-92:70","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"92:48-92:69","name":"Observation Services","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"175","locator":"93:6-93:96","type":"And","operand":[{"locator":"93:40-93:53","type":"In","operand":[{"locator":"93:35-93:38","type":"End","operand":{"localId":"170","locator":"93:12-93:33","path":"relevantPeriod","scope":"LastObs","type":"Property"}},{"locator":"93:40-93:53","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"93:68-93:96","type":"Subtract","operand":[{"localId":"173","locator":"93:68-93:96","type":"Start","operand":{"localId":"172","locator":"93:77-93:96","path":"relevantPeriod","scope":"Visit","type":"Property"}},{"localId":"174","locator":"93:40-93:45","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"173","locator":"93:68-93:96","type":"Start","operand":{"localId":"172","locator":"93:77-93:96","path":"relevantPeriod","scope":"Visit","type":"Property"}}}]},{"locator":"93:40-93:53","type":"Not","operand":{"locator":"93:40-93:53","type":"IsNull","operand":{"localId":"173","locator":"93:68-93:96","type":"Start","operand":{"localId":"172","locator":"93:77-93:96","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}]},"sort":{"localId":"179","locator":"94:6-95:26","by":[{"localId":"178","locator":"95:6-95:26","direction":"asc","type":"ByExpression","expression":{"localId":"177","locator":"95:6-95:26","type":"End","operand":{"localId":"176","locator":"95:13-95:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}},{"localId":"190","locator":"97:4-97:88","identifier":"VisitStart","expression":{"localId":"189","locator":"97:16-97:88","type":"Coalesce","operand":[{"localId":"185","locator":"97:25-97:56","type":"Start","operand":{"localId":"184","locator":"97:34-97:56","path":"relevantPeriod","type":"Property","source":{"localId":"183","locator":"97:34-97:41","name":"ObsVisit","type":"QueryLetRef"}}},{"localId":"188","locator":"97:59-97:87","type":"Start","operand":{"localId":"187","locator":"97:68-97:87","path":"relevantPeriod","scope":"Visit","type":"Property"}}]}},{"localId":"204","locator":"98:4-102:4","identifier":"EDVisit","expression":{"localId":"203","locator":"98:13-102:4","type":"Last","source":{"localId":"202","locator":"98:18-101:26","type":"Query","source":[{"localId":"192","locator":"98:18-98:78","alias":"LastED","expression":{"localId":"191","locator":"98:18-98:71","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"98:43-98:70","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"197","locator":"99:6-99:76","type":"And","operand":[{"locator":"99:39-99:52","type":"In","operand":[{"locator":"99:34-99:37","type":"End","operand":{"localId":"194","locator":"99:12-99:32","path":"relevantPeriod","scope":"LastED","type":"Property"}},{"locator":"99:39-99:52","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"99:67-99:76","type":"Subtract","operand":[{"localId":"195","locator":"99:67-99:76","name":"VisitStart","type":"QueryLetRef"},{"localId":"196","locator":"99:39-99:44","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"195","locator":"99:67-99:76","name":"VisitStart","type":"QueryLetRef"}}]},{"locator":"99:39-99:52","type":"Not","operand":{"locator":"99:39-99:52","type":"IsNull","operand":{"localId":"195","locator":"99:67-99:76","name":"VisitStart","type":"QueryLetRef"}}}]},"sort":{"localId":"201","locator":"100:6-101:26","by":[{"localId":"200","locator":"101:6-101:26","direction":"asc","type":"ByExpression","expression":{"localId":"199","locator":"101:6-101:26","type":"End","operand":{"localId":"198","locator":"101:13-101:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}},{"localId":"210","locator":"103:4-103:74","identifier":"VisitStartWithED","expression":{"localId":"209","locator":"103:22-103:74","type":"Coalesce","operand":[{"localId":"207","locator":"103:31-103:61","type":"Start","operand":{"localId":"206","locator":"103:40-103:61","path":"relevantPeriod","type":"Property","source":{"localId":"205","locator":"103:40-103:46","name":"EDVisit","type":"QueryLetRef"}}},{"localId":"208","locator":"103:64-103:73","name":"VisitStart","type":"QueryLetRef"}]}},{"localId":"224","locator":"104:4-108:4","identifier":"OutpatientSurgeryVisit","expression":{"localId":"223","locator":"104:28-108:4","type":"Last","source":{"localId":"222","locator":"104:33-107:26","type":"Query","source":[{"localId":"212","locator":"104:33-104:100","alias":"LastSurgeryOP","expression":{"localId":"211","locator":"104:33-104:86","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"104:58-104:85","name":"Outpatient Surgery Service","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"217","locator":"105:6-105:89","type":"And","operand":[{"locator":"105:46-105:59","type":"In","operand":[{"locator":"105:41-105:44","type":"End","operand":{"localId":"214","locator":"105:12-105:39","path":"relevantPeriod","scope":"LastSurgeryOP","type":"Property"}},{"locator":"105:46-105:59","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"105:74-105:89","type":"Subtract","operand":[{"localId":"215","locator":"105:74-105:89","name":"VisitStartWithED","type":"QueryLetRef"},{"localId":"216","locator":"105:46-105:51","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"215","locator":"105:74-105:89","name":"VisitStartWithED","type":"QueryLetRef"}}]},{"locator":"105:46-105:59","type":"Not","operand":{"locator":"105:46-105:59","type":"IsNull","operand":{"localId":"215","locator":"105:74-105:89","name":"VisitStartWithED","type":"QueryLetRef"}}}]},"sort":{"localId":"221","locator":"106:6-107:26","by":[{"localId":"220","locator":"107:6-107:26","direction":"asc","type":"ByExpression","expression":{"localId":"219","locator":"107:6-107:26","type":"End","operand":{"localId":"218","locator":"107:13-107:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}}],"relationship":[],"return":{"localId":"234","locator":"109:4-110:31","expression":{"localId":"233","locator":"109:11-110:31","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"229","locator":"109:20-109:93","type":"Coalesce","operand":[{"localId":"227","locator":"109:29-109:74","type":"Start","operand":{"localId":"226","locator":"109:38-109:74","path":"relevantPeriod","type":"Property","source":{"localId":"225","locator":"109:38-109:59","name":"OutpatientSurgeryVisit","type":"QueryLetRef"}}},{"localId":"228","locator":"109:77-109:92","name":"VisitStartWithED","type":"QueryLetRef"}]},"high":{"localId":"232","locator":"110:4-110:30","type":"End","operand":{"localId":"231","locator":"110:11-110:30","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"164","locator":"90:87-90:108","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"289","locator":"113:1-127:31","name":"HospitalizationWithObservation","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"289","s":[{"value":["/*Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/\n","define function ","\"HospitalizationWithObservation\"","(","Encounter"," "]},{"r":"237","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"288","s":[{"r":"288","s":[{"s":[{"r":"239","s":[{"r":"238","s":[{"s":[{"value":["Encounter"]}]}]},{"value":[" ","Visit"]}]}]},{"value":["\n  \t"]},{"s":[{"value":["let "]},{"r":"255","s":[{"value":["ObsVisit",": "]},{"r":"254","s":[{"value":["Last","("]},{"r":"253","s":[{"s":[{"r":"241","s":[{"r":"240","s":[{"r":"240","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Observation Services\""]}]},{"value":["]"]}]}]},{"value":[" ","LastObs"]}]}]},{"value":["\n  \t\t\t"]},{"r":"248","s":[{"value":["where "]},{"r":"248","s":[{"r":"243","s":[{"r":"242","s":[{"value":["LastObs"]}]},{"value":["."]},{"r":"243","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"248","s":[{"value":["ends "]},{"r":"247","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"246","s":[{"value":["start of "]},{"r":"245","s":[{"r":"244","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"245","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"252","s":[{"value":["sort by \n  \t\t\t"]},{"r":"251","s":[{"r":"250","s":[{"value":["end of "]},{"r":"249","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]},{"value":[",\n  \t"]},{"r":"263","s":[{"value":["VisitStart",": "]},{"r":"262","s":[{"value":["Coalesce","("]},{"r":"258","s":[{"value":["start of "]},{"r":"257","s":[{"r":"256","s":[{"value":["ObsVisit"]}]},{"value":["."]},{"r":"257","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[", "]},{"r":"261","s":[{"value":["start of "]},{"r":"260","s":[{"r":"259","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"260","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[")"]}]}]},{"value":[",\n  \t"]},{"r":"277","s":[{"value":["EDVisit",": "]},{"r":"276","s":[{"value":["Last","("]},{"r":"275","s":[{"s":[{"r":"265","s":[{"r":"264","s":[{"r":"264","s":[{"value":["[","\"Encounter, Performed\"",": "]},{"s":[{"value":["\"Emergency Department Visit\""]}]},{"value":["]"]}]}]},{"value":[" ","LastED"]}]}]},{"value":["\n  \t\t\t"]},{"r":"270","s":[{"value":["where "]},{"r":"270","s":[{"r":"267","s":[{"r":"266","s":[{"value":["LastED"]}]},{"value":["."]},{"r":"267","s":[{"value":["relevantPeriod"]}]}]},{"value":[" "]},{"r":"270","s":[{"value":["ends "]},{"r":"269","s":[{"value":["1 ","hour"]}]},{"value":[" or less on or before"]}]},{"value":[" "]},{"r":"268","s":[{"value":["VisitStart"]}]}]}]},{"value":["\n  \t\t\t"]},{"r":"274","s":[{"value":["sort by \n  \t\t\t"]},{"r":"273","s":[{"r":"272","s":[{"value":["end of "]},{"r":"271","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n  \t)"]}]}]}]},{"value":["\n  \t"]},{"r":"287","s":[{"value":["return "]},{"r":"286","s":[{"value":["Interval["]},{"r":"282","s":[{"value":["Coalesce","("]},{"r":"280","s":[{"value":["start of "]},{"r":"279","s":[{"r":"278","s":[{"value":["EDVisit"]}]},{"value":["."]},{"r":"279","s":[{"value":["relevantPeriod"]}]}]}]},{"value":[", "]},{"r":"281","s":[{"value":["VisitStart"]}]},{"value":[")"]}]},{"value":[", \n  \t"]},{"r":"285","s":[{"value":["end of "]},{"r":"284","s":[{"r":"283","s":[{"value":["Visit"]}]},{"value":["."]},{"r":"284","s":[{"value":["relevantPeriod"]}]}]}]},{"value":["]"]}]}]}]}]}]}}],"expression":{"localId":"288","locator":"114:3-127:31","type":"Query","source":[{"localId":"239","locator":"114:3-114:17","alias":"Visit","expression":{"localId":"238","locator":"114:3-114:11","name":"Encounter","type":"OperandRef"}}],"let":[{"localId":"255","locator":"115:8-119:4","identifier":"ObsVisit","expression":{"localId":"254","locator":"115:18-119:4","type":"Last","source":{"localId":"253","locator":"115:23-118:26","type":"Query","source":[{"localId":"241","locator":"115:23-115:78","alias":"LastObs","expression":{"localId":"240","locator":"115:23-115:70","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"115:48-115:69","name":"Observation Services","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"248","locator":"116:6-116:96","type":"And","operand":[{"locator":"116:40-116:53","type":"In","operand":[{"locator":"116:35-116:38","type":"End","operand":{"localId":"243","locator":"116:12-116:33","path":"relevantPeriod","scope":"LastObs","type":"Property"}},{"locator":"116:40-116:53","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"116:68-116:96","type":"Subtract","operand":[{"localId":"246","locator":"116:68-116:96","type":"Start","operand":{"localId":"245","locator":"116:77-116:96","path":"relevantPeriod","scope":"Visit","type":"Property"}},{"localId":"247","locator":"116:40-116:45","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"246","locator":"116:68-116:96","type":"Start","operand":{"localId":"245","locator":"116:77-116:96","path":"relevantPeriod","scope":"Visit","type":"Property"}}}]},{"locator":"116:40-116:53","type":"Not","operand":{"locator":"116:40-116:53","type":"IsNull","operand":{"localId":"246","locator":"116:68-116:96","type":"Start","operand":{"localId":"245","locator":"116:77-116:96","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}]},"sort":{"localId":"252","locator":"117:6-118:26","by":[{"localId":"251","locator":"118:6-118:26","direction":"asc","type":"ByExpression","expression":{"localId":"250","locator":"118:6-118:26","type":"End","operand":{"localId":"249","locator":"118:13-118:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}},{"localId":"263","locator":"120:4-120:88","identifier":"VisitStart","expression":{"localId":"262","locator":"120:16-120:88","type":"Coalesce","operand":[{"localId":"258","locator":"120:25-120:56","type":"Start","operand":{"localId":"257","locator":"120:34-120:56","path":"relevantPeriod","type":"Property","source":{"localId":"256","locator":"120:34-120:41","name":"ObsVisit","type":"QueryLetRef"}}},{"localId":"261","locator":"120:59-120:87","type":"Start","operand":{"localId":"260","locator":"120:68-120:87","path":"relevantPeriod","scope":"Visit","type":"Property"}}]}},{"localId":"277","locator":"121:4-125:4","identifier":"EDVisit","expression":{"localId":"276","locator":"121:13-125:4","type":"Last","source":{"localId":"275","locator":"121:18-124:26","type":"Query","source":[{"localId":"265","locator":"121:18-121:78","alias":"LastED","expression":{"localId":"264","locator":"121:18-121:71","dataType":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","templateId":"PositiveEncounterPerformed","codeProperty":"code","codeComparator":"in","type":"Retrieve","codes":{"locator":"121:43-121:70","name":"Emergency Department Visit","preserve":true,"type":"ValueSetRef"}}}],"relationship":[],"where":{"localId":"270","locator":"122:6-122:76","type":"And","operand":[{"locator":"122:39-122:52","type":"In","operand":[{"locator":"122:34-122:37","type":"End","operand":{"localId":"267","locator":"122:12-122:32","path":"relevantPeriod","scope":"LastED","type":"Property"}},{"locator":"122:39-122:52","lowClosed":true,"highClosed":true,"type":"Interval","low":{"locator":"122:67-122:76","type":"Subtract","operand":[{"localId":"268","locator":"122:67-122:76","name":"VisitStart","type":"QueryLetRef"},{"localId":"269","locator":"122:39-122:44","value":1,"unit":"hour","type":"Quantity"}]},"high":{"localId":"268","locator":"122:67-122:76","name":"VisitStart","type":"QueryLetRef"}}]},{"locator":"122:39-122:52","type":"Not","operand":{"locator":"122:39-122:52","type":"IsNull","operand":{"localId":"268","locator":"122:67-122:76","name":"VisitStart","type":"QueryLetRef"}}}]},"sort":{"localId":"274","locator":"123:6-124:26","by":[{"localId":"273","locator":"124:6-124:26","direction":"asc","type":"ByExpression","expression":{"localId":"272","locator":"124:6-124:26","type":"End","operand":{"localId":"271","locator":"124:13-124:26","name":"relevantPeriod","type":"IdentifierRef"}}}]}}}}],"relationship":[],"return":{"localId":"287","locator":"126:4-127:31","expression":{"localId":"286","locator":"126:11-127:31","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"282","locator":"126:20-126:72","type":"Coalesce","operand":[{"localId":"280","locator":"126:29-126:59","type":"Start","operand":{"localId":"279","locator":"126:38-126:59","path":"relevantPeriod","type":"Property","source":{"localId":"278","locator":"126:38-126:44","name":"EDVisit","type":"QueryLetRef"}}},{"localId":"281","locator":"126:62-126:71","name":"VisitStart","type":"QueryLetRef"}]},"high":{"localId":"285","locator":"127:4-127:30","type":"End","operand":{"localId":"284","locator":"127:11-127:30","path":"relevantPeriod","scope":"Visit","type":"Property"}}}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"237","locator":"113:60-113:81","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"294","locator":"130:1-131:61","name":"HospitalizationWithObservationLengthofStay","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"294","s":[{"value":["/*Hospitalization with Observation Length of Stay returns the length in days from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/\n","define function ","\"HospitalizationWithObservationLengthofStay\"","(","Encounter"," "]},{"r":"290","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"293","s":[{"r":"293","s":[{"value":["\"LengthInDays\"","("]},{"r":"292","s":[{"value":["\"HospitalizationWithObservation\"","("]},{"r":"291","s":[{"value":["Encounter"]}]},{"value":[")"]}]},{"value":[")"]}]}]}]}}],"expression":{"localId":"293","locator":"131:3-131:61","name":"LengthInDays","type":"FunctionRef","operand":[{"localId":"292","locator":"131:18-131:60","name":"HospitalizationWithObservation","type":"FunctionRef","operand":[{"localId":"291","locator":"131:51-131:59","name":"Encounter","type":"OperandRef"}]}]},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"290","locator":"130:72-130:93","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"315","locator":"134:1-139:3","name":"FirstInpatientIntensiveCareUnit","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"315","s":[{"value":["/*First Inpatient Intensive Care Unit returns the first intensive care unit for the given encounter, without considering any immediately prior emergency department visit.*/\n","define function ","\"FirstInpatientIntensiveCareUnit\"","(","Encounter"," "]},{"r":"295","s":[{"value":["\"Encounter, Performed\""]}]},{"value":[" ):\n  "]},{"r":"314","s":[{"r":"314","s":[{"value":["First","("]},{"r":"313","s":[{"s":[{"r":"298","s":[{"r":"297","s":[{"value":["("]},{"r":"297","s":[{"r":"296","s":[{"value":["Encounter"]}]},{"value":["."]},{"r":"297","s":[{"value":["facilityLocations"]}]}]},{"value":[")"]}]},{"value":["HospitalLocation"]}]}]},{"value":["\n      "]},{"r":"308","s":[{"value":["where "]},{"r":"308","s":[{"r":"302","s":[{"r":"300","s":[{"r":"299","s":[{"value":["HospitalLocation"]}]},{"value":["."]},{"r":"300","s":[{"value":["code"]}]}]},{"value":[" in "]},{"r":"301","s":[{"value":["\"Intensive Care Unit\""]}]}]},{"value":["\n        and "]},{"r":"307","s":[{"r":"304","s":[{"r":"303","s":[{"value":["HospitalLocation"]}]},{"value":["."]},{"r":"304","s":[{"value":["locationPeriod"]}]}]},{"r":"307","value":[" ","during"," "]},{"r":"306","s":[{"r":"305","s":[{"value":["Encounter"]}]},{"value":["."]},{"r":"306","s":[{"value":["relevantPeriod"]}]}]}]}]}]},{"value":["\n      "]},{"r":"312","s":[{"value":["sort by "]},{"r":"311","s":[{"r":"310","s":[{"value":["start of "]},{"r":"309","s":[{"value":["locationPeriod"]}]}]}]}]}]},{"value":["\n  )"]}]}]}]}}],"expression":{"localId":"314","locator":"135:3-139:3","type":"First","source":{"localId":"313","locator":"135:9-138:37","type":"Query","source":[{"localId":"298","locator":"135:9-135:53","alias":"HospitalLocation","expression":{"localId":"297","locator":"135:9-135:37","path":"facilityLocations","type":"Property","source":{"localId":"296","locator":"135:10-135:18","name":"Encounter","type":"OperandRef"}}}],"relationship":[],"where":{"localId":"308","locator":"136:7-137:75","type":"And","operand":[{"localId":"302","locator":"136:13-136:58","type":"InValueSet","code":{"localId":"300","locator":"136:13-136:33","path":"code","scope":"HospitalLocation","type":"Property"},"valueset":{"localId":"301","locator":"136:38-136:58","name":"Intensive Care Unit","preserve":true}},{"localId":"307","locator":"137:13-137:75","type":"IncludedIn","operand":[{"localId":"304","locator":"137:13-137:43","path":"locationPeriod","scope":"HospitalLocation","type":"Property"},{"localId":"306","locator":"137:52-137:75","path":"relevantPeriod","type":"Property","source":{"localId":"305","locator":"137:52-137:60","name":"Encounter","type":"OperandRef"}}]}]},"sort":{"localId":"312","locator":"138:7-138:37","by":[{"localId":"311","locator":"138:15-138:37","direction":"asc","type":"ByExpression","expression":{"localId":"310","locator":"138:15-138:37","type":"Start","operand":{"localId":"309","locator":"138:24-138:37","name":"locationPeriod","type":"IdentifierRef"}}}]}}},"operand":[{"name":"Encounter","operandTypeSpecifier":{"localId":"295","locator":"134:61-134:82","name":"{urn:healthit-gov:qdm:v5_6}PositiveEncounterPerformed","type":"NamedTypeSpecifier"}}]},{"localId":"333","locator":"142:1-145:35","name":"NormalizeInterval","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"333","s":[{"value":["/*Given a datetime and a period, returns the period (if a period is provided) or the interval beginning and ending on the datetime (if a datetime is provided)*/\n","define function ","\"NormalizeInterval\"","(","pointInTime"," "]},{"r":"316","s":[{"value":["DateTime"]}]},{"value":[", ","period"," "]},{"r":"318","s":[{"value":["Interval\u003c"]},{"r":"317","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"332","s":[{"r":"332","s":[{"value":["if "]},{"r":"320","s":[{"r":"319","s":[{"value":["pointInTime"]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"323","s":[{"value":["Interval["]},{"r":"321","s":[{"value":["pointInTime"]}]},{"value":[", "]},{"r":"322","s":[{"value":["pointInTime"]}]},{"value":["]"]}]},{"value":["\n    else "]},{"r":"331","s":[{"value":["if "]},{"r":"325","s":[{"r":"324","s":[{"value":["period"]}]},{"value":[" is not null"]}]},{"value":[" then "]},{"r":"326","s":[{"value":["period"]}]},{"value":[" \n    else "]},{"r":"330","s":[{"r":"327","value":["null"," as "]},{"r":"329","s":[{"value":["Interval\u003c"]},{"r":"328","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]}]}]}]}]}]}}],"expression":{"localId":"332","locator":"143:3-145:35","type":"If","condition":{"localId":"320","locator":"143:6-143:28","type":"Not","operand":{"locator":"143:6-143:28","type":"IsNull","operand":{"localId":"319","locator":"143:6-143:16","name":"pointInTime","type":"OperandRef"}}},"then":{"localId":"323","locator":"143:35-143:68","lowClosed":true,"highClosed":true,"type":"Interval","low":{"localId":"321","locator":"143:44-143:54","name":"pointInTime","type":"OperandRef"},"high":{"localId":"322","locator":"143:57-143:67","name":"pointInTime","type":"OperandRef"}},"else":{"localId":"331","locator":"144:10-145:35","type":"If","condition":{"localId":"325","locator":"144:13-144:30","type":"Not","operand":{"locator":"144:13-144:30","type":"IsNull","operand":{"localId":"324","locator":"144:13-144:18","name":"period","type":"OperandRef"}}},"then":{"localId":"326","locator":"144:37-144:42","name":"period","type":"OperandRef"},"else":{"localId":"330","locator":"145:10-145:35","strict":false,"type":"As","operand":{"localId":"327","locator":"145:10-145:13","type":"Null"},"asTypeSpecifier":{"localId":"329","locator":"145:18-145:35","type":"IntervalTypeSpecifier","pointType":{"localId":"328","locator":"145:27-145:34","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}}},"operand":[{"name":"pointInTime","operandTypeSpecifier":{"localId":"316","locator":"142:49-142:56","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}},{"name":"period","operandTypeSpecifier":{"localId":"318","locator":"142:66-142:83","type":"IntervalTypeSpecifier","pointType":{"localId":"317","locator":"142:75-142:82","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"346","locator":"148:1-151:3","name":"HasStart","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"346","s":[{"value":["/*Given an interval, return true if the interval has a starting boundary specified (i.e. the start of the interval is not null and not the minimum DateTime value)*/\n","define function ","\"HasStart\"","(","period"," "]},{"r":"335","s":[{"value":["Interval\u003c"]},{"r":"334","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"345","s":[{"r":"345","s":[{"value":["not "]},{"r":"344","s":[{"value":["( "]},{"r":"344","s":[{"r":"338","s":[{"r":"337","s":[{"value":["start of "]},{"r":"336","s":[{"value":["period"]}]}]},{"value":[" is null"]}]},{"value":["\n      or "]},{"r":"343","s":[{"r":"340","s":[{"value":["start of "]},{"r":"339","s":[{"value":["period"]}]}]},{"value":[" ","="," "]},{"r":"342","s":[{"value":["minimum"," "]},{"r":"341","s":[{"value":["DateTime"]}]}]}]}]},{"value":["\n  )"]}]}]}]}]}}],"expression":{"localId":"345","locator":"149:3-151:3","type":"Not","operand":{"localId":"344","locator":"149:7-151:3","type":"Or","operand":[{"localId":"338","locator":"149:9-149:31","type":"IsNull","operand":{"localId":"337","locator":"149:9-149:23","type":"Start","operand":{"localId":"336","locator":"149:18-149:23","name":"period","type":"OperandRef"}}},{"localId":"343","locator":"150:10-150:43","type":"Equal","operand":[{"localId":"340","locator":"150:10-150:24","type":"Start","operand":{"localId":"339","locator":"150:19-150:24","name":"period","type":"OperandRef"}},{"localId":"342","locator":"150:28-150:43","valueType":"{urn:hl7-org:elm-types:r1}DateTime","type":"MinValue"}]}]}},"operand":[{"name":"period","operandTypeSpecifier":{"localId":"335","locator":"148:35-148:52","type":"IntervalTypeSpecifier","pointType":{"localId":"334","locator":"148:44-148:51","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"359","locator":"154:1-159:3","name":"HasEnd","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"359","s":[{"value":["/*Given an interval, return true if the interval has an ending boundary specified (i.e. the end of the interval is not null and not the maximum DateTime value)*/\n","define function ","\"HasEnd\"","(","period"," "]},{"r":"348","s":[{"value":["Interval\u003c"]},{"r":"347","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"358","s":[{"r":"358","s":[{"value":["not "]},{"r":"357","s":[{"value":["( \n    "]},{"r":"357","s":[{"r":"351","s":[{"r":"350","s":[{"value":["end of "]},{"r":"349","s":[{"value":["period"]}]}]},{"value":[" is null"]}]},{"value":["\n      or \n      "]},{"r":"356","s":[{"r":"353","s":[{"value":["end of "]},{"r":"352","s":[{"value":["period"]}]}]},{"value":[" ","="," "]},{"r":"355","s":[{"value":["maximum"," "]},{"r":"354","s":[{"value":["DateTime"]}]}]}]}]},{"value":["\n  )"]}]}]}]}]}}],"expression":{"localId":"358","locator":"155:3-159:3","type":"Not","operand":{"localId":"357","locator":"155:7-159:3","type":"Or","operand":[{"localId":"351","locator":"156:5-156:25","type":"IsNull","operand":{"localId":"350","locator":"156:5-156:17","type":"End","operand":{"localId":"349","locator":"156:12-156:17","name":"period","type":"OperandRef"}}},{"localId":"356","locator":"158:7-158:38","type":"Equal","operand":[{"localId":"353","locator":"158:7-158:19","type":"End","operand":{"localId":"352","locator":"158:14-158:19","name":"period","type":"OperandRef"}},{"localId":"355","locator":"158:23-158:38","valueType":"{urn:hl7-org:elm-types:r1}DateTime","type":"MaxValue"}]}]}},"operand":[{"name":"period","operandTypeSpecifier":{"localId":"348","locator":"154:33-154:50","type":"IntervalTypeSpecifier","pointType":{"localId":"347","locator":"154:42-154:49","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"369","locator":"162:1-165:24","name":"Latest","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"369","s":[{"value":["/*Given an interval, return the ending point if the interval has an ending boundary specified, otherwise, return the starting point*/\n","define function ","\"Latest\"","(","period"," "]},{"r":"361","s":[{"value":["Interval\u003c"]},{"r":"360","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"368","s":[{"r":"368","s":[{"value":["if "]},{"r":"363","s":[{"value":["( "]},{"r":"363","s":[{"value":["HasEnd","("]},{"r":"362","s":[{"value":["period"]}]},{"value":[")"]}]},{"value":[")"]}]},{"value":[" then \n  "]},{"r":"365","s":[{"value":["end of "]},{"r":"364","s":[{"value":["period"]}]}]},{"value":[" \n    else "]},{"r":"367","s":[{"value":["start of "]},{"r":"366","s":[{"value":["period"]}]}]}]}]}]}}],"expression":{"localId":"368","locator":"163:3-165:24","type":"If","condition":{"localId":"363","locator":"163:6-163:22","name":"HasEnd","type":"FunctionRef","operand":[{"localId":"362","locator":"163:15-163:20","name":"period","type":"OperandRef"}]},"then":{"localId":"365","locator":"164:3-164:15","type":"End","operand":{"localId":"364","locator":"164:10-164:15","name":"period","type":"OperandRef"}},"else":{"localId":"367","locator":"165:10-165:24","type":"Start","operand":{"localId":"366","locator":"165:19-165:24","name":"period","type":"OperandRef"}}},"operand":[{"name":"period","operandTypeSpecifier":{"localId":"361","locator":"162:33-162:50","type":"IntervalTypeSpecifier","pointType":{"localId":"360","locator":"162:42-162:49","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"379","locator":"168:1-171:15","name":"Earliest","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"379","s":[{"value":["/*Given an interval, return the starting point if the interval has a starting boundary specified, otherwise, return the ending point*/\n","define function ","\"Earliest\"","(","period"," "]},{"r":"371","s":[{"value":["Interval\u003c"]},{"r":"370","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"378","s":[{"r":"378","s":[{"value":["if "]},{"r":"373","s":[{"value":["( "]},{"r":"373","s":[{"value":["HasStart","("]},{"r":"372","s":[{"value":["period"]}]},{"value":[")"]}]},{"value":[")"]}]},{"value":[" then "]},{"r":"375","s":[{"value":["start of "]},{"r":"374","s":[{"value":["period"]}]}]},{"value":[" \n    else \n  "]},{"r":"377","s":[{"value":["end of "]},{"r":"376","s":[{"value":["period"]}]}]}]}]}]}}],"expression":{"localId":"378","locator":"169:3-171:15","type":"If","condition":{"localId":"373","locator":"169:6-169:24","name":"HasStart","type":"FunctionRef","operand":[{"localId":"372","locator":"169:17-169:22","name":"period","type":"OperandRef"}]},"then":{"localId":"375","locator":"169:31-169:45","type":"Start","operand":{"localId":"374","locator":"169:40-169:45","name":"period","type":"OperandRef"}},"else":{"localId":"377","locator":"171:3-171:15","type":"End","operand":{"localId":"376","locator":"171:10-171:15","name":"period","type":"OperandRef"}}},"operand":[{"name":"period","operandTypeSpecifier":{"localId":"371","locator":"168:35-168:52","type":"IntervalTypeSpecifier","pointType":{"localId":"370","locator":"168:44-168:51","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"387","locator":"174:1-175:48","name":"LatestOf","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"387","s":[{"value":["/*Given a pointInTime or period, if the pointInTime is specified, returns the pointInTime, returns the ending point of the period if the period has an ending boundary specified, otherwise returns the starting point of the interval*/\n","define function ","\"LatestOf\"","(","pointInTime"," "]},{"r":"380","s":[{"value":["DateTime"]}]},{"value":[", ","period"," "]},{"r":"382","s":[{"value":["Interval\u003c"]},{"r":"381","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"386","s":[{"r":"386","s":[{"value":["Latest","("]},{"r":"385","s":[{"value":["NormalizeInterval","("]},{"r":"383","s":[{"value":["pointInTime"]}]},{"value":[", "]},{"r":"384","s":[{"value":["period"]}]},{"value":[")"]}]},{"value":[")"]}]}]}]}}],"expression":{"localId":"386","locator":"175:3-175:48","name":"Latest","type":"FunctionRef","operand":[{"localId":"385","locator":"175:10-175:47","name":"NormalizeInterval","type":"FunctionRef","operand":[{"localId":"383","locator":"175:28-175:38","name":"pointInTime","type":"OperandRef"},{"localId":"384","locator":"175:41-175:46","name":"period","type":"OperandRef"}]}]},"operand":[{"name":"pointInTime","operandTypeSpecifier":{"localId":"380","locator":"174:40-174:47","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}},{"name":"period","operandTypeSpecifier":{"localId":"382","locator":"174:57-174:74","type":"IntervalTypeSpecifier","pointType":{"localId":"381","locator":"174:66-174:73","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]},{"localId":"395","locator":"178:1-179:50","name":"EarliestOf","context":"Patient","accessLevel":"Public","type":"FunctionDef","annotation":[{"type":"Annotation","s":{"r":"395","s":[{"value":["/*Given a pointInTime or period, if the pointInTime is specified, returns the pointInTime, returns the starting point of the period if the period has a starting boundary specified, otherwise returns the ending point of the period*/\n","define function ","\"EarliestOf\"","(","pointInTime"," "]},{"r":"388","s":[{"value":["DateTime"]}]},{"value":[", ","period"," "]},{"r":"390","s":[{"value":["Interval\u003c"]},{"r":"389","s":[{"value":["DateTime"]}]},{"value":["\u003e"]}]},{"value":[" ):\n  "]},{"r":"394","s":[{"r":"394","s":[{"value":["Earliest","("]},{"r":"393","s":[{"value":["NormalizeInterval","("]},{"r":"391","s":[{"value":["pointInTime"]}]},{"value":[", "]},{"r":"392","s":[{"value":["period"]}]},{"value":[")"]}]},{"value":[")"]}]}]}]}}],"expression":{"localId":"394","locator":"179:3-179:50","name":"Earliest","type":"FunctionRef","operand":[{"localId":"393","locator":"179:12-179:49","name":"NormalizeInterval","type":"FunctionRef","operand":[{"localId":"391","locator":"179:30-179:40","name":"pointInTime","type":"OperandRef"},{"localId":"392","locator":"179:43-179:48","name":"period","type":"OperandRef"}]}]},"operand":[{"name":"pointInTime","operandTypeSpecifier":{"localId":"388","locator":"178:42-178:49","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}},{"name":"period","operandTypeSpecifier":{"localId":"390","locator":"178:59-178:76","type":"IntervalTypeSpecifier","pointType":{"localId":"389","locator":"178:68-178:75","name":"{urn:hl7-org:elm-types:r1}DateTime","type":"NamedTypeSpecifier"}}}]}]}}},"elm_annotations":{"statements":[{"children":[{"children":[{"children":[{"text":"define \"ED Encounter\":\n  "}]},{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Emergency Department Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"10"}],"ref_id":"11"}],"define_name":"ED Encounter"},{"children":[{"children":[{"children":[{"text":"define \"Inpatient Encounter\":\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Encounter Inpatient\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"12"}],"node_type":"Retrieve","ref_id":"12"},{"children":[{"text":" EncounterInpatient"}]}],"ref_id":"13"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"EncounterInpatient"}]}],"ref_id":"14"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"15"}],"node_type":"Property","ref_id":"15"},{"children":[{"text":" ends during day of "}],"ref_id":"17"},{"children":[{"children":[{"text":"\"Measurement Period\""}]}],"node_type":"ParameterRef","ref_id":"16"}],"ref_id":"17"}],"ref_id":"17"}],"node_type":"Query","ref_id":"18"}],"ref_id":"19"}],"define_name":"Inpatient Encounter"},{"children":[{"children":[]},{"children":[]},{"children":[]},{"children":[{"children":[{"text":"/*@description: Returns an interval of date values extracted from the input interval of date-time values\n@comment: This function returns an interval constructed using the `date from` extractor on the start\nand end values of the input date-time interval. Note that using a precision specifier as part of a\ntiming phrase is preferred to communicate intent to perform day-level comparison, as well as for\ngeneral readability.*/\ndefine function \"ToDateInterval\"(period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"20"},{"children":[{"text":"\u003e"}]}],"ref_id":"21"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"22"}],"node_type":"Start","ref_id":"23"}],"ref_id":"24"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"date from "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"25"}],"node_type":"End","ref_id":"26"}],"ref_id":"27"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"28"}],"node_type":"Interval","ref_id":"28"}],"ref_id":"29"}],"define_name":"ToDateInterval"},{"children":[{"children":[{"children":[{"text":"/*calculates the difference in calendar days between the start and end of the given interval.*/\ndefine function \"LengthInDays\"(Value "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"30"},{"children":[{"text":"\u003e"}]}],"ref_id":"31"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"difference in days between "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"Value"}]}],"node_type":"OperandRef","ref_id":"32"}],"node_type":"Start","ref_id":"33"},{"children":[{"text":" and "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"Value"}]}],"node_type":"OperandRef","ref_id":"34"}],"node_type":"End","ref_id":"35"}],"node_type":"DifferenceBetween","ref_id":"36"}],"node_type":"DifferenceBetween","ref_id":"36"}],"ref_id":"37"}],"define_name":"LengthInDays"},{"children":[{"children":[{"children":[{"text":"/*returns list of all locations within an encounter, including locations for immediately prior ED visit.*/\ndefine function \"HospitalizationLocations\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"38"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Encounter"}]}]}],"node_type":"OperandRef","ref_id":"39"},{"children":[{"text":" Visit"}]}],"ref_id":"40"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"EDVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Emergency Department Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"41"}],"node_type":"Retrieve","ref_id":"41"},{"children":[{"text":" LastED"}]}],"ref_id":"42"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastED"}]}],"ref_id":"43"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"44"}],"node_type":"Property","ref_id":"44"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"48"},{"children":[{"text":" or less on or before"}]}],"ref_id":"49"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"45"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"46"}],"node_type":"Property","ref_id":"46"}],"node_type":"Start","ref_id":"47"}],"ref_id":"49"}],"ref_id":"49"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"50"}],"node_type":"End","ref_id":"51"}],"ref_id":"52"}],"ref_id":"53"}],"ref_id":"54"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"55"}],"ref_id":"56"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"EDVisit"}]}],"node_type":"QueryLetRef","ref_id":"57"},{"children":[{"text":" is null"}]}],"ref_id":"58"},{"children":[{"text":" then "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"59"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"facilityLocations"}]}],"ref_id":"60"}],"ref_id":"60"},{"children":[{"text":" \n      else "}]},{"children":[{"children":[{"text":"flatten "}]},{"children":[{"children":[{"text":"{ "}]},{"children":[{"children":[{"children":[{"text":"EDVisit"}]}],"ref_id":"61"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"facilityLocations"}]}],"ref_id":"62"}],"ref_id":"62"},{"children":[{"text":", "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"63"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"facilityLocations"}]}],"ref_id":"64"}],"ref_id":"64"},{"children":[{"text":" }"}]}],"node_type":"List","ref_id":"65"}],"ref_id":"66"}],"node_type":"If","ref_id":"67"}],"ref_id":"68"}],"node_type":"Query","ref_id":"69"}],"node_type":"Query","ref_id":"69"}],"ref_id":"70"}],"define_name":"HospitalizationLocations"},{"children":[{"children":[{"children":[{"text":"/*Returns the arrival time in the ED for the encounter.*/\ndefine function \"EmergencyDepartmentArrivalTime\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"71"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"First("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"\"HospitalizationLocations\"("}]},{"children":[{"children":[{"text":"Encounter"}]}],"node_type":"OperandRef","ref_id":"72"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"73"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"73"},{"children":[{"text":"HospitalLocation"}]}],"ref_id":"74"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"HospitalLocation"}]}],"ref_id":"75"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"code"}]}],"ref_id":"76"}],"ref_id":"76"},{"children":[{"text":" in "}]},{"children":[{"children":[{"text":"\"Emergency Department Visit\""}]}],"ref_id":"77"}],"ref_id":"78"}],"ref_id":"78"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"sort by "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"IdentifierRef","ref_id":"79"}],"node_type":"Start","ref_id":"80"}],"ref_id":"81"}],"ref_id":"82"}],"ref_id":"83"},{"children":[{"text":"\n  )"}]}],"ref_id":"84"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"Property","ref_id":"85"}],"node_type":"Property","ref_id":"85"}],"node_type":"Start","ref_id":"86"}],"node_type":"Start","ref_id":"86"}],"ref_id":"87"}],"define_name":"EmergencyDepartmentArrivalTime"},{"children":[{"children":[{"children":[{"text":"/*Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.*/\ndefine function \"Hospitalization\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"90"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Encounter"}]}]}],"node_type":"OperandRef","ref_id":"91"},{"children":[{"text":" Visit"}]}],"ref_id":"92"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"EDVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Emergency Department Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"93"}],"node_type":"Retrieve","ref_id":"93"},{"children":[{"text":" LastED"}]}],"ref_id":"94"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastED"}]}],"ref_id":"95"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"96"}],"node_type":"Property","ref_id":"96"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"100"},{"children":[{"text":" or less on or before"}]}],"ref_id":"101"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"97"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"98"}],"node_type":"Property","ref_id":"98"}],"node_type":"Start","ref_id":"99"}],"ref_id":"101"}],"ref_id":"101"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"102"}],"node_type":"End","ref_id":"103"}],"ref_id":"104"}],"ref_id":"105"}],"ref_id":"106"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"107"}],"ref_id":"108"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"EDVisit"}]}],"ref_id":"109"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"110"}],"node_type":"Property","ref_id":"110"}],"node_type":"Start","ref_id":"111"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"112"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"113"}],"node_type":"Property","ref_id":"113"}],"node_type":"Start","ref_id":"114"},{"children":[{"text":")"}]}],"ref_id":"115"},{"children":[{"text":", \n    "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"116"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"117"}],"node_type":"Property","ref_id":"117"}],"ref_id":"118"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"119"}],"ref_id":"120"}],"node_type":"Query","ref_id":"121"}],"node_type":"Query","ref_id":"121"}],"ref_id":"122"}],"define_name":"Hospitalization"},{"children":[{"children":[{"children":[{"text":"/*Returns admission time for an encounter or for immediately prior emergency department visit.*/\ndefine function \"HospitalAdmissionTime\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"88"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"\"Hospitalization\"("}]},{"children":[{"children":[{"text":"Encounter"}]}],"node_type":"OperandRef","ref_id":"89"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"123"}],"node_type":"Start","ref_id":"124"}],"node_type":"Start","ref_id":"124"}],"ref_id":"125"}],"define_name":"HospitalAdmissionTime"},{"children":[{"children":[{"children":[{"text":"/*Returns earliest arrival time for an encounter including any prior ED visit.*/\ndefine function \"HospitalArrivalTime\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"126"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"First("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"\"HospitalizationLocations\"("}]},{"children":[{"children":[{"text":"Encounter"}]}],"node_type":"OperandRef","ref_id":"127"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"128"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"128"},{"children":[{"text":"HospitalLocation"}]}],"ref_id":"129"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"sort by "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"IdentifierRef","ref_id":"130"}],"node_type":"Start","ref_id":"131"}],"ref_id":"132"}],"ref_id":"133"}],"ref_id":"134"},{"children":[{"text":"\n  )"}]}],"ref_id":"135"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"Property","ref_id":"136"}],"node_type":"Property","ref_id":"136"}],"node_type":"Start","ref_id":"137"}],"node_type":"Start","ref_id":"137"}],"ref_id":"138"}],"define_name":"HospitalArrivalTime"},{"children":[{"children":[{"children":[{"text":"/*Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter*/\ndefine function \"HospitalizationLengthofStay\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"141"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"LengthInDays("}]},{"children":[{"children":[{"text":"\"Hospitalization\"("}]},{"children":[{"children":[{"text":"Encounter"}]}],"node_type":"OperandRef","ref_id":"142"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"143"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"144"}],"node_type":"FunctionRef","ref_id":"144"}],"ref_id":"145"}],"define_name":"HospitalizationLengthofStay"},{"children":[{"children":[{"children":[{"text":"/*Returns the latest departure time for encounter including any prior ED visit.*/\ndefine function \"HospitalDepartureTime\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"146"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"text":"\"HospitalizationLocations\"("}]},{"children":[{"children":[{"text":"Encounter"}]}],"node_type":"OperandRef","ref_id":"147"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"148"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"148"},{"children":[{"text":"HospitalLocation"}]}],"ref_id":"149"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"sort by "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"IdentifierRef","ref_id":"150"}],"node_type":"Start","ref_id":"151"}],"ref_id":"152"}],"ref_id":"153"}],"ref_id":"154"},{"children":[{"text":"\n  )"}]}],"ref_id":"155"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"Property","ref_id":"156"}],"node_type":"Property","ref_id":"156"}],"node_type":"End","ref_id":"157"}],"node_type":"End","ref_id":"157"}],"ref_id":"158"}],"define_name":"HospitalDepartureTime"},{"children":[{"children":[{"children":[{"text":"/*Hospital Discharge Time returns the discharge time for an encounter*/\ndefine function \"HospitalDischargeTime\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"159"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Encounter"}]}],"ref_id":"160"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"161"}],"node_type":"Property","ref_id":"161"}],"node_type":"End","ref_id":"162"}],"node_type":"End","ref_id":"162"}],"ref_id":"163"}],"define_name":"HospitalDischargeTime"},{"children":[{"children":[{"children":[{"text":"/*Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.*/\ndefine function \"HospitalizationWithObservationAndOutpatientSurgeryService\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"164"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Encounter"}]}]}],"node_type":"OperandRef","ref_id":"165"},{"children":[{"text":" Visit"}]}],"ref_id":"166"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"ObsVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Observation Services\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"167"}],"node_type":"Retrieve","ref_id":"167"},{"children":[{"text":" LastObs"}]}],"ref_id":"168"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastObs"}]}],"ref_id":"169"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"170"}],"node_type":"Property","ref_id":"170"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"174"},{"children":[{"text":" or less on or before"}]}],"ref_id":"175"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"171"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"172"}],"node_type":"Property","ref_id":"172"}],"node_type":"Start","ref_id":"173"}],"ref_id":"175"}],"ref_id":"175"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"176"}],"node_type":"End","ref_id":"177"}],"ref_id":"178"}],"ref_id":"179"}],"ref_id":"180"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"181"}],"ref_id":"182"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"VisitStart: "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"ObsVisit"}]}],"ref_id":"183"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"184"}],"node_type":"Property","ref_id":"184"}],"node_type":"Start","ref_id":"185"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"186"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"187"}],"node_type":"Property","ref_id":"187"}],"node_type":"Start","ref_id":"188"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"189"}],"ref_id":"190"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"EDVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Emergency Department Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"191"}],"node_type":"Retrieve","ref_id":"191"},{"children":[{"text":" LastED"}]}],"ref_id":"192"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastED"}]}],"ref_id":"193"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"194"}],"node_type":"Property","ref_id":"194"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"196"},{"children":[{"text":" or less on or before"}]}],"ref_id":"197"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"VisitStart"}]}],"node_type":"QueryLetRef","ref_id":"195"}],"ref_id":"197"}],"ref_id":"197"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"198"}],"node_type":"End","ref_id":"199"}],"ref_id":"200"}],"ref_id":"201"}],"ref_id":"202"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"203"}],"ref_id":"204"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"VisitStartWithED: "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"EDVisit"}]}],"ref_id":"205"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"206"}],"node_type":"Property","ref_id":"206"}],"node_type":"Start","ref_id":"207"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"VisitStart"}]}],"node_type":"QueryLetRef","ref_id":"208"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"209"}],"ref_id":"210"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"OutpatientSurgeryVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Outpatient Surgery Service\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"211"}],"node_type":"Retrieve","ref_id":"211"},{"children":[{"text":" LastSurgeryOP"}]}],"ref_id":"212"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastSurgeryOP"}]}],"ref_id":"213"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"214"}],"node_type":"Property","ref_id":"214"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"216"},{"children":[{"text":" or less on or before"}]}],"ref_id":"217"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"VisitStartWithED"}]}],"node_type":"QueryLetRef","ref_id":"215"}],"ref_id":"217"}],"ref_id":"217"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"218"}],"node_type":"End","ref_id":"219"}],"ref_id":"220"}],"ref_id":"221"}],"ref_id":"222"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"223"}],"ref_id":"224"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"OutpatientSurgeryVisit"}]}],"ref_id":"225"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"226"}],"node_type":"Property","ref_id":"226"}],"node_type":"Start","ref_id":"227"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"VisitStartWithED"}]}],"node_type":"QueryLetRef","ref_id":"228"},{"children":[{"text":")"}]}],"ref_id":"229"},{"children":[{"text":", \n    "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"230"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"231"}],"node_type":"Property","ref_id":"231"}],"ref_id":"232"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"233"}],"ref_id":"234"}],"node_type":"Query","ref_id":"235"}],"node_type":"Query","ref_id":"235"}],"ref_id":"236"}],"define_name":"HospitalizationWithObservationAndOutpatientSurgeryService"},{"children":[{"children":[{"children":[{"text":"/*Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/\ndefine function \"HospitalizationWithObservation\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"237"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"Encounter"}]}]}],"node_type":"OperandRef","ref_id":"238"},{"children":[{"text":" Visit"}]}],"ref_id":"239"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"let "}]},{"children":[{"children":[{"text":"ObsVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Observation Services\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"240"}],"node_type":"Retrieve","ref_id":"240"},{"children":[{"text":" LastObs"}]}],"ref_id":"241"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastObs"}]}],"ref_id":"242"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"243"}],"node_type":"Property","ref_id":"243"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"247"},{"children":[{"text":" or less on or before"}]}],"ref_id":"248"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"244"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"245"}],"node_type":"Property","ref_id":"245"}],"node_type":"Start","ref_id":"246"}],"ref_id":"248"}],"ref_id":"248"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"249"}],"node_type":"End","ref_id":"250"}],"ref_id":"251"}],"ref_id":"252"}],"ref_id":"253"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"254"}],"ref_id":"255"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"VisitStart: "}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"ObsVisit"}]}],"ref_id":"256"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"257"}],"node_type":"Property","ref_id":"257"}],"node_type":"Start","ref_id":"258"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"259"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"260"}],"node_type":"Property","ref_id":"260"}],"node_type":"Start","ref_id":"261"},{"children":[{"text":")"}]}],"node_type":"Coalesce","ref_id":"262"}],"ref_id":"263"},{"children":[{"text":",\n    "}]},{"children":[{"children":[{"text":"EDVisit: "}]},{"children":[{"children":[{"text":"Last("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"[\"Encounter, Performed\": "}]},{"children":[{"children":[{"text":"\"Emergency Department Visit\""}]}]},{"children":[{"text":"]"}]}],"node_type":"Retrieve","ref_id":"264"}],"node_type":"Retrieve","ref_id":"264"},{"children":[{"text":" LastED"}]}],"ref_id":"265"}]},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"text":"LastED"}]}],"ref_id":"266"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"267"}],"node_type":"Property","ref_id":"267"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"ends "}]},{"children":[{"children":[{"text":"1 hour"}]}],"node_type":"Quantity","ref_id":"269"},{"children":[{"text":" or less on or before"}]}],"ref_id":"270"},{"children":[{"text":" "}]},{"children":[{"children":[{"text":"VisitStart"}]}],"node_type":"QueryLetRef","ref_id":"268"}],"ref_id":"270"}],"ref_id":"270"},{"children":[{"text":"\n        "}]},{"children":[{"children":[{"text":"sort by \n        "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"IdentifierRef","ref_id":"271"}],"node_type":"End","ref_id":"272"}],"ref_id":"273"}],"ref_id":"274"}],"ref_id":"275"},{"children":[{"text":"\n    )"}]}],"node_type":"Last","ref_id":"276"}],"ref_id":"277"}]},{"children":[{"text":"\n    "}]},{"children":[{"children":[{"text":"return "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"Coalesce("}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"children":[{"text":"EDVisit"}]}],"ref_id":"278"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"279"}],"node_type":"Property","ref_id":"279"}],"node_type":"Start","ref_id":"280"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"VisitStart"}]}],"node_type":"QueryLetRef","ref_id":"281"},{"children":[{"text":")"}]}],"ref_id":"282"},{"children":[{"text":", \n    "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"children":[{"text":"Visit"}]}],"ref_id":"283"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"284"}],"node_type":"Property","ref_id":"284"}],"ref_id":"285"},{"children":[{"text":"]"}]}],"node_type":"Interval","ref_id":"286"}],"ref_id":"287"}],"node_type":"Query","ref_id":"288"}],"node_type":"Query","ref_id":"288"}],"ref_id":"289"}],"define_name":"HospitalizationWithObservation"},{"children":[{"children":[{"children":[{"text":"/*Hospitalization with Observation Length of Stay returns the length in days from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter*/\ndefine function \"HospitalizationWithObservationLengthofStay\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"290"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"\"LengthInDays\"("}]},{"children":[{"children":[{"text":"\"HospitalizationWithObservation\"("}]},{"children":[{"children":[{"text":"Encounter"}]}],"node_type":"OperandRef","ref_id":"291"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"292"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"293"}],"node_type":"FunctionRef","ref_id":"293"}],"ref_id":"294"}],"define_name":"HospitalizationWithObservationLengthofStay"},{"children":[{"children":[{"children":[{"text":"/*First Inpatient Intensive Care Unit returns the first intensive care unit for the given encounter, without considering any immediately prior emergency department visit.*/\ndefine function \"FirstInpatientIntensiveCareUnit\"(Encounter "}]},{"children":[{"children":[{"text":"\"Encounter, Performed\""}]}],"ref_id":"295"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"First("}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"("}]},{"children":[{"children":[{"children":[{"text":"Encounter"}]}],"ref_id":"296"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"facilityLocations"}]}],"node_type":"Property","ref_id":"297"}],"node_type":"Property","ref_id":"297"},{"children":[{"text":")"}]}],"node_type":"Property","ref_id":"297"},{"children":[{"text":"HospitalLocation"}]}],"ref_id":"298"}]},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"where "}]},{"children":[{"children":[{"children":[{"children":[{"children":[{"text":"HospitalLocation"}]}],"ref_id":"299"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"code"}]}],"ref_id":"300"}],"ref_id":"300"},{"children":[{"text":" in "}]},{"children":[{"children":[{"text":"\"Intensive Care Unit\""}]}],"ref_id":"301"}],"node_type":"InValueSet","ref_id":"302"},{"children":[{"text":"\n        and "}]},{"children":[{"children":[{"children":[{"children":[{"text":"HospitalLocation"}]}],"ref_id":"303"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"Property","ref_id":"304"}],"node_type":"Property","ref_id":"304"},{"children":[{"text":" during "}],"node_type":"IncludedIn","ref_id":"307"},{"children":[{"children":[{"children":[{"text":"Encounter"}]}],"ref_id":"305"},{"children":[{"text":"."}]},{"children":[{"children":[{"text":"relevantPeriod"}]}],"node_type":"Property","ref_id":"306"}],"node_type":"Property","ref_id":"306"}],"node_type":"IncludedIn","ref_id":"307"}],"ref_id":"308"}],"ref_id":"308"},{"children":[{"text":"\n      "}]},{"children":[{"children":[{"text":"sort by "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"locationPeriod"}]}],"node_type":"IdentifierRef","ref_id":"309"}],"node_type":"Start","ref_id":"310"}],"ref_id":"311"}],"ref_id":"312"}],"ref_id":"313"},{"children":[{"text":"\n  )"}]}],"node_type":"First","ref_id":"314"}],"node_type":"First","ref_id":"314"}],"ref_id":"315"}],"define_name":"FirstInpatientIntensiveCareUnit"},{"children":[{"children":[{"children":[{"text":"/*Given a datetime and a period, returns the period (if a period is provided) or the interval beginning and ending on the datetime (if a datetime is provided)*/\ndefine function \"NormalizeInterval\"(pointInTime "}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"316"},{"children":[{"text":", period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"317"},{"children":[{"text":"\u003e"}]}],"ref_id":"318"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"pointInTime"}]}],"node_type":"OperandRef","ref_id":"319"},{"children":[{"text":" is not null"}]}],"ref_id":"320"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"Interval["}]},{"children":[{"children":[{"text":"pointInTime"}]}],"ref_id":"321"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"pointInTime"}]}],"ref_id":"322"},{"children":[{"text":"]"}]}],"ref_id":"323"},{"children":[{"text":"\n    else "}]},{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"324"},{"children":[{"text":" is not null"}]}],"ref_id":"325"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"period"}]}],"ref_id":"326"},{"children":[{"text":" \n    else "}]},{"children":[{"children":[{"text":"null as "}],"node_type":"Null","ref_id":"327"},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"328"},{"children":[{"text":"\u003e"}]}],"ref_id":"329"}],"ref_id":"330"}],"ref_id":"331"}],"node_type":"If","ref_id":"332"}],"node_type":"If","ref_id":"332"}],"ref_id":"333"}],"define_name":"NormalizeInterval"},{"children":[{"children":[{"children":[{"text":"/*Given an interval, return true if the interval has a starting boundary specified (i.e. the start of the interval is not null and not the minimum DateTime value)*/\ndefine function \"HasStart\"(period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"334"},{"children":[{"text":"\u003e"}]}],"ref_id":"335"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"not "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"336"}],"node_type":"Start","ref_id":"337"},{"children":[{"text":" is null"}]}],"node_type":"IsNull","ref_id":"338"},{"children":[{"text":"\n      or "}]},{"children":[{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"339"}],"node_type":"Start","ref_id":"340"},{"children":[{"text":" = "}]},{"children":[{"children":[{"text":"minimum "}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"341"}],"node_type":"MinValue","ref_id":"342"}],"node_type":"Equal","ref_id":"343"}],"node_type":"Or","ref_id":"344"},{"children":[{"text":"\n  )"}]}],"node_type":"Or","ref_id":"344"}],"node_type":"Not","ref_id":"345"}],"node_type":"Not","ref_id":"345"}],"ref_id":"346"}],"define_name":"HasStart"},{"children":[{"children":[{"children":[{"text":"/*Given an interval, return true if the interval has an ending boundary specified (i.e. the end of the interval is not null and not the maximum DateTime value)*/\ndefine function \"HasEnd\"(period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"347"},{"children":[{"text":"\u003e"}]}],"ref_id":"348"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"not "}]},{"children":[{"children":[{"text":"( \n    "}]},{"children":[{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"349"}],"node_type":"End","ref_id":"350"},{"children":[{"text":" is null"}]}],"node_type":"IsNull","ref_id":"351"},{"children":[{"text":"\n      or \n      "}]},{"children":[{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"352"}],"node_type":"End","ref_id":"353"},{"children":[{"text":" = "}]},{"children":[{"children":[{"text":"maximum "}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"354"}],"node_type":"MaxValue","ref_id":"355"}],"node_type":"Equal","ref_id":"356"}],"node_type":"Or","ref_id":"357"},{"children":[{"text":"\n  )"}]}],"node_type":"Or","ref_id":"357"}],"node_type":"Not","ref_id":"358"}],"node_type":"Not","ref_id":"358"}],"ref_id":"359"}],"define_name":"HasEnd"},{"children":[{"children":[{"children":[{"text":"/*Given an interval, return the ending point if the interval has an ending boundary specified, otherwise, return the starting point*/\ndefine function \"Latest\"(period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"360"},{"children":[{"text":"\u003e"}]}],"ref_id":"361"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"text":"HasEnd("}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"362"},{"children":[{"text":")"}]}],"ref_id":"363"},{"children":[{"text":")"}]}],"ref_id":"363"},{"children":[{"text":" then \n  "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"364"}],"ref_id":"365"},{"children":[{"text":" \n    else "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"366"}],"ref_id":"367"}],"node_type":"If","ref_id":"368"}],"node_type":"If","ref_id":"368"}],"ref_id":"369"}],"define_name":"Latest"},{"children":[{"children":[{"children":[{"text":"/*Given an interval, return the starting point if the interval has a starting boundary specified, otherwise, return the ending point*/\ndefine function \"Earliest\"(period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"370"},{"children":[{"text":"\u003e"}]}],"ref_id":"371"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"if "}]},{"children":[{"children":[{"text":"( "}]},{"children":[{"children":[{"text":"HasStart("}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"372"},{"children":[{"text":")"}]}],"ref_id":"373"},{"children":[{"text":")"}]}],"ref_id":"373"},{"children":[{"text":" then "}]},{"children":[{"children":[{"text":"start of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"374"}],"ref_id":"375"},{"children":[{"text":" \n    else \n  "}]},{"children":[{"children":[{"text":"end of "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"376"}],"ref_id":"377"}],"node_type":"If","ref_id":"378"}],"node_type":"If","ref_id":"378"}],"ref_id":"379"}],"define_name":"Earliest"},{"children":[{"children":[{"children":[{"text":"/*Given a pointInTime or period, if the pointInTime is specified, returns the pointInTime, returns the ending point of the period if the period has an ending boundary specified, otherwise returns the starting point of the interval*/\ndefine function \"LatestOf\"(pointInTime "}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"380"},{"children":[{"text":", period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"381"},{"children":[{"text":"\u003e"}]}],"ref_id":"382"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"Latest("}]},{"children":[{"children":[{"text":"NormalizeInterval("}]},{"children":[{"children":[{"text":"pointInTime"}]}],"node_type":"OperandRef","ref_id":"383"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"384"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"385"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"386"}],"node_type":"FunctionRef","ref_id":"386"}],"ref_id":"387"}],"define_name":"LatestOf"},{"children":[{"children":[{"children":[{"text":"/*Given a pointInTime or period, if the pointInTime is specified, returns the pointInTime, returns the starting point of the period if the period has a starting boundary specified, otherwise returns the ending point of the period*/\ndefine function \"EarliestOf\"(pointInTime "}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"388"},{"children":[{"text":", period "}]},{"children":[{"children":[{"text":"Interval\u003c"}]},{"children":[{"children":[{"text":"DateTime"}]}],"ref_id":"389"},{"children":[{"text":"\u003e"}]}],"ref_id":"390"},{"children":[{"text":" ):\n  "}]},{"children":[{"children":[{"children":[{"text":"Earliest("}]},{"children":[{"children":[{"text":"NormalizeInterval("}]},{"children":[{"children":[{"text":"pointInTime"}]}],"node_type":"OperandRef","ref_id":"391"},{"children":[{"text":", "}]},{"children":[{"children":[{"text":"period"}]}],"node_type":"OperandRef","ref_id":"392"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"393"},{"children":[{"text":")"}]}],"node_type":"FunctionRef","ref_id":"394"}],"node_type":"FunctionRef","ref_id":"394"}],"ref_id":"395"}],"define_name":"EarliestOf"}],"identifier":{"id":"MATGlobalCommonFunctionsQDM","version":"8.0.000"}},"is_main_library":false,"is_top_level":true,"library_name":"MATGlobalCommonFunctionsQDM","library_version":"8.0.000","statement_dependencies":[{"_id":"68923b74a83e15671c2c8ba1","statement_name":"NormalizeInterval"},{"_id":"68923b74a83e15671c2c8ba2","statement_name":"ToDateInterval"}]}],"created_at":null,"description":"Percentage of patients 18 years of age and older who were treated with antidepressant medication, had a diagnosis of major depression, and who remained on an antidepressant medication treatment. Two rates are reported. \na. Percentage of patients who remained on an antidepressant medication for at least 84 days (12 weeks). \nb. Percentage of patients who remained on an antidepressant medication for at least 180 days (6 months).","hqmf_id":"2C928084-8A90-2AF8-018A-98DDAC0B02C8","hqmf_set_id":"8924F2B3-EC06-4650-B634-D70A53DEE577","hqmf_version_number":"13.0.000","main_cql_library":"AntidepressantMedicationManagement","measure_attributes":[{"code":"OTH","value":"128","name":"eCQM Identifier (Measure Authoring Tool)","code_obj":{"type":"CD","null_flavor":"OTH","original_text":"eCQM Identifier (Measure Authoring Tool)"},"value_obj":{"type":"ED","value":"128","media_type":"text/plain"}},{"code":"OTH","value":"Not Applicable","name":"CBE Number","code_obj":{"type":"CD","null_flavor":"OTH","original_text":"CBE Number"},"value_obj":{"type":"ED","value":"Not Applicable","media_type":"text/plain"}},{"code":"COPY","value":"This Physician Performance Measure (Measure) and related data specifications are owned and were developed by the National Committee for Quality Assurance (NCQA). NCQA is not responsible for any use of the Measure. NCQA makes no representations, warranties, or endorsement about the quality of any organization or physician that uses or reports performance measures and NCQA has no liability to anyone who relies on such measures or specifications. NCQA holds a copyright in the Measure. The Measure can be reproduced and distributed, without modification, for noncommercial purposes (e.g., use by healthcare providers in connection with their practices) without obtaining approval from NCQA. Commercial use is defined as the sale, licensing, or distribution of the Measure for commercial gain, or incorporation of the Measure into a product or service that is sold, licensed or distributed for commercial gain. All commercial uses or requests for modification must be approved by NCQA and are subject to a license at the discretion of NCQA. (C) 2012-2024 National Committee for Quality Assurance. All Rights Reserved.\n\nLimited proprietary coding is contained in the Measure specifications for user convenience. Users of proprietary code sets should obtain all necessary licenses from the owners of the code sets. NCQA disclaims all liability for use or accuracy of any third-party codes contained in the specifications.\n\nCPT(R) codes, descriptions and other data are copyright 2024. American Medical Association. All rights reserved. CPT is a trademark of the American Medical Association. Fee schedules, relative value units, conversion factors and/or related components are not assigned by the AMA, are not part of CPT, and the AMA is not recommending their use. The AMA does not directly or indirectly practice medicine or dispense medical services. The AMA assumes no liability for data contained or not contained herein. Applicable FARS/DFARS restrictions apply to government use.\n\nSome measure specifications contain coding from LOINC(R) (http://loinc.org). The LOINC table, LOINC codes, LOINC panels and form file, LOINC linguistic variants file, LOINC/RSNA Radiology Playbook, and LOINC/IEEE Medical Device Code Mapping Table are copyright 2004-2024 Regenstrief Institute, Inc. and the Logical Observation Identifiers Names and Codes (LOINC) Committee, and are available at no cost under the license at http://loinc.org/terms-of-use.\n\nThis material contains SNOMED Clinical Terms(R) (SNOMED CT[R]) copyright 2004-2023 International Health Terminology Standards Development Organisation. \n\nICD-10 copyright 2024 World Health Organization. All Rights Reserved.\n\nSome measures use RxNorm, a standardized nomenclature and coding for clinical drugs and drug delivery devices, which is made publicly available courtesy of the U.S. National Library of Medicine (NLM), National Institutes of Health, Department of Health and Human Services. NLM is not responsible for the measures and does not endorse or recommend this or any other product.\n\n“HL7” is the registered trademark of Health Level Seven International.","name":"Copyright","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"COPY","title":"Copyright"},"value_obj":{"type":"ED","value":"This Physician Performance Measure (Measure) and related data specifications are owned and were developed by the National Committee for Quality Assurance (NCQA). NCQA is not responsible for any use of the Measure. NCQA makes no representations, warranties, or endorsement about the quality of any organization or physician that uses or reports performance measures and NCQA has no liability to anyone who relies on such measures or specifications. NCQA holds a copyright in the Measure. The Measure can be reproduced and distributed, without modification, for noncommercial purposes (e.g., use by healthcare providers in connection with their practices) without obtaining approval from NCQA. Commercial use is defined as the sale, licensing, or distribution of the Measure for commercial gain, or incorporation of the Measure into a product or service that is sold, licensed or distributed for commercial gain. All commercial uses or requests for modification must be approved by NCQA and are subject to a license at the discretion of NCQA. (C) 2012-2024 National Committee for Quality Assurance. All Rights Reserved.\n\nLimited proprietary coding is contained in the Measure specifications for user convenience. Users of proprietary code sets should obtain all necessary licenses from the owners of the code sets. NCQA disclaims all liability for use or accuracy of any third-party codes contained in the specifications.\n\nCPT(R) codes, descriptions and other data are copyright 2024. American Medical Association. All rights reserved. CPT is a trademark of the American Medical Association. Fee schedules, relative value units, conversion factors and/or related components are not assigned by the AMA, are not part of CPT, and the AMA is not recommending their use. The AMA does not directly or indirectly practice medicine or dispense medical services. The AMA assumes no liability for data contained or not contained herein. Applicable FARS/DFARS restrictions apply to government use.\n\nSome measure specifications contain coding from LOINC(R) (http://loinc.org). The LOINC table, LOINC codes, LOINC panels and form file, LOINC linguistic variants file, LOINC/RSNA Radiology Playbook, and LOINC/IEEE Medical Device Code Mapping Table are copyright 2004-2024 Regenstrief Institute, Inc. and the Logical Observation Identifiers Names and Codes (LOINC) Committee, and are available at no cost under the license at http://loinc.org/terms-of-use.\n\nThis material contains SNOMED Clinical Terms(R) (SNOMED CT[R]) copyright 2004-2023 International Health Terminology Standards Development Organisation. \n\nICD-10 copyright 2024 World Health Organization. All Rights Reserved.\n\nSome measures use RxNorm, a standardized nomenclature and coding for clinical drugs and drug delivery devices, which is made publicly available courtesy of the U.S. National Library of Medicine (NLM), National Institutes of Health, Department of Health and Human Services. NLM is not responsible for the measures and does not endorse or recommend this or any other product.\n\n“HL7” is the registered trademark of Health Level Seven International.","media_type":"text/plain"}},{"code":"DISC","value":"The performance Measure is not a clinical guideline and does not establish a standard of medical care, and has not been tested for all potential applications. THE MEASURE AND SPECIFICATIONS ARE PROVIDED \"AS IS\" WITHOUT WARRANTY OF ANY KIND.\n \nDue to technical limitations, registered trademarks are indicated by (R) or [R] and unregistered trademarks are indicated by (TM) or [TM].","name":"Disclaimer","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"DISC","title":"Disclaimer"},"value_obj":{"type":"ED","value":"The performance Measure is not a clinical guideline and does not establish a standard of medical care, and has not been tested for all potential applications. THE MEASURE AND SPECIFICATIONS ARE PROVIDED \"AS IS\" WITHOUT WARRANTY OF ANY KIND.\n \nDue to technical limitations, registered trademarks are indicated by (R) or [R] and unregistered trademarks are indicated by (TM) or [TM].","media_type":"text/plain"}},{"code":"MSRSCORE","name":"Measure Scoring","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"MSRSCORE","title":"Measure Scoring"},"value_obj":{"type":"CD","system":"2.16.840.1.113883.5.1063","code":"PROPOR","title":"Proportion"}},{"code":"MSRTYPE","name":"Measure Type","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"MSRTYPE","title":"Measure Type"},"value_obj":{"type":"CD","system":"2.16.840.1.113883.5.1063","code":"PROCESS","title":"PROCESS"}},{"code":"STRAT","value":"None","name":"Stratification","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"STRAT","title":"Stratification"},"value_obj":{"type":"ED","value":"None","media_type":"text/plain"}},{"code":"MSRADJ","value":"None","name":"Risk Adjustment","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"MSRADJ","title":"Risk Adjustment"},"value_obj":{"type":"ED","value":"None","media_type":"text/plain"}},{"code":"MSRAGG","value":"None","name":"Rate Aggregation","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"MSRAGG","title":"Rate Aggregation"},"value_obj":{"type":"ED","value":"None","media_type":"text/plain"}},{"code":"RAT","value":"Depression affects over 17 million adults in the U.S. (NIMH, 2021) and is estimated to affect nearly a quarter of adults in their lifetime (Burcusa \u0026 Iacono, 2007). Symptoms of depression include disturbances in appetite and sleep, anxiety, decreased concentration, and suicidal ideation (NAMI, 2017; Charbonneau et al., 2005). When left untreated, depression can have a dramatic effect on one’s quality of life, causing constant feelings of hopelessness, loss of interest in daily activities and in some cases suicidal ideation (SAMHSA, 2014).\n\nThe American Psychiatric Association (APA) recommends use of antidepressant medication and behavioral therapies, such as psychotherapy, for the treatment and management of depression (APA, 2010). For the past 60 years, antidepressant medication has proven to be effective, especially for patients with more severe symptoms (Fournier et al., 2010). However, studies analyzing adherence to antidepressant medications found that prevalence of nonadherence was high, ranging from 13 percent to 55.7 percent (Sansone, 2012). \n\nClinical guidelines for depression emphasize the importance of effective clinical management in increasing patients’ medication compliance, monitoring treatment effectiveness, and identifying and managing side effects. If pharmacological treatment is initiated, appropriate dosing and continuation of therapy through the acute and continuation phases decrease recurrence of symptoms. Thus, the evaluation of the duration of pharmacological treatment serves as an important indicator in understanding patient compliance with establishing and maintaining an effective medication regimen.","name":"Rationale","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"RAT","title":"Rationale"},"value_obj":{"type":"ED","value":"Depression affects over 17 million adults in the U.S. (NIMH, 2021) and is estimated to affect nearly a quarter of adults in their lifetime (Burcusa \u0026 Iacono, 2007). Symptoms of depression include disturbances in appetite and sleep, anxiety, decreased concentration, and suicidal ideation (NAMI, 2017; Charbonneau et al., 2005). When left untreated, depression can have a dramatic effect on one’s quality of life, causing constant feelings of hopelessness, loss of interest in daily activities and in some cases suicidal ideation (SAMHSA, 2014).\n\nThe American Psychiatric Association (APA) recommends use of antidepressant medication and behavioral therapies, such as psychotherapy, for the treatment and management of depression (APA, 2010). For the past 60 years, antidepressant medication has proven to be effective, especially for patients with more severe symptoms (Fournier et al., 2010). However, studies analyzing adherence to antidepressant medications found that prevalence of nonadherence was high, ranging from 13 percent to 55.7 percent (Sansone, 2012). \n\nClinical guidelines for depression emphasize the importance of effective clinical management in increasing patients’ medication compliance, monitoring treatment effectiveness, and identifying and managing side effects. If pharmacological treatment is initiated, appropriate dosing and continuation of therapy through the acute and continuation phases decrease recurrence of symptoms. Thus, the evaluation of the duration of pharmacological treatment serves as an important indicator in understanding patient compliance with establishing and maintaining an effective medication regimen.","media_type":"text/plain"}},{"code":"CRS","value":"American Psychological Association (2019): \n- \"For initial treatment of adult patients with depression, the panel recommends the following in the context of sharing decision-making with the patient when considering options: \n1. That clinicians offer either psychotherapy or second-generation antidepressant.\n2. If considering combined treatment, the panel recommends cognitive-behavioral therapy or interpersonal psychotherapy plus a second-generation antidepressant.”\n\t\n- “For initial treatment of older adult patients with depression, the panel recommends the following in the context of shared decision-making with the patient: \n1. Either group life review treatment or Group Cognitive Behavioral Therapy (either alone or added to usual care) over no treatment \n2. Combined pharmacotherapy and interpersonal psychotherapy (IPT) over IPT alone. Of note, while the study upon which this is based used nortriptyline, the panel recommends a second-generation antidepressant due to the reduced risk of side effects.”\n\nAmerican Psychiatric Association (2010): \n- “An antidepressant medication is recommended as an initial treatment choice for patients with mild to moderate major depressive disorder [I: Recommended with substantial clinical confidence] and definitely should be provided for those with severe major depressive disorder unless electroconvulsive therapy (ECT) is planned [I: Recommended with substantial clinical confidence].” \n\n- \"Patients should be given a realistic notion of what can be expected during the different phases of treatment, including the likely time course of symptom response and the importance of adherence for successful treatment and prophylaxis [I].\"\n\n- \"During the acute phase of treatment, patients should be carefully and systematically monitored on a regular basis to assess their response to pharmacotherapy, identify the emergence of side effects (e.g., gastrointestinal symptoms, sedation, insomnia, activation, changes in weight, and cardiovascular, neurological, anticholinergic, or sexual side effects), and assess patient safety [I].\"\n\n- “During the continuation phase of treatment, the patient should be carefully monitored for signs of possible relapse [I: Recommended with substantial clinical confidence]. Systematic assessment of symptoms, side effects, adherence, and functional status is essential [I: Recommended with substantial clinical confidence], and may be facilitated through the use of clinician- and/or patient-administered rating scales [II: Recommended with moderate clinical confidence]. To reduce the risk of relapse, patients who have been treated successfully with antidepressant medications in the acute phase should continue treatment with these agents for 4–9 months [I: Recommended with substantial clinical confidence].”\n\nDepartment of Veterans Affairs, and Health Affairs, Department of Defense (2022): \n- “For patients with major depressive disorder (MDD), we suggest using a quantitative measure of depression severity in the initial treatment planning and to monitor treatment progress at regular intervals to guide shared treatment decision making.” [Weak For]\n\t\n- “In patients with MDD who achieve remission with antidepressant medication, we recommend continuation of antidepressants at the therapeutic dose for at least six months to decrease risk of relapse.” [Strong For]\n\nDepartment of Veterans Affairs, and Health Affairs, Department of Defense (2016):\n- ”In patients at high risk for recurrent depressive episodes and who are treated with pharmacotherapy, we recommend offering maintenance pharmacotherapy for at least 12 months and possibly indefinitely.” [Strong For] \n \n- “After initiation of therapy or a change in treatment, we recommend monitoring patients at least monthly until the patient achieves remission. At minimum, assessments should include a measure of symptoms, adherence to medication and psychotherapy, and emergence of adverse effects.” [Strong For] \n\n- “In patients with MDD who achieve remission with antidepressant medication, we recommend continuation of antidepressants at the therapeutic dose for at least six months to decrease risk of relapse.” [Strong For]","name":"Clinical Recommendation Statement","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"CRS","title":"Clinical Recommendation Statement"},"value_obj":{"type":"ED","value":"American Psychological Association (2019): \n- \"For initial treatment of adult patients with depression, the panel recommends the following in the context of sharing decision-making with the patient when considering options: \n1. That clinicians offer either psychotherapy or second-generation antidepressant.\n2. If considering combined treatment, the panel recommends cognitive-behavioral therapy or interpersonal psychotherapy plus a second-generation antidepressant.”\n\t\n- “For initial treatment of older adult patients with depression, the panel recommends the following in the context of shared decision-making with the patient: \n1. Either group life review treatment or Group Cognitive Behavioral Therapy (either alone or added to usual care) over no treatment \n2. Combined pharmacotherapy and interpersonal psychotherapy (IPT) over IPT alone. Of note, while the study upon which this is based used nortriptyline, the panel recommends a second-generation antidepressant due to the reduced risk of side effects.”\n\nAmerican Psychiatric Association (2010): \n- “An antidepressant medication is recommended as an initial treatment choice for patients with mild to moderate major depressive disorder [I: Recommended with substantial clinical confidence] and definitely should be provided for those with severe major depressive disorder unless electroconvulsive therapy (ECT) is planned [I: Recommended with substantial clinical confidence].” \n\n- \"Patients should be given a realistic notion of what can be expected during the different phases of treatment, including the likely time course of symptom response and the importance of adherence for successful treatment and prophylaxis [I].\"\n\n- \"During the acute phase of treatment, patients should be carefully and systematically monitored on a regular basis to assess their response to pharmacotherapy, identify the emergence of side effects (e.g., gastrointestinal symptoms, sedation, insomnia, activation, changes in weight, and cardiovascular, neurological, anticholinergic, or sexual side effects), and assess patient safety [I].\"\n\n- “During the continuation phase of treatment, the patient should be carefully monitored for signs of possible relapse [I: Recommended with substantial clinical confidence]. Systematic assessment of symptoms, side effects, adherence, and functional status is essential [I: Recommended with substantial clinical confidence], and may be facilitated through the use of clinician- and/or patient-administered rating scales [II: Recommended with moderate clinical confidence]. To reduce the risk of relapse, patients who have been treated successfully with antidepressant medications in the acute phase should continue treatment with these agents for 4–9 months [I: Recommended with substantial clinical confidence].”\n\nDepartment of Veterans Affairs, and Health Affairs, Department of Defense (2022): \n- “For patients with major depressive disorder (MDD), we suggest using a quantitative measure of depression severity in the initial treatment planning and to monitor treatment progress at regular intervals to guide shared treatment decision making.” [Weak For]\n\t\n- “In patients with MDD who achieve remission with antidepressant medication, we recommend continuation of antidepressants at the therapeutic dose for at least six months to decrease risk of relapse.” [Strong For]\n\nDepartment of Veterans Affairs, and Health Affairs, Department of Defense (2016):\n- ”In patients at high risk for recurrent depressive episodes and who are treated with pharmacotherapy, we recommend offering maintenance pharmacotherapy for at least 12 months and possibly indefinitely.” [Strong For] \n \n- “After initiation of therapy or a change in treatment, we recommend monitoring patients at least monthly until the patient achieves remission. At minimum, assessments should include a measure of symptoms, adherence to medication and psychotherapy, and emergence of adverse effects.” [Strong For] \n\n- “In patients with MDD who achieve remission with antidepressant medication, we recommend continuation of antidepressants at the therapeutic dose for at least six months to decrease risk of relapse.” [Strong For]","media_type":"text/plain"}},{"code":"IDUR","value":"Higher score indicates better quality","name":"Improvement Notation","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"IDUR","title":"Improvement Notation"},"value_obj":{"type":"ED","value":"Higher score indicates better quality","media_type":"text/plain"}},{"code":"REF","value":"CITATIONAmerican Psychiatric Association. (2010). Practice guideline for the treatment of patients with major depressive disorder, 3rd edition. Arlington: Author.","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONAmerican Psychiatric Association. (2010). Practice guideline for the treatment of patients with major depressive disorder, 3rd edition. Arlington: Author.","media_type":"text/plain"}},{"code":"REF","value":"CITATIONAmerican Psychological Association. (2019). Clinical practice guideline for the treatment of depression across three age cohorts. Retrieved from https://www.apa.org/depression-guideline","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONAmerican Psychological Association. (2019). Clinical practice guideline for the treatment of depression across three age cohorts. Retrieved from https://www.apa.org/depression-guideline","media_type":"text/plain"}},{"code":"REF","value":"CITATIONBurcusa, S. L., \u0026 Iacono, W. G. (2007). Risk for recurrence in depression. Clinical Psychology Review, 27(8), 959-985.","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONBurcusa, S. L., \u0026 Iacono, W. G. (2007). Risk for recurrence in depression. Clinical Psychology Review, 27(8), 959-985.","media_type":"text/plain"}},{"code":"REF","value":"CITATIONCharbonneau, A., Bruning, W., Titus-Howard, T., et al. (2005). The community initiative on depression: report from a multiphase work site depression intervention. Journal of Occupational and Environmental Medicine, 47(1), 60-67.","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONCharbonneau, A., Bruning, W., Titus-Howard, T., et al. (2005). The community initiative on depression: report from a multiphase work site depression intervention. Journal of Occupational and Environmental Medicine, 47(1), 60-67.","media_type":"text/plain"}},{"code":"REF","value":"CITATIONDepartment of Veterans Affairs and the Department of Defense (VA/DoD). (2022). VA/DoD Clinical Practice Guidelines for the Management of Major Depressive Disorder. Version 4.0 . Retrieved from https://www.healthquality.va.gov/guidelines/MH/mdd/VADoDMDDCPGFinal508.pdf","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONDepartment of Veterans Affairs and the Department of Defense (VA/DoD). (2022). VA/DoD Clinical Practice Guidelines for the Management of Major Depressive Disorder. Version 4.0 . Retrieved from https://www.healthquality.va.gov/guidelines/MH/mdd/VADoDMDDCPGFinal508.pdf","media_type":"text/plain"}},{"code":"REF","value":"CITATIONDepartment of Veterans Affairs and the Department of Defense (VA/DoD). (2016). VA/DoD Clinical Practice Guidelines for the Management of Major Depressive Disorder. The Management of Major Depressive Disorder Working Group. Retrieved from https://www.healthquality.va.gov/guidelines/MH/mdd/VADoDMDDCPGFINAL82916.pdf","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONDepartment of Veterans Affairs and the Department of Defense (VA/DoD). (2016). VA/DoD Clinical Practice Guidelines for the Management of Major Depressive Disorder. The Management of Major Depressive Disorder Working Group. Retrieved from https://www.healthquality.va.gov/guidelines/MH/mdd/VADoDMDDCPGFINAL82916.pdf","media_type":"text/plain"}},{"code":"REF","value":"CITATIONFournier, J. C., DeRubeis, R. J., Hollon, S. D., et al. (2010). Antidepressant drug effects and depression severity: a patient-level meta-analysis. JAMA, 303(1), 47-53.","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONFournier, J. C., DeRubeis, R. J., Hollon, S. D., et al. (2010). Antidepressant drug effects and depression severity: a patient-level meta-analysis. JAMA, 303(1), 47-53.","media_type":"text/plain"}},{"code":"REF","value":"CITATIONNational Alliance on Mental Illness (NAMI). (2017). Depression. Retrieved from https://www.nami.org/About-Mental-Illness/Mental-Health-Conditions/Depression","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONNational Alliance on Mental Illness (NAMI). (2017). Depression. Retrieved from https://www.nami.org/About-Mental-Illness/Mental-Health-Conditions/Depression","media_type":"text/plain"}},{"code":"REF","value":"CITATIONNational Institute of Mental Health (NIMH). (2021). Major Depression. Retrieved from https://www.nimh.nih.gov/health/statistics/major-depression","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONNational Institute of Mental Health (NIMH). (2021). Major Depression. Retrieved from https://www.nimh.nih.gov/health/statistics/major-depression","media_type":"text/plain"}},{"code":"REF","value":"CITATIONSansone, R. A., \u0026 Sansone, L. A. (2012). Antidepressant adherence: are patients taking their medications? Innovations in Clinical Neuroscience, 9(5–6), 41–46.","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONSansone, R. A., \u0026 Sansone, L. A. (2012). Antidepressant adherence: are patients taking their medications? Innovations in Clinical Neuroscience, 9(5–6), 41–46.","media_type":"text/plain"}},{"code":"REF","value":"CITATIONSubstance Abuse and Mental Health Services Administration (SAMHSA). (2014). Results from the 2013 National Survey on Drug Use and Health: Mental Health Findings, NSDUH Series H-49, HHS Publication No. (SMA) 14-4887. Rockville, MD: Substance Abuse and Mental Health Services Administration.","name":"Reference","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"REF","title":"Reference"},"value_obj":{"type":"ED","value":"CITATIONSubstance Abuse and Mental Health Services Administration (SAMHSA). (2014). Results from the 2013 National Survey on Drug Use and Health: Mental Health Findings, NSDUH Series H-49, HHS Publication No. (SMA) 14-4887. Rockville, MD: Substance Abuse and Mental Health Services Administration.","media_type":"text/plain"}},{"code":"DEF","value":"Intake Period: The 12-month window starting on May 1 of the year prior to the measurement period and ending on April 30 of the measurement period.\n\nIndex Prescription Start Date (IPSD): The date of the earliest prescription dispensing event for an antidepressant medication during the Intake Period.\n\nThe \"continuous treatment\" described in this measure allows for gaps in medication treatment up to a total 31 days during the 115-day period (numerator 1) or 52 days during the 232-day period (numerator 2). Gaps can include either gaps used to change medication, or treatment gaps to refill the same medication.","name":"Definition","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"DEF","title":"Definition"},"value_obj":{"type":"ED","value":"Intake Period: The 12-month window starting on May 1 of the year prior to the measurement period and ending on April 30 of the measurement period.\n\nIndex Prescription Start Date (IPSD): The date of the earliest prescription dispensing event for an antidepressant medication during the Intake Period.\n\nThe \"continuous treatment\" described in this measure allows for gaps in medication treatment up to a total 31 days during the 115-day period (numerator 1) or 52 days during the 232-day period (numerator 2). Gaps can include either gaps used to change medication, or treatment gaps to refill the same medication.","media_type":"text/plain"}},{"code":"GUIDE","value":"To identify new treatment episodes for major depression, there must be a 105-day negative medication history (a period during which the patient was not taking antidepressant medication) prior to the dispensing event associated with the IPSD.\n\nThis eCQM is a patient-based measure.\n \nThis version of the eCQM uses QDM version 5.6. Please refer to the eCQI resource center (https://ecqi.healthit.gov/qdm) for more information on the QDM.","name":"Guidance","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"GUIDE","title":"Guidance"},"value_obj":{"type":"ED","value":"To identify new treatment episodes for major depression, there must be a 105-day negative medication history (a period during which the patient was not taking antidepressant medication) prior to the dispensing event associated with the IPSD.\n\nThis eCQM is a patient-based measure.\n \nThis version of the eCQM uses QDM version 5.6. Please refer to the eCQI resource center (https://ecqi.healthit.gov/qdm) for more information on the QDM.","media_type":"text/plain"}},{"code":"TRANF","value":"TBD","name":"Transmission Format","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"TRANF","title":"Transmission Format"},"value_obj":{"type":"ED","value":"TBD","media_type":"text/plain"}},{"code":"IPOP","value":"Patients 18 years of age and older as of the IPSD who were dispensed antidepressant medications during the Intake Period, and were diagnosed with major depression 60 days prior to, or 60 days after the dispensing event and had a visit 60 days prior to, or 60 days after the dispensing event","name":"Initial Population","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"IPOP","title":"Initial Population"},"value_obj":{"type":"ED","value":"Patients 18 years of age and older as of the IPSD who were dispensed antidepressant medications during the Intake Period, and were diagnosed with major depression 60 days prior to, or 60 days after the dispensing event and had a visit 60 days prior to, or 60 days after the dispensing event","media_type":"text/plain"}},{"code":"DENOM","value":"Equals Initial Population","name":"Denominator","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"DENOM","title":"Denominator"},"value_obj":{"type":"ED","value":"Equals Initial Population","media_type":"text/plain"}},{"code":"DENEX","value":"Exclude patients who are in hospice care for any part of the measurement period.\n\nPatients who were actively on an antidepressant medication in the 105 days prior to the IPSD.","name":"Denominator Exclusions","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"DENEX","title":"Denominator Exclusions"},"value_obj":{"type":"ED","value":"Exclude patients who are in hospice care for any part of the measurement period.\n\nPatients who were actively on an antidepressant medication in the 105 days prior to the IPSD.","media_type":"text/plain"}},{"code":"NUMER","value":"Numerator 1: Patients who have received antidepressant medication for at least 84 days (12 weeks) of continuous treatment beginning on the IPSD through 114 days after the IPSD (115 total days).\n\nNumerator 2: Patients who have received antidepressant medications for at least 180 days (6 months) of continuous treatment beginning on the IPSD through 231 days after the IPSD (232 total days).","name":"Numerator","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"NUMER","title":"Numerator"},"value_obj":{"type":"ED","value":"Numerator 1: Patients who have received antidepressant medication for at least 84 days (12 weeks) of continuous treatment beginning on the IPSD through 114 days after the IPSD (115 total days).\n\nNumerator 2: Patients who have received antidepressant medications for at least 180 days (6 months) of continuous treatment beginning on the IPSD through 231 days after the IPSD (232 total days).","media_type":"text/plain"}},{"code":"NUMEX","value":"Not Applicable","name":"Numerator Exclusions","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"NUMEX","title":"Numerator Exclusions"},"value_obj":{"type":"ED","value":"Not Applicable","media_type":"text/plain"}},{"code":"DENEXCEP","value":"None","name":"Denominator Exceptions","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"DENEXCEP","title":"Denominator Exceptions"},"value_obj":{"type":"ED","value":"None","media_type":"text/plain"}},{"code":"SDE","value":"For every patient evaluated by this measure also identify payer, race, ethnicity and sex","name":"Supplemental Data Elements","code_obj":{"type":"CD","system":"2.16.840.1.113883.5.4","code":"SDE","title":"Supplemental Data Elements"},"value_obj":{"type":"ED","value":"For every patient evaluated by this measure also identify payer, race, ethnicity and sex","media_type":"text/plain"}}],"measure_period":{"type":"IVL_TS","low":{"type":"TS","value":"201201010000","inclusive?":true,"derived?":false},"high":{"type":"TS","value":"201212312359","inclusive?":true,"derived?":false},"width":{"type":"PQ","unit":"a","value":"1","inclusive?":true,"derived?":false}},"measure_scoring":"PROPORTION","population_criteria":{"IPP":{"conjunction?":true,"type":"IPP","hqmf_id":"FB7963B0-4087-4620-831A-011F11461F1D","preconditions":[{"id":2,"preconditions":[{"id":1,"reference":"AntidepressantMedicationManagement__Initial_Population__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"allTrue"}]},"DENOM":{"conjunction?":true,"type":"DENOM","hqmf_id":"6377FF0F-DF03-46C5-9269-4047935DEF0D","preconditions":[{"id":4,"preconditions":[{"id":3,"reference":"AntidepressantMedicationManagement__Denominator__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"allTrue"}]},"NUMER":{"conjunction?":true,"type":"NUMER","hqmf_id":"2F9BA0BC-A3A0-4F25-AF9E-FD3BB4DEA05A","preconditions":[{"id":6,"preconditions":[{"id":5,"reference":"AntidepressantMedicationManagement__Numerator_1__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"allTrue"}]},"DENEX":{"conjunction?":true,"type":"DENEX","hqmf_id":"CEE186A0-C49C-48C1-B6A2-9D3DBDCAB754","preconditions":[{"id":8,"preconditions":[{"id":7,"reference":"AntidepressantMedicationManagement__Denominator_Exclusions__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"atLeastOneTrue"}]},"IPP_1":{"conjunction?":true,"type":"IPP","hqmf_id":"6E7B2368-CCCA-4414-856A-4BC93DCF2067","preconditions":[{"id":10,"preconditions":[{"id":9,"reference":"AntidepressantMedicationManagement__Initial_Population__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"allTrue"}]},"DENOM_1":{"conjunction?":true,"type":"DENOM","hqmf_id":"E05BAE38-1702-461A-8FF8-50E41D18483B","preconditions":[{"id":12,"preconditions":[{"id":11,"reference":"AntidepressantMedicationManagement__Denominator__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"allTrue"}]},"NUMER_1":{"conjunction?":true,"type":"NUMER","hqmf_id":"2D4DFEFA-9E20-46FC-BAFB-2685D0DADC70","preconditions":[{"id":14,"preconditions":[{"id":13,"reference":"AntidepressantMedicationManagement__Numerator_2__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"allTrue"}]},"DENEX_1":{"conjunction?":true,"type":"DENEX","hqmf_id":"CC153620-82CB-4D5B-9262-9958EC3DBAD2","preconditions":[{"id":16,"preconditions":[{"id":15,"reference":"AntidepressantMedicationManagement__Denominator_Exclusions__7CF58BA9_5038_41C2_8E00_E74551D395CF"}],"conjunction_code":"atLeastOneTrue"}]}},"population_sets":[{"_id":"68923b74a83e15671c2c8b6e","population_set_id":"PopulationSet_1","populations":{"DENEX":{"_id":"68923b7ca83e15671c2c8e41","hqmf_id":"CEE186A0-C49C-48C1-B6A2-9D3DBDCAB754","library_name":"AntidepressantMedicationManagement","statement_name":"Denominator Exclusions"},"DENOM":{"_id":"68923b7ca83e15671c2c8e42","hqmf_id":"6377FF0F-DF03-46C5-9269-4047935DEF0D","library_name":"AntidepressantMedicationManagement","statement_name":"Denominator"},"IPP":{"_id":"68923b7ca83e15671c2c8e43","hqmf_id":"FB7963B0-4087-4620-831A-011F11461F1D","library_name":"AntidepressantMedicationManagement","statement_name":"Initial Population"},"NUMER":{"_id":"68923b7ca83e15671c2c8e44","hqmf_id":"2F9BA0BC-A3A0-4F25-AF9E-FD3BB4DEA05A","library_name":"AntidepressantMedicationManagement","statement_name":"Numerator 1"},"_id":"68923b7ca83e15671c2c8e45","_type":"CQM::ProportionPopulationMap"},"supplemental_data_elements":[{"_id":"68923b74a83e15671c2c8b66","hqmf_id":"2924FBB1-7703-4321-965D-6C4A0FA0B44C","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Ethnicity"},{"_id":"68923b74a83e15671c2c8b67","hqmf_id":"9B488F45-2EB6-49DE-A0EF-3FC08596D632","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Payer"},{"_id":"68923b74a83e15671c2c8b68","hqmf_id":"5B3283A4-7D07-4E88-A888-7A0CAA6A5F6D","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Race"},{"_id":"68923b74a83e15671c2c8b69","hqmf_id":"32605BFB-B129-491B-B9B6-A9EB57D20333","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Sex"}],"title":"Population Criteria Section"},{"_id":"68923b74a83e15671c2c8b6f","population_set_id":"PopulationSet_2","populations":{"DENEX":{"_id":"68923b7ca83e15671c2c8e46","hqmf_id":"CC153620-82CB-4D5B-9262-9958EC3DBAD2","library_name":"AntidepressantMedicationManagement","statement_name":"Denominator Exclusions"},"DENOM":{"_id":"68923b7ca83e15671c2c8e47","hqmf_id":"E05BAE38-1702-461A-8FF8-50E41D18483B","library_name":"AntidepressantMedicationManagement","statement_name":"Denominator"},"IPP":{"_id":"68923b7ca83e15671c2c8e48","hqmf_id":"6E7B2368-CCCA-4414-856A-4BC93DCF2067","library_name":"AntidepressantMedicationManagement","statement_name":"Initial Population"},"NUMER":{"_id":"68923b7ca83e15671c2c8e49","hqmf_id":"2D4DFEFA-9E20-46FC-BAFB-2685D0DADC70","library_name":"AntidepressantMedicationManagement","statement_name":"Numerator 2"},"_id":"68923b7ca83e15671c2c8e4a","_type":"CQM::ProportionPopulationMap"},"supplemental_data_elements":[{"_id":"68923b74a83e15671c2c8b6a","hqmf_id":"24630BD3-3A5C-4974-AD16-A5D76031D4B6","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Ethnicity"},{"_id":"68923b74a83e15671c2c8b6b","hqmf_id":"26729E01-223F-48B9-9949-809B27055D72","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Payer"},{"_id":"68923b74a83e15671c2c8b6c","hqmf_id":"FD4EAD29-A7C3-4AA0-9A65-B160592C1F99","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Race"},{"_id":"68923b74a83e15671c2c8b6d","hqmf_id":"028C91A9-7E69-480A-B6B1-7F95DB36C5D4","library_name":"AntidepressantMedicationManagement","statement_name":"SDE Sex"}],"title":"Population Criteria Section"}],"source_data_criteria":[{"_id":"68923b74a83e15671c2c8ba7","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1089","dataElementCodes":[],"description":"Encounter, Performed: VirtualEncounter","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8ba7","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b7ca83e15671c2c8e4b","_type":"QDM::PatientCharacteristicSex","codeListId":"2.16.840.1.113762.1.4.1","dataElementCodes":[],"description":"Patient Characteristic Sex: ONCAdministrativeSex","hqmfOid":"2.16.840.1.113883.10.20.28.4.55","id":"68923b7ca83e15671c2c8e4b","qdmCategory":"patient_characteristic","qdmStatus":"gender","qdmTitle":"Patient Characteristic Sex","qdmVersion":"5.6"},{"_id":"68923b74a83e15671c2c8bb0","_type":"QDM::Diagnosis","anatomicalLocationSite":null,"authorDatetime":null,"codeListId":"2.16.840.1.113883.3.464.1003.105.12.1007","dataElementCodes":[],"description":"Diagnosis: MajorDepression","hqmfOid":"2.16.840.1.113883.10.20.28.4.110","id":"68923b74a83e15671c2c8bb0","prevalencePeriod":null,"qdmCategory":"condition","qdmTitle":"Diagnosis","qdmVersion":"5.6","qrdaOid":"2.16.840.1.113883.10.20.24.3.135","severity":null},{"_id":"68923b74a83e15671c2c8ba8","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1080","dataElementCodes":[],"description":"Encounter, Performed: TelephoneVisits","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8ba8","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8ba9","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.526.3.1240","dataElementCodes":[],"description":"Encounter, Performed: AnnualWellnessVisit","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8ba9","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b7ca83e15671c2c8e4c","_type":"QDM::InterventionOrder","authorDatetime":null,"codeListId":"2.16.840.1.113883.3.526.3.1584","dataElementCodes":[],"description":"Intervention, Order: HospiceCareAmbulatory","hqmfOid":"2.16.840.1.113883.10.20.28.4.35","id":"68923b7ca83e15671c2c8e4c","negationRationale":null,"qdmCategory":"intervention","qdmStatus":"order","qdmTitle":"Intervention, Order","qdmVersion":"5.6","reason":null},{"_id":"68923b7ca83e15671c2c8e4d","_type":"QDM::InterventionPerformed","authorDatetime":null,"codeListId":"2.16.840.1.113883.3.526.3.1584","dataElementCodes":[],"description":"Intervention, Performed: HospiceCareAmbulatory","hqmfOid":"2.16.840.1.113883.10.20.28.4.36","id":"68923b7ca83e15671c2c8e4d","negationRationale":null,"qdmCategory":"intervention","qdmStatus":"performed","qdmTitle":"Intervention, Performed","qdmVersion":"5.6","reason":null,"relatedTo":null,"relevantDatetime":null,"relevantPeriod":null,"result":null,"status":null},{"_id":"68923b74a83e15671c2c8baa","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.526.3.1492","dataElementCodes":[],"description":"Encounter, Performed: PsychVisitDiagnosticEvaluation","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8baa","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8bab","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.526.3.1496","dataElementCodes":[],"description":"Encounter, Performed: PsychVisitPsychotherapy","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bab","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b7ca83e15671c2c8e4e","_type":"QDM::PatientCharacteristicEthnicity","codeListId":"2.16.840.1.114222.4.11.837","dataElementCodes":[],"description":"Patient Characteristic Ethnicity: Ethnicity","hqmfOid":"2.16.840.1.113883.10.20.28.4.56","id":"68923b7ca83e15671c2c8e4e","qdmCategory":"patient_characteristic","qdmStatus":"ethnicity","qdmTitle":"Patient Characteristic Ethnicity","qdmVersion":"5.6"},{"_id":"68923b7ca83e15671c2c8e4f","_type":"QDM::MedicationDispensed","authorDatetime":null,"codeListId":"2.16.840.1.113883.3.464.1003.196.12.1213","dataElementCodes":[],"daysSupplied":null,"description":"Medication, Dispensed: AntidepressantMedication","dosage":null,"frequency":null,"hqmfOid":"2.16.840.1.113883.10.20.28.4.49","id":"68923b7ca83e15671c2c8e4f","negationRationale":null,"qdmCategory":"medication","qdmStatus":"dispensed","qdmTitle":"Medication, Dispensed","qdmVersion":"5.6","refills":null,"relatedTo":null,"relevantDatetime":null,"relevantPeriod":null,"route":null,"supply":null},{"_id":"68923b7ca83e15671c2c8e50","_type":"QDM::MedicationActive","codeListId":"2.16.840.1.113883.3.464.1003.196.12.1213","dataElementCodes":[],"description":"Medication, Active: AntidepressantMedication","dosage":null,"frequency":null,"hqmfOid":"2.16.840.1.113883.10.20.28.4.44","id":"68923b7ca83e15671c2c8e50","qdmCategory":"medication","qdmStatus":"active","qdmTitle":"Medication, Active","qdmVersion":"5.6","relevantDatetime":null,"relevantPeriod":null,"route":null},{"_id":"68923b74a83e15671c2c8bac","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1025","dataElementCodes":[],"description":"Encounter, Performed: PreventiveCareServicesEstablishedOfficeVisit18andUp","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bac","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8bad","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1023","dataElementCodes":[],"description":"Encounter, Performed: PreventiveCareServicesInitialOfficeVisit18andUp","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bad","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8bae","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1016","dataElementCodes":[],"description":"Encounter, Performed: HomeHealthcareServices","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bae","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8baf","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.666.5.307","dataElementCodes":[],"description":"Encounter, Performed: EncounterInpatient","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8baf","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8bb1","_type":"QDM::Diagnosis","anatomicalLocationSite":null,"authorDatetime":null,"codeListId":"2.16.840.1.113883.3.464.1003.1165","dataElementCodes":[],"description":"Diagnosis: HospiceDiagnosis","hqmfOid":"2.16.840.1.113883.10.20.28.4.110","id":"68923b74a83e15671c2c8bb1","prevalencePeriod":null,"qdmCategory":"condition","qdmTitle":"Diagnosis","qdmVersion":"5.6","qrdaOid":"2.16.840.1.113883.10.20.24.3.135","severity":null},{"_id":"68923b7ca83e15671c2c8e51","_type":"QDM::PatientCharacteristicRace","codeListId":"2.16.840.1.114222.4.11.836","dataElementCodes":[],"description":"Patient Characteristic Race: Race","hqmfOid":"2.16.840.1.113883.10.20.28.4.59","id":"68923b7ca83e15671c2c8e51","qdmCategory":"patient_characteristic","qdmStatus":"race","qdmTitle":"Patient Characteristic Race","qdmVersion":"5.6"},{"_id":"68923b74a83e15671c2c8bb2","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.1003","dataElementCodes":[],"description":"Encounter, Performed: HospiceEncounter","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bb2","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b74a83e15671c2c8bb3","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1012","dataElementCodes":[],"description":"Encounter, Performed: NursingFacilityVisit","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bb3","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b7ca83e15671c2c8e52","_type":"QDM::PatientCharacteristicPayer","codeListId":"2.16.840.1.114222.4.11.3591","dataElementCodes":[],"description":"Patient Characteristic Payer: PayerType","hqmfOid":"2.16.840.1.113883.10.20.28.4.58","id":"68923b7ca83e15671c2c8e52","qdmCategory":"patient_characteristic","qdmStatus":"payer","qdmTitle":"Patient Characteristic Payer","qdmVersion":"5.6","relevantPeriod":null},{"_id":"68923b74a83e15671c2c8bb4","_type":"QDM::EncounterPerformed","admissionSource":null,"authorDatetime":null,"clazz":null,"codeListId":"2.16.840.1.113883.3.464.1003.101.12.1001","dataElementCodes":[],"description":"Encounter, Performed: OfficeVisit","diagnoses":null,"dischargeDisposition":null,"facilityLocations":[],"hqmfOid":"2.16.840.1.113883.10.20.28.4.5","id":"68923b74a83e15671c2c8bb4","lengthOfStay":null,"priority":null,"qdmCategory":"encounter","qdmStatus":"performed","qdmTitle":"Encounter, Performed","qdmVersion":"5.6","relatedTo":null,"relevantPeriod":null},{"_id":"68923b7ca83e15671c2c8e53","_type":"QDM::AssessmentPerformed","authorDatetime":null,"codeListId":"drc-fba6a4e5f5a529f9af0e0ac4cc9930b15eed11995ff69f544d676472e0b4ea9f","components":null,"dataElementCodes":[],"description":"Assessment, Performed: Hospice care [Minimum Data Set]","hqmfOid":"2.16.840.1.113883.10.20.28.4.117","id":"68923b7ca83e15671c2c8e53","interpretation":null,"method":null,"negationRationale":null,"qdmCategory":"assessment","qdmStatus":"performed","qdmTitle":"Assessment, Performed","qdmVersion":"5.6","reason":null,"relatedTo":null,"relevantDatetime":null,"relevantPeriod":null,"result":null}],"title":"Antidepressant Medication Management","updated_at":null,"value_set_ids":["68923b74a83e15671c2c8bb5","68923b74a83e15671c2c8bb6","68923b74a83e15671c2c8bb7","68923b74a83e15671c2c8bb8","68923b74a83e15671c2c8bb9","68923b74a83e15671c2c8bba","68923b74a83e15671c2c8bbb","68923b74a83e15671c2c8bbc","68923b74a83e15671c2c8bbd","68923b74a83e15671c2c8bbe","68923b74a83e15671c2c8bbf","68923b74a83e15671c2c8bc0","68923b74a83e15671c2c8bc1","68923b74a83e15671c2c8bc2","68923b74a83e15671c2c8bc3","68923b74a83e15671c2c8bc4","68923b74a83e15671c2c8bc5","68923b74a83e15671c2c8bc6","68923b74a83e15671c2c8bc7","68923b74a83e15671c2c8bc8","68923b74a83e15671c2c8bc9","68923b74a83e15671c2c8bca","68923b74a83e15671c2c8bcb","68923b74a83e15671c2c8bcc","68923b74a83e15671c2c8bcd","68923b74a83e15671c2c8bce","68923b7ca83e15671c2c8e03","68923b7ca83e15671c2c8e04","68923b7ca83e15671c2c8e05","68923b7ca83e15671c2c8e06","68923b7ca83e15671c2c8e07","68923b7ca83e15671c2c8e08","68923b7ca83e15671c2c8e09","68923b7ca83e15671c2c8e0a","68923b7ca83e15671c2c8e0b","68923b7ca83e15671c2c8e0c","68923b7ca83e15671c2c8e0d","68923b7ca83e15671c2c8e0e","68923b7ca83e15671c2c8e0f","68923b7ca83e15671c2c8e10","68923b7ca83e15671c2c8e11","68923b7ca83e15671c2c8e12","68923b7ca83e15671c2c8e13","68923b7ca83e15671c2c8e14","68923b7ca83e15671c2c8e15","68923b7ca83e15671c2c8e16","68923b7ca83e15671c2c8e17","68923b7ca83e15671c2c8e18","68923b7ca83e15671c2c8e19","68923b7ca83e15671c2c8e1a"]}